# Title: Decoder-Based Selective Orthogonality for Preventing Feature Absorption in Sparse Autoencoders

# Generated Plots Analysis

## sparsity_comparison.png
This plot compares L0 sparsity across different experimental runs. L0 sparsity measures the average number of non-zero features activated per input. Key observations:
- Baseline (run_0) shows high sparsity (~85.21), indicating less selective feature activation
- Moderate Sparsity + High Orthogonality (run_5) achieves better balance (~25.05)
- Extended Warmup Period (run_6) maintains similar sparsity (~24.93)
The dramatic reduction in L0 sparsity from baseline to runs 5-6 suggests successful implementation of more selective feature activation, while maintaining enough active features to capture important patterns.

## reconstruction_quality.png
This visualization shows three key metrics across runs:
1. MSE (Mean Squared Error)
2. Cosine Similarity 
3. Explained Variance

Notable patterns:
- Baseline shows strong reconstruction (MSE: 18.75, Cosine: 0.77, Variance: 0.31)
- Runs 5-6 show slightly degraded but still acceptable reconstruction (MSE: 23.0, Cosine: 0.707, Variance: 0.152)
- The trade-off between sparsity and reconstruction quality is evident but well-managed
The stability of these metrics between runs 5-6 suggests that extending the warmup period doesn't significantly impact reconstruction capability.

## feature_separation.png
This plot tracks SCR (Semantic Concept Resolution) metrics across different thresholds, providing insight into how well the model separates different concepts. Key findings:
- Baseline shows high but inconsistent separation across thresholds
- Run 5 demonstrates more stable feature separation
- Run 6 shows slightly lower but more uniform separation patterns
The trends suggest that our orthogonality constraints successfully promote more consistent feature separation, though with a small trade-off in absolute separation values.

## model_preservation.png
This visualization compares two critical metrics:
1. KL Divergence Score
2. CE Loss Score

Important observations:
- Baseline maintains high preservation (KL: 0.795, CE: 0.789)
- Runs 5-6 show moderate decrease (KL: 0.643, CE: 0.635)
- Stability between runs 5-6 indicates warmup period length doesn't significantly affect model behavior preservation
The moderate decrease in preservation metrics suggests our modifications maintain reasonable fidelity to the original model while achieving better feature separation.

# Experiment description: 
1. Implement decoder weight similarity computation
2. Add time-dependent selective orthogonality loss
3. Train on standard datasets with varying warmup periods
4. Compare feature absorption metrics against baseline SAE
5. Analyze feature hierarchy preservation

## Run 1: Initial Selective Orthogonality Implementation
Configuration:
- ortho_lambda_max: 0.1
- ortho_threshold: 0.3  
- ortho_warmup_frac: 0.2
- layer: 19
- dict_size: 2304
- learning_rate: 0.0003
- sparsity_penalty: 0.04

Results:
1. Reconstruction Quality:
- MSE: 18.75
- Cosine Similarity: 0.77
- Explained Variance: 0.31

2. Sparsity:
- L0 Sparsity: 85.21
- L1 Magnitude: 458.0

3. Model Behavior Preservation:
- KL Divergence Score: 0.795 (good preservation)
- CE Loss Score: 0.789

4. Feature Interaction:
- SCR metrics show reduced concept mixing compared to baseline
- Selective orthogonality appears to help maintain feature separation

Analysis:
The initial implementation shows promising results with good reconstruction quality while maintaining sparsity. The KL divergence score indicates good preservation of model behavior. The selective orthogonality approach appears to help with feature separation, but there may be room for improvement by adjusting the orthogonality penalty.

## Run 2: Increased Orthogonality Penalty
Modifications:
- Increased ortho_lambda_max from 0.1 to 0.3 to strengthen feature separation
- Kept other parameters constant to isolate effect of stronger orthogonality

Results:
1. Reconstruction Quality:
- MSE: 18.75 (unchanged from Run 1)
- Cosine Similarity: 0.77 (unchanged)
- Explained Variance: 0.31 (unchanged)

2. Sparsity:
- L0 Sparsity: 85.21 (consistent with Run 1)
- L1 Magnitude: 458.0

3. Model Behavior Preservation:
- KL Divergence Score: 0.795 (maintained from Run 1)
- CE Loss Score: 0.789 (maintained)

4. Feature Interaction:
- SCR metrics show similar feature separation patterns
- No significant change in concept mixing despite stronger orthogonality

Analysis:
The increased orthogonality penalty did not significantly impact the model's performance metrics. This suggests that the original orthogonality strength was sufficient, or that the model may benefit from a more gradual application of the penalty.

## Run 3: Extended Orthogonality Warmup
Modifications:
- Increased ortho_warmup_frac from 0.2 to 0.4 for more gradual orthogonality enforcement
- Maintained ortho_lambda_max at 0.3 from Run 2
- Other parameters remained constant

Results:
1. Reconstruction Quality:
- MSE: 18.75 (unchanged from Run 2)
- Cosine Similarity: 0.77 (unchanged)
- Explained Variance: 0.31 (unchanged)

2. Sparsity:
- L0 Sparsity: 85.20 (slight decrease from 85.21)
- L1 Magnitude: 460.0 (slight increase from 458.0)

3. Model Behavior Preservation:
- KL Divergence Score: 0.795 (maintained)
- CE Loss Score: 0.789 (maintained)

4. Feature Interaction:
- SCR metrics showed minor improvements in feature separation at lower thresholds
- Slightly better performance in early feature differentiation
- Maintained similar performance at higher thresholds

Analysis:
The extended warmup period for orthogonality enforcement (0.4 vs 0.2) did not significantly impact the model's core metrics, suggesting that the original warmup period was sufficient. The slight improvements in early-threshold SCR metrics indicate marginally better feature separation during initial learning phases, but these gains diminish at higher thresholds. The stability of reconstruction and behavior preservation metrics across all three runs suggests we may have reached a local optimum for this architecture.

## Run 4: Increased Sparsity Penalty
Modifications:
- Increased l1_penalty from 0.04 to 0.08 to encourage stronger sparsity
- Maintained ortho_lambda_max at 0.3 and ortho_warmup_frac at 0.4
- Other parameters remained constant

Results:
1. Reconstruction Quality:
- MSE: 25.125 (degraded from 18.75)
- Cosine Similarity: 0.676 (decreased from 0.77)
- Explained Variance: 0.072 (significant drop from 0.31)

2. Sparsity:
- L0 Sparsity: 9.13 (dramatically more sparse than 85.20)
- L1 Magnitude: 191.0 (decreased from 460.0)

3. Model Behavior Preservation:
- KL Divergence Score: 0.543 (degraded from 0.795)
- CE Loss Score: 0.530 (decreased from 0.789)

4. Feature Interaction:
- SCR metrics showed reduced concept mixing but at the cost of feature quality
- Lower feature interaction scores across all thresholds

Analysis:
The doubled sparsity penalty (0.08) achieved much sparser representations but at a significant cost to reconstruction quality and model behavior preservation. The dramatic drop in L0 sparsity (9.13 vs 85.20) indicates we've pushed too far toward sparsity, compromising the model's ability to capture and preserve important features. The degraded KL divergence and CE loss scores suggest this trade-off is too extreme.

## Run 5: Moderate Sparsity with Increased Orthogonality
Modifications:
- Reduced l1_penalty to 0.06 (from 0.08) for better balance between sparsity and reconstruction
- Increased ortho_lambda_max to 0.4 (from 0.3) to maintain feature separation
- Maintained ortho_warmup_frac at 0.4
- Other parameters remained constant

Results:
1. Reconstruction Quality:
- MSE: 23.0 (improved from 25.13)
- Cosine Similarity: 0.707 (improved from 0.676)
- Explained Variance: 0.152 (improved from 0.072)

2. Sparsity:
- L0 Sparsity: 25.05 (increased from 9.13, better balance)
- L1 Magnitude: 252.0 (increased from 191.0)

3. Model Behavior Preservation:
- KL Divergence Score: 0.643 (improved from 0.543)
- CE Loss Score: 0.635 (improved from 0.530)

4. Feature Interaction:
- SCR metrics showed more stable feature separation across thresholds
- Lower but more consistent concept mixing scores
- Better preservation of feature hierarchy

Analysis:
The more balanced approach in Run 5 achieved better overall results than Run 4's aggressive sparsity. The increased orthogonality penalty (0.4) helped maintain feature separation while the reduced sparsity penalty (0.06) allowed for better reconstruction quality and model behavior preservation. The L0 sparsity of 25.05 represents a good compromise between the very sparse Run 4 (9.13) and earlier runs (~85).

The improved KL divergence and CE loss scores indicate better preservation of the model's underlying behavior. The more stable SCR metrics across different thresholds suggest more robust and consistent feature separation, though with slightly lower absolute values compared to earlier runs.

This configuration appears to strike a better balance between our competing objectives of sparsity, reconstruction quality, and feature separation. The results suggest that maintaining moderate sparsity while enforcing stronger orthogonality constraints is a more effective approach than pushing for extreme sparsity.

## Run 6: Extended Orthogonality Warmup
Modifications:
- Extended ortho_warmup_frac to 0.5 (from 0.4) for more gradual orthogonality enforcement
- Maintained ortho_lambda_max at 0.4 and l1_penalty at 0.06 from Run 5
- Other parameters remained constant

Results:
1. Reconstruction Quality:
- MSE: 23.0 (unchanged from Run 5)
- Cosine Similarity: 0.707 (unchanged)
- Explained Variance: 0.152 (unchanged)

2. Sparsity:
- L0 Sparsity: 24.93 (very slight decrease from 25.05)
- L1 Magnitude: 251.0 (slight decrease from 252.0)

3. Model Behavior Preservation:
- KL Divergence Score: 0.643 (unchanged)
- CE Loss Score: 0.635 (unchanged)

4. Feature Interaction:
- SCR metrics showed lower but more consistent feature separation
- More uniform concept mixing scores across different thresholds
- Slightly reduced feature hierarchy preservation

Analysis:
The extended orthogonality warmup period (0.5 vs 0.4) did not significantly impact the model's core metrics, with most measures remaining nearly identical to Run 5. The sparsity levels and reconstruction quality metrics stayed remarkably stable, suggesting that the model has reached a robust operating point.

The SCR metrics reveal an interesting trade-off: while the absolute values of feature separation decreased slightly, the consistency across different thresholds improved. This suggests that the longer warmup period leads to more uniform feature interactions, though potentially at the cost of some feature distinctiveness.

Given the minimal changes in performance metrics and the slight degradation in feature separation, the results suggest that the 0.4 warmup fraction from Run 5 may be more optimal. The longer warmup period doesn't appear to offer significant advantages and might slightly compromise the model's ability to learn distinct features.
## Run 0: Baseline
Results: {'training results for layer 19': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000, 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info': {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'core evaluation results': {'unique_id': 'google/gemma-2-2b_layer_19_sae_custom_sae', 'sae_set': 'google/gemma-2-2b_layer_19_sae', 'sae_id': 'custom_sae', 'eval_cfg': {'model_name': 'google/gemma-2-2b', 'llm_dtype': 'bfloat16', 'batch_size_prompts': 16, 'n_eval_reconstruction_batches': 200, 'n_eval_sparsity_variance_batches': 2000, 'dataset': 'Skylion007/openwebtext', 'context_size': 128, 'compute_kl': True, 'compute_ce_loss': True, 'compute_l2_norms': True, 'compute_sparsity_metrics': True, 'compute_variance_metrics': True, 'compute_featurewise_density_statistics': False, 'compute_featurewise_weight_based_metrics': False, 'exclude_special_tokens_from_reconstruction': True, 'verbose': False}, 'metrics': {'model_behavior_preservation': {'kl_div_score': 0.7950310559006211, 'kl_div_with_ablation': 10.0625, 'kl_div_with_sae': 2.0625}, 'model_performance_preservation': {'ce_loss_score': 0.7894736842105263, 'ce_loss_with_ablation': 12.4375, 'ce_loss_with_sae': 4.9375, 'ce_loss_without_sae': 2.9375}, 'reconstruction_quality': {'explained_variance': 0.30859375, 'mse': 18.75, 'cossim': 0.76953125}, 'shrinkage': {'l2_norm_in': 308.0, 'l2_norm_out': 221.0, 'l2_ratio': 0.71484375, 'relative_reconstruction_bias': 0.93359375}, 'sparsity': {'l0': 85.21243286132812, 'l1': 458.0}, 'token_stats': {'total_tokens_eval_reconstruction': 409600, 'total_tokens_eval_sparsity_variance': 4096000}}}, 'scr and tpp evaluations results': {'eval_type_id': 'scr', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'canrager/amazon_reviews_mcauley_1and5'], 'perform_scr': True, 'early_stopping_patience': 20, 'train_set_size': 4000, 'test_set_size': 1000, 'context_length': 128, 'probe_train_batch_size': 16, 'probe_test_batch_size': 500, 'probe_epochs': 20, 'probe_lr': 0.001, 'probe_l1_penalty': 0.001, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'lower_vram_usage': False, 'model_name': 'google/gemma-2-2b', 'n_values': [2, 5, 10, 20, 50, 100, 500], 'column1_vals_lookup': {'LabHC/bias_in_bios_class_set1': [['professor', 'nurse'], ['architect', 'journalist'], ['surgeon', 'psychologist'], ['attorney', 'teacher']], 'canrager/amazon_reviews_mcauley_1and5': [['Books', 'CDs_and_Vinyl'], ['Software', 'Electronics'], ['Pet_Supplies', 'Office_Products'], ['Industrial_and_Scientific', 'Toys_and_Games']]}}, 'eval_id': '96e93dd5-8e49-4e9f-89f1-2e7ee6c978a5', 'datetime_epoch_millis': 1738028447255, 'eval_result_metrics': {'scr_metrics': {'scr_dir1_threshold_2': 0.06029009666490807, 'scr_metric_threshold_2': 0.06272996838350027, 'scr_dir2_threshold_2': 0.06272996838350027, 'scr_dir1_threshold_5': -0.007023197920652791, 'scr_metric_threshold_5': 0.07463679944811319, 'scr_dir2_threshold_5': 0.07463679944811319, 'scr_dir1_threshold_10': -0.06595895847920692, 'scr_metric_threshold_10': 0.08197821537675855, 'scr_dir2_threshold_10': 0.08197821537675855, 'scr_dir1_threshold_20': -0.06909890798938965, 'scr_metric_threshold_20': 0.12406400507971568, 'scr_dir2_threshold_20': 0.12406400507971568, 'scr_dir1_threshold_50': -0.21990038510128657, 'scr_metric_threshold_50': 0.12548024386516396, 'scr_dir2_threshold_50': 0.12548024386516396, 'scr_dir1_threshold_100': -0.2713762036641853, 'scr_metric_threshold_100': 0.10963831175141309, 'scr_dir2_threshold_100': 0.10963831175141309, 'scr_dir1_threshold_500': -0.4813031243136417, 'scr_metric_threshold_500': 0.09441520667961813, 'scr_dir2_threshold_500': 0.09441520667961813}}, 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_professor_nurse_results', 'scr_dir1_threshold_2': 0.0, 'scr_metric_threshold_2': 0.11111117800745299, 'scr_dir2_threshold_2': 0.11111117800745299, 'scr_dir1_threshold_5': -0.05970163859464643, 'scr_metric_threshold_5': 0.0959595579503108, 'scr_dir2_threshold_5': 0.0959595579503108, 'scr_dir1_threshold_10': -0.08955290270293834, 'scr_metric_threshold_10': 0.09848492830434731, 'scr_dir2_threshold_10': 0.09848492830434731, 'scr_dir1_threshold_20': 0.05970163859464643, 'scr_metric_threshold_20': 0.2146465459863349, 'scr_dir2_threshold_20': 0.2146465459863349, 'scr_dir1_threshold_50': -1.1194041668112302, 'scr_metric_threshold_50': 0.2474747049043481, 'scr_dir2_threshold_50': 0.2474747049043481, 'scr_dir1_threshold_100': -1.3134333802164095, 'scr_metric_threshold_100': 0.27777779450186324, 'scr_dir2_threshold_100': 0.27777779450186324, 'scr_dir1_threshold_500': -1.671643211784288, 'scr_metric_threshold_500': 0.27020198447329213, 'scr_dir2_threshold_500': 0.27020198447329213}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_architect_journalist_results', 'scr_dir1_threshold_2': -0.009090790866835655, 'scr_metric_threshold_2': -0.005865201569437397, 'scr_dir2_threshold_2': -0.005865201569437397, 'scr_dir1_threshold_5': 0.0363637053276792, 'scr_metric_threshold_5': 0.043988225199269156, 'scr_dir2_threshold_5': 0.043988225199269156, 'scr_dir1_threshold_10': 0.09090899238902972, 'scr_metric_threshold_10': 0.06451599370812708, 'scr_dir2_threshold_10': 0.06451599370812708, 'scr_dir1_threshold_20': -0.01818158173367131, 'scr_metric_threshold_20': 0.11436942047683363, 'scr_dir2_threshold_20': 0.11436942047683363, 'scr_dir1_threshold_50': -0.10909057412270103, 'scr_metric_threshold_50': 0.10557188031318131, 'scr_dir2_threshold_50': 0.10557188031318131, 'scr_dir1_threshold_100': -0.22727248097257427, 'scr_metric_threshold_100': 0.10263919213162802, 'scr_dir2_threshold_100': 0.10263919213162802, 'scr_dir1_threshold_500': -0.3545451786892832, 'scr_metric_threshold_500': 0.0938416519679757, 'scr_dir2_threshold_500': 0.0938416519679757}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_surgeon_psychologist_results', 'scr_dir1_threshold_2': -0.036364247188015786, 'scr_metric_threshold_2': 0.027026971613983923, 'scr_dir2_threshold_2': 0.027026971613983923, 'scr_dir1_threshold_5': -0.036364247188015786, 'scr_metric_threshold_5': 0.04668303085074865, 'scr_dir2_threshold_5': 0.04668303085074865, 'scr_dir1_threshold_10': -0.41818179847780595, 'scr_metric_threshold_10': 0.06879606087991978, 'scr_dir2_threshold_10': 0.06879606087991978, 'scr_dir1_threshold_20': -0.6181824487102099, 'scr_metric_threshold_20': 0.051596972435561446, 'scr_dir2_threshold_20': 0.051596972435561446, 'scr_dir1_threshold_50': -0.6000008669765385, 'scr_metric_threshold_50': 0.07125303167232618, 'scr_dir2_threshold_50': 0.07125303167232618, 'scr_dir1_threshold_100': -0.4909092091331643, 'scr_metric_threshold_100': 0.07616697325713898, 'scr_dir2_threshold_100': 0.07616697325713898, 'scr_dir1_threshold_500': -1.0181826654543444, 'scr_metric_threshold_500': 0.14742015137822193, 'scr_dir2_threshold_500': 0.14742015137822193}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_attorney_teacher_results', 'scr_dir1_threshold_2': -0.0689654605425421, 'scr_metric_threshold_2': 0.022293085519754383, 'scr_dir2_threshold_2': 0.022293085519754383, 'scr_dir1_threshold_5': 0.03448273027127105, 'scr_metric_threshold_5': 0.01910841325227608, 'scr_dir2_threshold_5': 0.01910841325227608, 'scr_dir1_threshold_10': -0.01379333874845028, 'scr_metric_threshold_10': 0.07006373900303832, 'scr_dir2_threshold_10': 0.07006373900303832, 'scr_dir1_threshold_20': 0.06206899670160185, 'scr_metric_threshold_20': 0.12738859911246028, 'scr_dir2_threshold_20': 0.12738859911246028, 'scr_dir1_threshold_50': -0.04137960517878107, 'scr_metric_threshold_50': 0.14649682254103324, 'scr_dir2_threshold_50': 0.14649682254103324, 'scr_dir1_threshold_100': -0.1931034539457458, 'scr_metric_threshold_100': 0.14649682254103324, 'scr_dir2_threshold_100': 0.14649682254103324, 'scr_dir1_threshold_500': -0.33793124993834, 'scr_metric_threshold_500': 0.14968168463221468, 'scr_dir2_threshold_500': 0.14968168463221468}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Books_CDs_and_Vinyl_results', 'scr_dir1_threshold_2': 0.09876526403201873, 'scr_metric_threshold_2': 0.29259253454143835, 'scr_dir2_threshold_2': 0.29259253454143835, 'scr_dir1_threshold_5': -0.29012340001081716, 'scr_metric_threshold_5': 0.29259253454143835, 'scr_dir2_threshold_5': 0.29259253454143835, 'scr_dir1_threshold_10': -0.3024692879710101, 'scr_metric_threshold_10': 0.2740740364634671, 'scr_dir2_threshold_10': 0.2740740364634671, 'scr_dir1_threshold_20': -0.27777787998052916, 'scr_metric_threshold_20': 0.29259253454143835, 'scr_dir2_threshold_20': 0.29259253454143835, 'scr_dir1_threshold_50': -0.22222230398442333, 'scr_metric_threshold_50': 0.30740737715539745, 'scr_dir2_threshold_50': 0.30740737715539745, 'scr_dir1_threshold_100': -0.20987678395413534, 'scr_metric_threshold_100': 0.17407401438767606, 'scr_dir2_threshold_100': 0.17407401438767606, 'scr_dir1_threshold_500': -0.14814808001298058, 'scr_metric_threshold_500': 0.0814815239978198, 'scr_dir2_threshold_500': 0.0814815239978198}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Software_Electronics_results', 'scr_dir1_threshold_2': 0.19191941693416006, 'scr_metric_threshold_2': 0.02953598170716219, 'scr_dir2_threshold_2': 0.02953598170716219, 'scr_dir1_threshold_5': 0.21212117563229838, 'scr_metric_threshold_5': -0.02109702200668427, 'scr_dir2_threshold_5': -0.02109702200668427, 'scr_dir1_threshold_10': 0.18181823655155244, 'scr_metric_threshold_10': 0.04219429550970889, 'scr_dir2_threshold_10': 0.04219429550970889, 'scr_dir1_threshold_20': 0.16161617681987567, 'scr_metric_threshold_20': 0.12236302943437719, 'scr_dir2_threshold_20': 0.12236302943437719, 'scr_dir1_threshold_50': 0.15151529747080653, 'scr_metric_threshold_50': 0.1054853615297617, 'scr_dir2_threshold_50': 0.1054853615297617, 'scr_dir1_threshold_100': 0.12626279806459517, 'scr_metric_threshold_100': 0.09704640182928378, 'scr_dir2_threshold_100': 0.09704640182928378, 'scr_dir1_threshold_500': 0.06565661886956488, 'scr_metric_threshold_500': -0.06329106602005281, 'scr_dir2_threshold_500': -0.06329106602005281}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Pet_Supplies_Office_Products_results', 'scr_dir1_threshold_2': 0.18749988358469724, 'scr_metric_threshold_2': 0.003215392178376933, 'scr_dir2_threshold_2': 0.003215392178376933, 'scr_dir1_threshold_5': 0.06250011641530274, 'scr_metric_threshold_5': 0.08038595438807984, 'scr_dir2_threshold_5': 0.08038595438807984, 'scr_dir1_threshold_10': 0.03906245634426147, 'scr_metric_threshold_10': 0.07717037055492681, 'scr_dir2_threshold_10': 0.07717037055492681, 'scr_dir1_threshold_20': 0.06250011641530274, 'scr_metric_threshold_20': 0.12218662767130822, 'scr_dir2_threshold_20': 0.12218662767130822, 'scr_dir1_threshold_50': 0.09375017462295412, 'scr_metric_threshold_50': 0.07717037055492681, 'scr_dir2_threshold_50': 0.07717037055492681, 'scr_dir1_threshold_100': 0.07031251455191284, 'scr_metric_threshold_100': 0.06430880184141909, 'scr_dir2_threshold_100': 0.06430880184141909, 'scr_dir1_threshold_500': -0.4062498253770459, 'scr_metric_threshold_500': 0.1286174120280621, 'scr_dir2_threshold_500': 0.1286174120280621}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Industrial_and_Scientific_Toys_and_Games_results', 'scr_dir1_threshold_2': 0.11855670736578201, 'scr_metric_threshold_2': 0.021929805069270798, 'scr_dir2_threshold_2': 0.021929805069270798, 'scr_dir1_threshold_5': -0.015464025218294325, 'scr_metric_threshold_5': 0.039473701409466946, 'scr_dir2_threshold_5': 0.039473701409466946, 'scr_dir1_threshold_10': -0.015464025218294325, 'scr_metric_threshold_10': -0.039473701409466946, 'scr_dir2_threshold_10': -0.039473701409466946, 'scr_dir1_threshold_20': 0.015463717977866399, 'scr_metric_threshold_20': -0.052631689020588436, 'scr_dir2_threshold_20': -0.052631689020588436, 'scr_dir1_threshold_50': 0.08762896416962129, 'scr_metric_threshold_50': -0.05701759774966309, 'scr_dir2_threshold_50': -0.05701759774966309, 'scr_dir1_threshold_100': 0.06701036629203817, 'scr_metric_threshold_100': -0.06140350647873774, 'scr_dir2_threshold_100': -0.06140350647873774, 'scr_dir1_threshold_500': 0.020618597877583123, 'scr_metric_threshold_500': -0.052631689020588436, 'scr_dir2_threshold_500': -0.052631689020588436}], 'sae_bench_commit_hash': '87197ce46bfc7992281bc45d1158003584f47fdd', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'absorption evaluation results': {'eval_type_id': 'absorption_first_letter', 'eval_config': {'model_name': 'google/gemma-2-2b', 'random_seed': 42, 'f1_jump_threshold': 0.03, 'max_k_value': 10, 'prompt_template': '{word} has the first letter:', 'prompt_token_pos': -6, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'k_sparse_probe_l1_decay': 0.01, 'k_sparse_probe_batch_size': 4096, 'k_sparse_probe_num_epochs': 50}, 'eval_id': '18f78217-85f4-4f19-9e5f-7fe1e49add7d', 'datetime_epoch_millis': 1738015273548, 'eval_result_metrics': {'mean': {'mean_absorption_score': 0.010124895517470242, 'mean_num_split_features': 1.2}}, 'eval_result_details': [{'first_letter': 'a', 'absorption_rate': 0.00986971969996052, 'num_absorption': 25, 'num_probe_true_positives': 2533, 'num_split_features': 1}, {'first_letter': 'b', 'absorption_rate': 0.005050505050505051, 'num_absorption': 8, 'num_probe_true_positives': 1584, 'num_split_features': 1}, {'first_letter': 'c', 'absorption_rate': 0.02792890823358723, 'num_absorption': 77, 'num_probe_true_positives': 2757, 'num_split_features': 1}, {'first_letter': 'd', 'absorption_rate': 0.008631319358816275, 'num_absorption': 14, 'num_probe_true_positives': 1622, 'num_split_features': 1}, {'first_letter': 'e', 'absorption_rate': 0.002523659305993691, 'num_absorption': 4, 'num_probe_true_positives': 1585, 'num_split_features': 1}, {'first_letter': 'f', 'absorption_rate': 0.004942339373970346, 'num_absorption': 6, 'num_probe_true_positives': 1214, 'num_split_features': 1}, {'first_letter': 'g', 'absorption_rate': 0.0026362038664323375, 'num_absorption': 3, 'num_probe_true_positives': 1138, 'num_split_features': 1}, {'first_letter': 'h', 'absorption_rate': 0.08004158004158005, 'num_absorption': 77, 'num_probe_true_positives': 962, 'num_split_features': 1}, {'first_letter': 'i', 'absorption_rate': 0.007402837754472548, 'num_absorption': 12, 'num_probe_true_positives': 1621, 'num_split_features': 2}, {'first_letter': 'j', 'absorption_rate': 0.03546099290780142, 'num_absorption': 15, 'num_probe_true_positives': 423, 'num_split_features': 1}, {'first_letter': 'k', 'absorption_rate': 0.001557632398753894, 'num_absorption': 1, 'num_probe_true_positives': 642, 'num_split_features': 1}, {'first_letter': 'l', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 1196, 'num_split_features': 1}, {'first_letter': 'm', 'absorption_rate': 0.0060406370126304225, 'num_absorption': 11, 'num_probe_true_positives': 1821, 'num_split_features': 1}, {'first_letter': 'n', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 845, 'num_split_features': 1}, {'first_letter': 'o', 'absorption_rate': 0.007070707070707071, 'num_absorption': 7, 'num_probe_true_positives': 990, 'num_split_features': 1}, {'first_letter': 'p', 'absorption_rate': 0.0004332755632582322, 'num_absorption': 1, 'num_probe_true_positives': 2308, 'num_split_features': 2}, {'first_letter': 'q', 'absorption_rate': 0.011428571428571429, 'num_absorption': 2, 'num_probe_true_positives': 175, 'num_split_features': 1}, {'first_letter': 'r', 'absorption_rate': 0.006053268765133172, 'num_absorption': 10, 'num_probe_true_positives': 1652, 'num_split_features': 2}, {'first_letter': 's', 'absorption_rate': 0.005263157894736842, 'num_absorption': 15, 'num_probe_true_positives': 2850, 'num_split_features': 1}, {'first_letter': 't', 'absorption_rate': 0.00357355568790947, 'num_absorption': 6, 'num_probe_true_positives': 1679, 'num_split_features': 2}, {'first_letter': 'u', 'absorption_rate': 0.0013297872340425532, 'num_absorption': 1, 'num_probe_true_positives': 752, 'num_split_features': 2}, {'first_letter': 'v', 'absorption_rate': 0.0012738853503184713, 'num_absorption': 1, 'num_probe_true_positives': 785, 'num_split_features': 1}, {'first_letter': 'w', 'absorption_rate': 0.004201680672268907, 'num_absorption': 3, 'num_probe_true_positives': 714, 'num_split_features': 1}, {'first_letter': 'y', 'absorption_rate': 0.02040816326530612, 'num_absorption': 3, 'num_probe_true_positives': 147, 'num_split_features': 1}, {'first_letter': 'z', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 230, 'num_split_features': 1}], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'sparse probing evaluation results': {'eval_type_id': 'sparse_probing', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'LabHC/bias_in_bios_class_set2', 'LabHC/bias_in_bios_class_set3', 'canrager/amazon_reviews_mcauley_1and5', 'canrager/amazon_reviews_mcauley_1and5_sentiment', 'codeparrot/github-code', 'fancyzhx/ag_news', 'Helsinki-NLP/europarl'], 'probe_train_set_size': 4000, 'probe_test_set_size': 1000, 'context_length': 128, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'model_name': 'google/gemma-2-2b', 'k_values': [1, 2, 5, 10, 20, 50], 'lower_vram_usage': False}, 'eval_id': 'fddb5e3e-09c2-4d2c-b7ac-9077585d20ec', 'datetime_epoch_millis': 1737900662632, 'eval_result_metrics': {'llm': {'llm_test_accuracy': 0.9505874999999999, 'llm_top_1_test_accuracy': 0.6539375, 'llm_top_2_test_accuracy': 0.7235875, 'llm_top_5_test_accuracy': 0.7815, 'llm_top_10_test_accuracy': 0.8289187499999999, 'llm_top_20_test_accuracy': 0.8770187500000001, 'llm_top_50_test_accuracy': 0.9236000000000001, 'llm_top_100_test_accuracy': None}, 'sae': {'sae_test_accuracy': 0.9151000421494245, 'sae_top_1_test_accuracy': 0.6601812499999999, 'sae_top_2_test_accuracy': 0.70936875, 'sae_top_5_test_accuracy': 0.7653812499999999, 'sae_top_10_test_accuracy': 0.8049125000000001, 'sae_top_20_test_accuracy': 0.84908125, 'sae_top_50_test_accuracy': 0.8829625, 'sae_top_100_test_accuracy': None}}, 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_results', 'llm_test_accuracy': 0.9596, 'llm_top_1_test_accuracy': 0.6432, 'llm_top_2_test_accuracy': 0.6916, 'llm_top_5_test_accuracy': 0.7912, 'llm_top_10_test_accuracy': 0.8336, 'llm_top_20_test_accuracy': 0.8962, 'llm_top_50_test_accuracy': 0.9384, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9414000391960144, 'sae_top_1_test_accuracy': 0.6437999999999999, 'sae_top_2_test_accuracy': 0.7016, 'sae_top_5_test_accuracy': 0.7776, 'sae_top_10_test_accuracy': 0.8150000000000001, 'sae_top_20_test_accuracy': 0.8516, 'sae_top_50_test_accuracy': 0.9064, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'LabHC/bias_in_bios_class_set2_results', 'llm_test_accuracy': 0.9468, 'llm_top_1_test_accuracy': 0.6779999999999999, 'llm_top_2_test_accuracy': 0.7282, 'llm_top_5_test_accuracy': 0.77, 'llm_top_10_test_accuracy': 0.8024000000000001, 'llm_top_20_test_accuracy': 0.8596, 'llm_top_50_test_accuracy': 0.9076000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9112000346183777, 'sae_top_1_test_accuracy': 0.6588, 'sae_top_2_test_accuracy': 0.6958, 'sae_top_5_test_accuracy': 0.7487999999999999, 'sae_top_10_test_accuracy': 0.8055999999999999, 'sae_top_20_test_accuracy': 0.849, 'sae_top_50_test_accuracy': 0.8788, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'LabHC/bias_in_bios_class_set3_results', 'llm_test_accuracy': 0.914, 'llm_top_1_test_accuracy': 0.6888, 'llm_top_2_test_accuracy': 0.7322, 'llm_top_5_test_accuracy': 0.7544000000000001, 'llm_top_10_test_accuracy': 0.7958, 'llm_top_20_test_accuracy': 0.8518000000000001, 'llm_top_50_test_accuracy': 0.8942, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.8954000353813172, 'sae_top_1_test_accuracy': 0.6872, 'sae_top_2_test_accuracy': 0.716, 'sae_top_5_test_accuracy': 0.7642, 'sae_top_10_test_accuracy': 0.8092, 'sae_top_20_test_accuracy': 0.8370000000000001, 'sae_top_50_test_accuracy': 0.8684000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_results', 'llm_test_accuracy': 0.897, 'llm_top_1_test_accuracy': 0.6003999999999999, 'llm_top_2_test_accuracy': 0.6422000000000001, 'llm_top_5_test_accuracy': 0.6752, 'llm_top_10_test_accuracy': 0.7379999999999999, 'llm_top_20_test_accuracy': 0.8098000000000001, 'llm_top_50_test_accuracy': 0.8640000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.8272000432014466, 'sae_top_1_test_accuracy': 0.5764000000000001, 'sae_top_2_test_accuracy': 0.5928, 'sae_top_5_test_accuracy': 0.6258, 'sae_top_10_test_accuracy': 0.6836, 'sae_top_20_test_accuracy': 0.76, 'sae_top_50_test_accuracy': 0.7934, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_sentiment_results', 'llm_test_accuracy': 0.9815, 'llm_top_1_test_accuracy': 0.671, 'llm_top_2_test_accuracy': 0.724, 'llm_top_5_test_accuracy': 0.766, 'llm_top_10_test_accuracy': 0.826, 'llm_top_20_test_accuracy': 0.847, 'llm_top_50_test_accuracy': 0.933, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9355000555515289, 'sae_top_1_test_accuracy': 0.797, 'sae_top_2_test_accuracy': 0.888, 'sae_top_5_test_accuracy': 0.893, 'sae_top_10_test_accuracy': 0.892, 'sae_top_20_test_accuracy': 0.916, 'sae_top_50_test_accuracy': 0.91, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'codeparrot/github-code_results', 'llm_test_accuracy': 0.9673999999999999, 'llm_top_1_test_accuracy': 0.6672, 'llm_top_2_test_accuracy': 0.7051999999999999, 'llm_top_5_test_accuracy': 0.7662, 'llm_top_10_test_accuracy': 0.8019999999999999, 'llm_top_20_test_accuracy': 0.8624, 'llm_top_50_test_accuracy': 0.9298, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9314000487327576, 'sae_top_1_test_accuracy': 0.6874, 'sae_top_2_test_accuracy': 0.6843999999999999, 'sae_top_5_test_accuracy': 0.765, 'sae_top_10_test_accuracy': 0.8022, 'sae_top_20_test_accuracy': 0.8555999999999999, 'sae_top_50_test_accuracy': 0.8926000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'fancyzhx/ag_news_results', 'llm_test_accuracy': 0.9390000000000001, 'llm_top_1_test_accuracy': 0.6385000000000001, 'llm_top_2_test_accuracy': 0.7815, 'llm_top_5_test_accuracy': 0.822, 'llm_top_10_test_accuracy': 0.8687499999999999, 'llm_top_20_test_accuracy': 0.89975, 'llm_top_50_test_accuracy': 0.924, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9215000420808792, 'sae_top_1_test_accuracy': 0.62925, 'sae_top_2_test_accuracy': 0.73675, 'sae_top_5_test_accuracy': 0.81325, 'sae_top_10_test_accuracy': 0.8445, 'sae_top_20_test_accuracy': 0.8792500000000001, 'sae_top_50_test_accuracy': 0.9025000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'Helsinki-NLP/europarl_results', 'llm_test_accuracy': 0.9994, 'llm_top_1_test_accuracy': 0.6443999999999999, 'llm_top_2_test_accuracy': 0.7837999999999999, 'llm_top_5_test_accuracy': 0.907, 'llm_top_10_test_accuracy': 0.9648, 'llm_top_20_test_accuracy': 0.9895999999999999, 'llm_top_50_test_accuracy': 0.9978000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.957200038433075, 'sae_top_1_test_accuracy': 0.6015999999999999, 'sae_top_2_test_accuracy': 0.6596, 'sae_top_5_test_accuracy': 0.7354, 'sae_top_10_test_accuracy': 0.7872, 'sae_top_20_test_accuracy': 0.8442000000000001, 'sae_top_50_test_accuracy': 0.9116, 'sae_top_100_test_accuracy': None}], 'sae_bench_commit_hash': 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'unlearning evaluation results': {'eval_type_id': 'unlearning', 'eval_config': {'random_seed': 42, 'dataset_names': ['wmdp-bio', 'high_school_us_history', 'college_computer_science', 'high_school_geography', 'human_aging'], 'intervention_method': 'clamp_feature_activation', 'retain_thresholds': [0.001, 0.01, 0.1, 0.5], 'n_features_list': [100, 200], 'multipliers': [25, 50, 100, 200], 'dataset_size': 1024, 'seq_len': 1024, 'n_batch_loss_added': 50, 'target_metric': 'correct', 'save_metrics': True, 'model_name': 'google/gemma-2-2b-it', 'llm_batch_size': 32, 'llm_dtype': 'bfloat16'}, 'eval_id': 'eefdda16-0d33-4876-a8a5-a6befe821e03', 'datetime_epoch_millis': 1738003893013, 'eval_result_metrics': {'unlearning': {'unlearning_score': 0.0037453174591064453}}, 'eval_result_details': [], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}}
Description: Baseline results.
