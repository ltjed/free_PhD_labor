Using GPUs: [0]
Using Anthropic API with model claude-3-5-sonnet-20241022.
ideas
Loaded existing ideas:
[{'Name': 'Orthogonal_sae', 'Title': 'Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders', 'Experiment': '1. Implement adaptive orthogonality loss with controlled feature sharing\n2. Add batch-wise feature grouping with periodic updates\n3. Train on Pythia-70M using WMDP-bio and WikiText datasets\n4. Compare unlearning performance against baseline and fixed orthogonal SAE\n5. Analyze condition numbers of feature subspaces\n6. Evaluate impact of different α values for controlled sharing', 'Technical_Details': 'The method uses an adaptive objective: L = L_recon + λ_1 * L_sparse + λ_2(t) * L_ortho where λ_2(t) = λ_2_max * min(1, t/t_0) increases linearly until step t_0. L_ortho = ||W_1^T W_2 - αI||_F allows controlled feature sharing through parameter α. Feature groups are updated every n=100 steps using efficient batch statistics. Implementation includes early stopping based on condition number thresholds. The decoder uses group-specific bias terms while sharing weights to balance separation and reconstruction quality.', 'Research_Impact': 'A key challenge in selective unlearning is finding the optimal balance between knowledge separation and model performance. Current approaches either sacrifice reconstruction quality for separation or vice versa. This research addresses the challenge through adaptive training and controlled feature sharing, achieving better separation while maintaining performance. The theoretical framework provides precise control over the separation-performance trade-off.', 'Implementation_Plan': '1. Add AdaptiveOrthogonalityLoss with scheduling\n2. Implement efficient batch-wise feature grouping\n3. Modify CustomSAE to include group-specific biases\n4. Add condition number calculation utilities\n5. Update CustomTrainer with adaptive loss weight\n6. Add evaluation metrics for controlled sharing', 'Interestingness_Evaluation': 'The combination of theoretical insights about feature sharing with practical adaptive training creates a more nuanced and effective approach to knowledge separation.', 'Interestingness': 9, 'Feasibility_Evaluation': 'The implementation remains efficient with batch-wise updates and simple matrix operations; adaptive weighting adds minimal overhead; controlled sharing through α provides easy tuning; all computations well within 30-minute limit on H100.', 'Feasibility': 9, 'Novelty_Evaluation': 'The adaptive approach with controlled feature sharing provides a novel theoretical framework for knowledge separation that bridges the gap between strict orthogonality and practical performance.', 'Novelty': 9, 'Overall_Score': 9.0, 'novel': True}]
Processing idea: Orthogonal_sae
2025-01-27 13:54:37
*Starting idea: 20250127_135437_Orthogonal_sae*
2025-01-27 13:54:37
*Starting Experiments*
Starting experiment with prompt for coder: Your goal is to implement the following idea: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders. Pay attention to the following details from the idea:
The proposed experiment is as follows: 1. Implement adaptive orthogonality loss with controlled feature sharing
2. Add batch-wise feature grouping with periodic updates
3. Train on Pythia-70M using WMDP-bio and WikiText datasets
4. Compare unlearning performance against baseline and fixed orthogonal SAE
5. Analyze condition numbers of feature subspaces
6. Evaluate impact of different α values for controlled sharing.
The implementation plan is as follows: 1. Add AdaptiveOrthogonalityLoss with scheduling
2. Implement efficient batch-wise feature grouping
3. Modify CustomSAE to include group-specific biases
4. Add condition number calculation utilities
5. Update CustomTrainer with adaptive loss weight
6. Add evaluation metrics for controlled sharing.

You can also refer to other information in the idea: {'Name': 'Orthogonal_sae', 'Title': 'Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders', 'Experiment': '1. Implement adaptive orthogonality loss with controlled feature sharing\n2. Add batch-wise feature grouping with periodic updates\n3. Train on Pythia-70M using WMDP-bio and WikiText datasets\n4. Compare unlearning performance against baseline and fixed orthogonal SAE\n5. Analyze condition numbers of feature subspaces\n6. Evaluate impact of different α values for controlled sharing', 'Technical_Details': 'The method uses an adaptive objective: L = L_recon + λ_1 * L_sparse + λ_2(t) * L_ortho where λ_2(t) = λ_2_max * min(1, t/t_0) increases linearly until step t_0. L_ortho = ||W_1^T W_2 - αI||_F allows controlled feature sharing through parameter α. Feature groups are updated every n=100 steps using efficient batch statistics. Implementation includes early stopping based on condition number thresholds. The decoder uses group-specific bias terms while sharing weights to balance separation and reconstruction quality.', 'Research_Impact': 'A key challenge in selective unlearning is finding the optimal balance between knowledge separation and model performance. Current approaches either sacrifice reconstruction quality for separation or vice versa. This research addresses the challenge through adaptive training and controlled feature sharing, achieving better separation while maintaining performance. The theoretical framework provides precise control over the separation-performance trade-off.', 'Implementation_Plan': '1. Add AdaptiveOrthogonalityLoss with scheduling\n2. Implement efficient batch-wise feature grouping\n3. Modify CustomSAE to include group-specific biases\n4. Add condition number calculation utilities\n5. Update CustomTrainer with adaptive loss weight\n6. Add evaluation metrics for controlled sharing', 'Interestingness_Evaluation': 'The combination of theoretical insights about feature sharing with practical adaptive training creates a more nuanced and effective approach to knowledge separation.', 'Interestingness': 9, 'Feasibility_Evaluation': 'The implementation remains efficient with batch-wise updates and simple matrix operations; adaptive weighting adds minimal overhead; controlled sharing through α provides easy tuning; all computations well within 30-minute limit on H100.', 'Feasibility': 9, 'Novelty_Evaluation': 'The adaptive approach with controlled feature sharing provides a novel theoretical framework for knowledge separation that bridges the gap between strict orthogonality and practical performance.', 'Novelty': 9, 'Overall_Score': 9.0, 'novel': True}

You are given a total of up to 10 runs to complete the necessary experiments. You do not need to use all 10.

First, plan the list of experiments you would like to run. For example, if you are sweeping over a specific hyperparameter, plan each value you would like to test for each run.

Note that we already provide the vanilla baseline results, so you do not need to re-run it.

For reference, the baseline results are as follows:

{'training results': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000, 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info': {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'core evaluation results': {'unique_id': 'google/gemma-2-2b_layer_19_sae_custom_sae', 'sae_set': 'google/gemma-2-2b_layer_19_sae', 'sae_id': 'custom_sae', 'eval_cfg': {'model_name': 'google/gemma-2-2b', 'llm_dtype': 'bfloat16', 'batch_size_prompts': 16, 'n_eval_reconstruction_batches': 200, 'n_eval_sparsity_variance_batches': 2000, 'dataset': 'Skylion007/openwebtext', 'context_size': 128, 'compute_kl': True, 'compute_ce_loss': True, 'compute_l2_norms': True, 'compute_sparsity_metrics': True, 'compute_variance_metrics': True, 'compute_featurewise_density_statistics': False, 'compute_featurewise_weight_based_metrics': False, 'exclude_special_tokens_from_reconstruction': True, 'verbose': False}, 'metrics': {'model_behavior_preservation': {'kl_div_score': 0.7950310559006211, 'kl_div_with_ablation': 10.0625, 'kl_div_with_sae': 2.0625}, 'model_performance_preservation': {'ce_loss_score': 0.7894736842105263, 'ce_loss_with_ablation': 12.4375, 'ce_loss_with_sae': 4.9375, 'ce_loss_without_sae': 2.9375}, 'reconstruction_quality': {'explained_variance': 0.30859375, 'mse': 18.75, 'cossim': 0.76953125}, 'shrinkage': {'l2_norm_in': 308.0, 'l2_norm_out': 221.0, 'l2_ratio': 0.71484375, 'relative_reconstruction_bias': 0.93359375}, 'sparsity': {'l0': 85.21243286132812, 'l1': 458.0}, 'token_stats': {'total_tokens_eval_reconstruction': 409600, 'total_tokens_eval_sparsity_variance': 4096000}}}, 'scr and tpp evaluations results': {'eval_type_id': 'scr', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'canrager/amazon_reviews_mcauley_1and5'], 'perform_scr': True, 'early_stopping_patience': 20, 'train_set_size': 4000, 'test_set_size': 1000, 'context_length': 128, 'probe_train_batch_size': 16, 'probe_test_batch_size': 500, 'probe_epochs': 20, 'probe_lr': 0.001, 'probe_l1_penalty': 0.001, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'lower_vram_usage': False, 'model_name': 'google/gemma-2-2b', 'n_values': [2, 5, 10, 20, 50, 100, 500], 'column1_vals_lookup': {'LabHC/bias_in_bios_class_set1': [['professor', 'nurse'], ['architect', 'journalist'], ['surgeon', 'psychologist'], ['attorney', 'teacher']], 'canrager/amazon_reviews_mcauley_1and5': [['Books', 'CDs_and_Vinyl'], ['Software', 'Electronics'], ['Pet_Supplies', 'Office_Products'], ['Industrial_and_Scientific', 'Toys_and_Games']]}}, 'eval_id': 'c28f32b2-a72e-4f76-8d5a-85d6f9937f1b', 'datetime_epoch_millis': 1737884773606, 'eval_result_metrics': {'scr_metrics': {'scr_dir1_threshold_2': 0.035600906531669814, 'scr_metric_threshold_2': 0.019679524675140548, 'scr_dir2_threshold_2': 0.011514810160172787, 'scr_dir1_threshold_5': 0.051710736232558285, 'scr_metric_threshold_5': 0.06512155475350995, 'scr_dir2_threshold_5': 0.05295877346813508, 'scr_dir1_threshold_10': 0.077764577667114, 'scr_metric_threshold_10': 0.08335696172542797, 'scr_dir2_threshold_10': 0.07006244094994978, 'scr_dir1_threshold_20': 0.07343213933631738, 'scr_metric_threshold_20': 0.08504280928786076, 'scr_dir2_threshold_20': 0.07359277159847097, 'scr_dir1_threshold_50': 0.03350340830709253, 'scr_metric_threshold_50': 0.08899691187101458, 'scr_dir2_threshold_50': 0.07593742114240237, 'scr_dir1_threshold_100': -0.16207016165821828, 'scr_metric_threshold_100': 0.062236305245427885, 'scr_dir2_threshold_100': 0.052638407599727086, 'scr_dir1_threshold_500': -0.25156349364441777, 'scr_metric_threshold_500': 0.027887084742431078, 'scr_dir2_threshold_500': 0.004238511981040263}}, 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_professor_nurse_results', 'scr_dir1_threshold_2': 0.03124962164991371, 'scr_metric_threshold_2': 0.012284998611665989, 'scr_dir2_threshold_2': 0.012284998611665989, 'scr_dir1_threshold_5': -0.015625742148246177, 'scr_metric_threshold_5': 0.05896816907447914, 'scr_dir2_threshold_5': 0.05896816907447914, 'scr_dir1_threshold_10': -0.015625742148246177, 'scr_metric_threshold_10': 0.14987724667004865, 'scr_dir2_threshold_10': 0.14987724667004865, 'scr_dir1_threshold_20': -0.03125055297320303, 'scr_metric_threshold_20': 0.15479118753522092, 'scr_dir2_threshold_20': 0.15479118753522092, 'scr_dir1_threshold_50': -0.2968760622906269, 'scr_metric_threshold_50': 0.16216224528171463, 'scr_dir2_threshold_50': 0.16216224528171463, 'scr_dir1_threshold_100': -1.312501804438873, 'scr_metric_threshold_100': 0.14987724667004865, 'scr_dir2_threshold_100': 0.14987724667004865, 'scr_dir1_threshold_500': -1.3750019790619898, 'scr_metric_threshold_500': 0.15724815796780706, 'scr_dir2_threshold_500': 0.15724815796780706}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_architect_journalist_results', 'scr_dir1_threshold_2': -0.08737868572318094, 'scr_metric_threshold_2': 0.034383855303823166, 'scr_dir2_threshold_2': 0.034383855303823166, 'scr_dir1_threshold_5': -0.10679649293164041, 'scr_metric_threshold_5': 0.06590258858377988, 'scr_dir2_threshold_5': 0.06590258858377988, 'scr_dir1_threshold_10': -0.11650510719289281, 'scr_metric_threshold_10': 0.037249318901607584, 'scr_dir2_threshold_10': 0.037249318901607584, 'scr_dir1_threshold_20': -0.10679649293164041, 'scr_metric_threshold_20': 0.04011461171243302, 'scr_dir2_threshold_20': 0.04011461171243302, 'scr_dir1_threshold_50': -0.14563152866260468, 'scr_metric_threshold_50': 0.07449846701625619, 'scr_dir2_threshold_50': 0.07449846701625619, 'scr_dir1_threshold_100': -0.14563152866260468, 'scr_metric_threshold_100': 0.10888249310703833, 'scr_dir2_threshold_100': 0.10888249310703833, 'scr_dir1_threshold_500': -0.3106797071617595, 'scr_metric_threshold_500': 0.0859598090465169, 'scr_dir2_threshold_500': 0.0859598090465169}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_surgeon_psychologist_results', 'scr_dir1_threshold_2': 0.015873751732555005, 'scr_metric_threshold_2': -0.0025316127159178037, 'scr_dir2_threshold_2': -0.0025316127159178037, 'scr_dir1_threshold_5': 0.03174655735998827, 'scr_metric_threshold_5': -0.005063225431835607, 'scr_dir2_threshold_5': -0.005063225431835607, 'scr_dir1_threshold_10': 0.0, 'scr_metric_threshold_10': 0.0075949890455728015, 'scr_dir2_threshold_10': 0.0075949890455728015, 'scr_dir1_threshold_20': -0.0634921686148548, 'scr_metric_threshold_20': 0.02784819256855401, 'scr_dir2_threshold_20': 0.02784819256855401, 'scr_dir1_threshold_50': -0.1111105854971546, 'scr_metric_threshold_50': 0.05316462152337083, 'scr_dir2_threshold_50': 0.05316462152337083, 'scr_dir1_threshold_100': -0.2222221170994309, 'scr_metric_threshold_100': 0.05316462152337083, 'scr_dir2_threshold_100': 0.05316462152337083, 'scr_dir1_threshold_500': -0.5714285714285714, 'scr_metric_threshold_500': 0.055696234239288635, 'scr_dir2_threshold_500': 0.055696234239288635}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_attorney_teacher_results', 'scr_dir1_threshold_2': 0.0, 'scr_metric_threshold_2': 0.020771598900727672, 'scr_dir2_threshold_2': 0.020771598900727672, 'scr_dir1_threshold_5': 0.0, 'scr_metric_threshold_5': 0.1246292396676148, 'scr_dir2_threshold_5': 0.1246292396676148, 'scr_dir1_threshold_10': -0.007812398136610098, 'scr_metric_threshold_10': 0.10089032002917621, 'scr_dir2_threshold_10': 0.10089032002917621, 'scr_dir1_threshold_20': 0.10156257275956422, 'scr_metric_threshold_20': 0.0890208602099569, 'scr_dir2_threshold_20': 0.0890208602099569, 'scr_dir1_threshold_50': 0.10156257275956422, 'scr_metric_threshold_50': 0.11869442132381734, 'scr_dir2_threshold_50': 0.11869442132381734, 'scr_dir1_threshold_100': -0.17187462165026607, 'scr_metric_threshold_100': 0.10979228224230897, 'scr_dir2_threshold_100': 0.10979228224230897, 'scr_dir1_threshold_500': -0.16406222351365599, 'scr_metric_threshold_500': 0.06824926130922924, 'scr_dir2_threshold_500': 0.06824926130922924}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Books_CDs_and_Vinyl_results', 'scr_dir1_threshold_2': -0.06010915791026799, 'scr_metric_threshold_2': -0.015686069182044467, 'scr_dir2_threshold_2': -0.015686069182044467, 'scr_dir1_threshold_5': -0.01092881936245188, 'scr_metric_threshold_5': 0.07450976358933016, 'scr_dir2_threshold_5': 0.07450976358933016, 'scr_dir1_threshold_10': 0.27322406685360157, 'scr_metric_threshold_10': 0.10588236944072857, 'scr_dir2_threshold_10': 0.10588236944072857, 'scr_dir1_threshold_20': 0.24043695734946327, 'scr_metric_threshold_20': 0.08235303192400713, 'scr_dir2_threshold_20': 0.08235303192400713, 'scr_dir1_threshold_50': 0.3005464409681226, 'scr_metric_threshold_50': 0.039215874186075375, 'scr_dir2_threshold_50': 0.039215874186075375, 'scr_dir1_threshold_100': 0.2568305121015324, 'scr_metric_threshold_100': 0.06274521170279682, 'scr_dir2_threshold_100': 0.06274521170279682, 'scr_dir1_threshold_500': 0.21311458323494226, 'scr_metric_threshold_500': -0.14901952717866032, 'scr_dir2_threshold_500': -0.14901952717866032}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Software_Electronics_results', 'scr_dir1_threshold_2': 0.158974152062764, 'scr_metric_threshold_2': 0.05241939554166917, 'scr_dir2_threshold_2': 0.05241939554166917, 'scr_dir1_threshold_5': 0.17948701489841076, 'scr_metric_threshold_5': 0.07258066454365199, 'scr_dir2_threshold_5': 0.07258066454365199, 'scr_dir1_threshold_10': 0.18461515419110838, 'scr_metric_threshold_10': 0.10483879108333834, 'scr_dir2_threshold_10': 0.10483879108333834, 'scr_dir1_threshold_20': 0.17435887560571312, 'scr_metric_threshold_20': 0.11693564862104187, 'scr_dir2_threshold_20': 0.11693564862104187, 'scr_dir1_threshold_50': 0.2102561563194528, 'scr_metric_threshold_50': 0.10887099681547797, 'scr_dir2_threshold_50': 0.10887099681547797, 'scr_dir1_threshold_100': 0.19487173844135988, 'scr_metric_threshold_100': -0.07258066454365199, 'scr_dir2_threshold_100': -0.07258066454365199, 'scr_dir1_threshold_500': 0.16410229135546164, 'scr_metric_threshold_500': -0.12499981974403652, 'scr_dir2_threshold_500': -0.12499981974403652}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Pet_Supplies_Office_Products_results', 'scr_dir1_threshold_2': 0.17040353950037407, 'scr_metric_threshold_2': 0.0, 'scr_dir2_threshold_2': 0.0, 'scr_dir1_threshold_5': 0.22421531016200436, 'scr_metric_threshold_5': 0.017857176118657926, 'scr_dir2_threshold_5': 0.017857176118657926, 'scr_dir1_threshold_10': 0.18834079638758416, 'scr_metric_threshold_10': 0.04464280725058454, 'scr_dir2_threshold_10': 0.04464280725058454, 'scr_dir1_threshold_20': 0.15246628261316397, 'scr_metric_threshold_20': 0.04910730084933944, 'scr_dir2_threshold_20': 0.04910730084933944, 'scr_dir1_threshold_50': 0.0762330076638747, 'scr_metric_threshold_50': 0.02232140362529227, 'scr_dir2_threshold_50': 0.02232140362529227, 'scr_dir1_threshold_100': 0.02242150428765898, 'scr_metric_threshold_100': 0.0044642275066343415, 'scr_dir2_threshold_100': 0.0044642275066343415, 'scr_dir1_threshold_500': -0.06726478014839152, 'scr_metric_threshold_500': 0.03125012473068151, 'scr_dir2_threshold_500': 0.03125012473068151}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Industrial_and_Scientific_Toys_and_Games_results', 'scr_dir1_threshold_2': 0.05579403094120067, 'scr_metric_threshold_2': 0.05579403094120067, 'scr_dir2_threshold_2': -0.009523685178541423, 'scr_dir1_threshold_5': 0.11158806188240133, 'scr_metric_threshold_5': 0.11158806188240133, 'scr_dir2_threshold_5': 0.014285811599402364, 'scr_dir1_threshold_10': 0.11587985138236706, 'scr_metric_threshold_10': 0.11587985138236706, 'scr_dir2_threshold_10': 0.009523685178541423, 'scr_dir1_threshold_20': 0.12017164088233277, 'scr_metric_threshold_20': 0.12017164088233277, 'scr_dir2_threshold_20': 0.0285713393672145, 'scr_dir1_threshold_50': 0.13304726519611204, 'scr_metric_threshold_50': 0.13304726519611204, 'scr_dir2_threshold_50': 0.0285713393672145, 'scr_dir1_threshold_100': 0.08154502375487709, 'scr_metric_threshold_100': 0.08154502375487709, 'scr_dir2_threshold_100': 0.004761842589270712, 'scr_dir1_threshold_500': 0.09871243756862208, 'scr_metric_threshold_500': 0.09871243756862208, 'scr_dir2_threshold_500': -0.09047614452250444}], 'sae_bench_commit_hash': 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'absorption evaluation results': {'eval_type_id': 'absorption_first_letter', 'eval_config': {'model_name': 'google/gemma-2-2b', 'random_seed': 42, 'f1_jump_threshold': 0.03, 'max_k_value': 10, 'prompt_template': '{word} has the first letter:', 'prompt_token_pos': -6, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'k_sparse_probe_l1_decay': 0.01, 'k_sparse_probe_batch_size': 4096, 'k_sparse_probe_num_epochs': 50}, 'eval_id': '515e7b3b-6b86-4214-aa0d-c2ef123e2969', 'datetime_epoch_millis': 1737999200566, 'eval_result_metrics': {'mean': {'mean_absorption_score': 0.010124895517470242, 'mean_num_split_features': 1.2}}, 'eval_result_details': [{'first_letter': 'a', 'absorption_rate': 0.00986971969996052, 'num_absorption': 25, 'num_probe_true_positives': 2533, 'num_split_features': 1}, {'first_letter': 'b', 'absorption_rate': 0.005050505050505051, 'num_absorption': 8, 'num_probe_true_positives': 1584, 'num_split_features': 1}, {'first_letter': 'c', 'absorption_rate': 0.02792890823358723, 'num_absorption': 77, 'num_probe_true_positives': 2757, 'num_split_features': 1}, {'first_letter': 'd', 'absorption_rate': 0.008631319358816275, 'num_absorption': 14, 'num_probe_true_positives': 1622, 'num_split_features': 1}, {'first_letter': 'e', 'absorption_rate': 0.002523659305993691, 'num_absorption': 4, 'num_probe_true_positives': 1585, 'num_split_features': 1}, {'first_letter': 'f', 'absorption_rate': 0.004942339373970346, 'num_absorption': 6, 'num_probe_true_positives': 1214, 'num_split_features': 1}, {'first_letter': 'g', 'absorption_rate': 0.0026362038664323375, 'num_absorption': 3, 'num_probe_true_positives': 1138, 'num_split_features': 1}, {'first_letter': 'h', 'absorption_rate': 0.08004158004158005, 'num_absorption': 77, 'num_probe_true_positives': 962, 'num_split_features': 1}, {'first_letter': 'i', 'absorption_rate': 0.007402837754472548, 'num_absorption': 12, 'num_probe_true_positives': 1621, 'num_split_features': 2}, {'first_letter': 'j', 'absorption_rate': 0.03546099290780142, 'num_absorption': 15, 'num_probe_true_positives': 423, 'num_split_features': 1}, {'first_letter': 'k', 'absorption_rate': 0.001557632398753894, 'num_absorption': 1, 'num_probe_true_positives': 642, 'num_split_features': 1}, {'first_letter': 'l', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 1196, 'num_split_features': 1}, {'first_letter': 'm', 'absorption_rate': 0.0060406370126304225, 'num_absorption': 11, 'num_probe_true_positives': 1821, 'num_split_features': 1}, {'first_letter': 'n', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 845, 'num_split_features': 1}, {'first_letter': 'o', 'absorption_rate': 0.007070707070707071, 'num_absorption': 7, 'num_probe_true_positives': 990, 'num_split_features': 1}, {'first_letter': 'p', 'absorption_rate': 0.0004332755632582322, 'num_absorption': 1, 'num_probe_true_positives': 2308, 'num_split_features': 2}, {'first_letter': 'q', 'absorption_rate': 0.011428571428571429, 'num_absorption': 2, 'num_probe_true_positives': 175, 'num_split_features': 1}, {'first_letter': 'r', 'absorption_rate': 0.006053268765133172, 'num_absorption': 10, 'num_probe_true_positives': 1652, 'num_split_features': 2}, {'first_letter': 's', 'absorption_rate': 0.005263157894736842, 'num_absorption': 15, 'num_probe_true_positives': 2850, 'num_split_features': 1}, {'first_letter': 't', 'absorption_rate': 0.00357355568790947, 'num_absorption': 6, 'num_probe_true_positives': 1679, 'num_split_features': 2}, {'first_letter': 'u', 'absorption_rate': 0.0013297872340425532, 'num_absorption': 1, 'num_probe_true_positives': 752, 'num_split_features': 2}, {'first_letter': 'v', 'absorption_rate': 0.0012738853503184713, 'num_absorption': 1, 'num_probe_true_positives': 785, 'num_split_features': 1}, {'first_letter': 'w', 'absorption_rate': 0.004201680672268907, 'num_absorption': 3, 'num_probe_true_positives': 714, 'num_split_features': 1}, {'first_letter': 'y', 'absorption_rate': 0.02040816326530612, 'num_absorption': 3, 'num_probe_true_positives': 147, 'num_split_features': 1}, {'first_letter': 'z', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 230, 'num_split_features': 1}], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'sparse probing evaluation results': {'eval_type_id': 'sparse_probing', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'LabHC/bias_in_bios_class_set2', 'LabHC/bias_in_bios_class_set3', 'canrager/amazon_reviews_mcauley_1and5', 'canrager/amazon_reviews_mcauley_1and5_sentiment', 'codeparrot/github-code', 'fancyzhx/ag_news', 'Helsinki-NLP/europarl'], 'probe_train_set_size': 4000, 'probe_test_set_size': 1000, 'context_length': 128, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'model_name': 'google/gemma-2-2b', 'k_values': [1, 2, 5, 10, 20, 50], 'lower_vram_usage': False}, 'eval_id': 'fddb5e3e-09c2-4d2c-b7ac-9077585d20ec', 'datetime_epoch_millis': 1737900662632, 'eval_result_metrics': {'llm': {'llm_test_accuracy': 0.9505874999999999, 'llm_top_1_test_accuracy': 0.6539375, 'llm_top_2_test_accuracy': 0.7235875, 'llm_top_5_test_accuracy': 0.7815, 'llm_top_10_test_accuracy': 0.8289187499999999, 'llm_top_20_test_accuracy': 0.8770187500000001, 'llm_top_50_test_accuracy': 0.9236000000000001, 'llm_top_100_test_accuracy': None}, 'sae': {'sae_test_accuracy': 0.9151000421494245, 'sae_top_1_test_accuracy': 0.6601812499999999, 'sae_top_2_test_accuracy': 0.70936875, 'sae_top_5_test_accuracy': 0.7653812499999999, 'sae_top_10_test_accuracy': 0.8049125000000001, 'sae_top_20_test_accuracy': 0.84908125, 'sae_top_50_test_accuracy': 0.8829625, 'sae_top_100_test_accuracy': None}}, 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_results', 'llm_test_accuracy': 0.9596, 'llm_top_1_test_accuracy': 0.6432, 'llm_top_2_test_accuracy': 0.6916, 'llm_top_5_test_accuracy': 0.7912, 'llm_top_10_test_accuracy': 0.8336, 'llm_top_20_test_accuracy': 0.8962, 'llm_top_50_test_accuracy': 0.9384, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9414000391960144, 'sae_top_1_test_accuracy': 0.6437999999999999, 'sae_top_2_test_accuracy': 0.7016, 'sae_top_5_test_accuracy': 0.7776, 'sae_top_10_test_accuracy': 0.8150000000000001, 'sae_top_20_test_accuracy': 0.8516, 'sae_top_50_test_accuracy': 0.9064, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'LabHC/bias_in_bios_class_set2_results', 'llm_test_accuracy': 0.9468, 'llm_top_1_test_accuracy': 0.6779999999999999, 'llm_top_2_test_accuracy': 0.7282, 'llm_top_5_test_accuracy': 0.77, 'llm_top_10_test_accuracy': 0.8024000000000001, 'llm_top_20_test_accuracy': 0.8596, 'llm_top_50_test_accuracy': 0.9076000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9112000346183777, 'sae_top_1_test_accuracy': 0.6588, 'sae_top_2_test_accuracy': 0.6958, 'sae_top_5_test_accuracy': 0.7487999999999999, 'sae_top_10_test_accuracy': 0.8055999999999999, 'sae_top_20_test_accuracy': 0.849, 'sae_top_50_test_accuracy': 0.8788, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'LabHC/bias_in_bios_class_set3_results', 'llm_test_accuracy': 0.914, 'llm_top_1_test_accuracy': 0.6888, 'llm_top_2_test_accuracy': 0.7322, 'llm_top_5_test_accuracy': 0.7544000000000001, 'llm_top_10_test_accuracy': 0.7958, 'llm_top_20_test_accuracy': 0.8518000000000001, 'llm_top_50_test_accuracy': 0.8942, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.8954000353813172, 'sae_top_1_test_accuracy': 0.6872, 'sae_top_2_test_accuracy': 0.716, 'sae_top_5_test_accuracy': 0.7642, 'sae_top_10_test_accuracy': 0.8092, 'sae_top_20_test_accuracy': 0.8370000000000001, 'sae_top_50_test_accuracy': 0.8684000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_results', 'llm_test_accuracy': 0.897, 'llm_top_1_test_accuracy': 0.6003999999999999, 'llm_top_2_test_accuracy': 0.6422000000000001, 'llm_top_5_test_accuracy': 0.6752, 'llm_top_10_test_accuracy': 0.7379999999999999, 'llm_top_20_test_accuracy': 0.8098000000000001, 'llm_top_50_test_accuracy': 0.8640000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.8272000432014466, 'sae_top_1_test_accuracy': 0.5764000000000001, 'sae_top_2_test_accuracy': 0.5928, 'sae_top_5_test_accuracy': 0.6258, 'sae_top_10_test_accuracy': 0.6836, 'sae_top_20_test_accuracy': 0.76, 'sae_top_50_test_accuracy': 0.7934, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_sentiment_results', 'llm_test_accuracy': 0.9815, 'llm_top_1_test_accuracy': 0.671, 'llm_top_2_test_accuracy': 0.724, 'llm_top_5_test_accuracy': 0.766, 'llm_top_10_test_accuracy': 0.826, 'llm_top_20_test_accuracy': 0.847, 'llm_top_50_test_accuracy': 0.933, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9355000555515289, 'sae_top_1_test_accuracy': 0.797, 'sae_top_2_test_accuracy': 0.888, 'sae_top_5_test_accuracy': 0.893, 'sae_top_10_test_accuracy': 0.892, 'sae_top_20_test_accuracy': 0.916, 'sae_top_50_test_accuracy': 0.91, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'codeparrot/github-code_results', 'llm_test_accuracy': 0.9673999999999999, 'llm_top_1_test_accuracy': 0.6672, 'llm_top_2_test_accuracy': 0.7051999999999999, 'llm_top_5_test_accuracy': 0.7662, 'llm_top_10_test_accuracy': 0.8019999999999999, 'llm_top_20_test_accuracy': 0.8624, 'llm_top_50_test_accuracy': 0.9298, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9314000487327576, 'sae_top_1_test_accuracy': 0.6874, 'sae_top_2_test_accuracy': 0.6843999999999999, 'sae_top_5_test_accuracy': 0.765, 'sae_top_10_test_accuracy': 0.8022, 'sae_top_20_test_accuracy': 0.8555999999999999, 'sae_top_50_test_accuracy': 0.8926000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'fancyzhx/ag_news_results', 'llm_test_accuracy': 0.9390000000000001, 'llm_top_1_test_accuracy': 0.6385000000000001, 'llm_top_2_test_accuracy': 0.7815, 'llm_top_5_test_accuracy': 0.822, 'llm_top_10_test_accuracy': 0.8687499999999999, 'llm_top_20_test_accuracy': 0.89975, 'llm_top_50_test_accuracy': 0.924, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9215000420808792, 'sae_top_1_test_accuracy': 0.62925, 'sae_top_2_test_accuracy': 0.73675, 'sae_top_5_test_accuracy': 0.81325, 'sae_top_10_test_accuracy': 0.8445, 'sae_top_20_test_accuracy': 0.8792500000000001, 'sae_top_50_test_accuracy': 0.9025000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'Helsinki-NLP/europarl_results', 'llm_test_accuracy': 0.9994, 'llm_top_1_test_accuracy': 0.6443999999999999, 'llm_top_2_test_accuracy': 0.7837999999999999, 'llm_top_5_test_accuracy': 0.907, 'llm_top_10_test_accuracy': 0.9648, 'llm_top_20_test_accuracy': 0.9895999999999999, 'llm_top_50_test_accuracy': 0.9978000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.957200038433075, 'sae_top_1_test_accuracy': 0.6015999999999999, 'sae_top_2_test_accuracy': 0.6596, 'sae_top_5_test_accuracy': 0.7354, 'sae_top_10_test_accuracy': 0.7872, 'sae_top_20_test_accuracy': 0.8442000000000001, 'sae_top_50_test_accuracy': 0.9116, 'sae_top_100_test_accuracy': None}], 'sae_bench_commit_hash': 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'training results for layer 19': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000, 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info': {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'unlearning evaluation results': {'eval_type_id': 'unlearning', 'eval_config': {'random_seed': 42, 'dataset_names': ['wmdp-bio', 'high_school_us_history', 'college_computer_science', 'high_school_geography', 'human_aging'], 'intervention_method': 'clamp_feature_activation', 'retain_thresholds': [0.001, 0.01, 0.1, 0.5], 'n_features_list': [100, 200], 'multipliers': [25, 50, 100, 200], 'dataset_size': 1024, 'seq_len': 1024, 'n_batch_loss_added': 50, 'target_metric': 'correct', 'save_metrics': True, 'model_name': 'google/gemma-2-2b-it', 'llm_batch_size': 32, 'llm_dtype': 'bfloat16'}, 'eval_id': 'eefdda16-0d33-4876-a8a5-a6befe821e03', 'datetime_epoch_millis': 1738003893013, 'eval_result_metrics': {'unlearning': {'unlearning_score': 0.0037453174591064453}}, 'eval_result_details': [], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}}

After you complete each change, we will run the command `python experiment.py --out_dir=run_i' where i is the run number and evaluate the results.
YOUR PROPOSED CHANGE MUST USE THIS COMMAND FORMAT, DO NOT ADD ADDITIONAL COMMAND LINE ARGS.
You can then implement the next thing on your list.
Currently on iteration 0 of run 1
I'll help implement the Orthogonal Feature Learning SAE experiment. Let's plan the runs:                                                                                                             

Run 1: Implement basic orthogonal SAE with α=0 (strict orthogonality) Run 2: Test α=0.1 for controlled feature sharing Run 3: Test α=0.2 for controlled feature sharing Run 4: Test α=0.3 for        
controlled feature sharing                                                                                                                                                                           

This will give us a good range to evaluate the impact of controlled feature sharing while keeping the other parameters fixed.                                                                        

Let's start with Run 1 by implementing the orthogonal SAE with strict orthogonality (α=0). We need to:                                                                                               

 1 Rename CustomSAE to OrthogonalSAE                                                                                                                                                                 
 2 Add orthogonality loss                                                                                                                                                                            
 3 Add condition number calculation                                                                                                                                                                  
 4 Update the trainer                                                                                                                                                                                

Here are the changes for Run 1:                                                                                                                                                                      

experiment.py                                                                                                                                                                                        

                                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                                      
 class CustomSAE(nn.Module):                                                                                                                                                                         
     """Implementation of a Custom Sparse Autoencoder."""                                                                                                                                            
 =======                                                                                                                                                                                             
 class OrthogonalSAE(nn.Module):                                                                                                                                                                     
     """Implementation of Orthogonal Sparse Autoencoder with controlled feature sharing."""                                                                                                          
 >>>>>>> REPLACE                                                                                                                                                                                     
                                                                                                                                                                                                     

experiment.py                                                                                                                                                                                        

                                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                                      
         self.cfg = CustomSAEConfig(                                                                                                                                                                 
             model_name=model_name,                                                                                                                                                                  
             d_in=d_in,                                                                                                                                                                              
             d_sae=d_sae,                                                                                                                                                                            
             hook_name=hook_name,                                                                                                                                                                    
             hook_layer=hook_layer,                                                                                                                                                                  
             architecture="Custom",                                                                                                                                                                  
             activation_fn_str="relu",                                                                                                                                                               
             apply_b_dec_to_input=True,                                                                                                                                                              
         )                                                                                                                                                                                           
 =======                                                                                                                                                                                             
         self.cfg = CustomSAEConfig(                                                                                                                                                                 
             model_name=model_name,                                                                                                                                                                  
             d_in=d_in,                                                                                                                                                                              
             d_sae=d_sae,                                                                                                                                                                            
             hook_name=hook_name,                                                                                                                                                                    
             hook_layer=hook_layer,                                                                                                                                                                  
             architecture="Orthogonal",                                                                                                                                                              
             activation_fn_str="relu",                                                                                                                                                               
             apply_b_dec_to_input=True,                                                                                                                                                              
         )                                                                                                                                                                                           
                                                                                                                                                                                                     
         # Initialize feature groups                                                                                                                                                                 
         self.n_groups = 4  # Number of feature groups                                                                                                                                               
         self.group_size = d_sae // self.n_groups                                                                                                                                                    
         self.group_assignments = torch.arange(d_sae).reshape(self.n_groups, -1)                                                                                                                     
         self.alpha = 0.0  # Strict orthogonality for first run                                                                                                                                      
 >>>>>>> REPLACE                                                                                                                                                                                     
                                                                                                                                                                                                     

experiment.py                                                                                                                                                                                        

                                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                                      
 class CustomTrainer(SAETrainer):                                                                                                                                                                    
     """Trainer for Custom Sparse Autoencoder using L1 regularization."""                                                                                                                            
 =======                                                                                                                                                                                             
 class OrthogonalTrainer(SAETrainer):                                                                                                                                                                
     """Trainer for Orthogonal Sparse Autoencoder with adaptive orthogonality loss."""                                                                                                               
 >>>>>>> REPLACE                                                                                                                                                                                     
                                                                                                                                                                                                     

experiment.py                                                                                                                                                                                        

                                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                                      
         self.ae = CustomSAE(d_in=activation_dim, d_sae=dict_size, hook_layer=layer, model_name=lm_name)                                                                                             
 =======                                                                                                                                                                                             
         self.ae = OrthogonalSAE(d_in=activation_dim, d_sae=dict_size, hook_layer=layer, model_name=lm_name)                                                                                         
 >>>>>>> REPLACE                                                                                                                                                                                     
                                                                                                                                                                                                     

experiment.py                                                                                                                                                                                        

                                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                                      
     def loss(self, x, logging=False, **kwargs):                                                                                                                                                     
         x_hat, f = self.ae(x, output_features=True)                                                                                                                                                 
         l2_loss = torch.linalg.norm(x - x_hat, dim=-1).mean()                                                                                                                                       
         l1_loss = f.norm(p=1, dim=-1).mean()                                                                                                                                                        
                                                                                                                                                                                                     
         if self.steps_since_active is not None:                                                                                                                                                     
             # Update steps_since_active                                                                                                                                                             
             deads = (f == 0).all(dim=0)                                                                                                                                                             
             self.steps_since_active[deads] += 1                                                                                                                                                     
             self.steps_since_active[~deads] = 0                                                                                                                                                     
                                                                                                                                                                                                     
         loss = l2_loss + self.l1_penalty * l1_loss                                                                                                                                                  
 =======                                                                                                                                                                                             
     def compute_orthogonality_loss(self):                                                                                                                                                           
         """Compute orthogonality loss between feature groups"""                                                                                                                                     
         ortho_loss = 0                                                                                                                                                                              
         for i in range(self.ae.n_groups):                                                                                                                                                           
             for j in range(i+1, self.ae.n_groups):                                                                                                                                                  
                 group_i = self.ae.W_enc[:, self.ae.group_assignments[i]]                                                                                                                            
                 group_j = self.ae.W_enc[:, self.ae.group_assignments[j]]                                                                                                                            
                 # Compute cross-correlation matrix                                                                                                                                                  
                 cross_corr = torch.mm(group_i.t(), group_j)                                                                                                                                         
                 # Target is zero matrix for strict orthogonality (alpha=0)                                                                                                                          
                 target = self.ae.alpha * torch.eye(cross_corr.shape[0], device=cross_corr.device)                                                                                                   
                 ortho_loss += torch.norm(cross_corr - target, p='fro')                                                                                                                              
         return ortho_loss                                                                                                                                                                           
                                                                                                                                                                                                     
     def compute_condition_number(self):                                                                                                                                                             
         """Compute condition number of weight matrices"""                                                                                                                                           
         _, s, _ = torch.svd(self.ae.W_enc)                                                                                                                                                          
         return s[0] / s[-1]                                                                                                                                                                         
                                                                                                                                                                                                     
     def loss(self, x, logging=False, **kwargs):                                                                                                                                                     
         x_hat, f = self.ae(x, output_features=True)                                                                                                                                                 
         l2_loss = torch.linalg.norm(x - x_hat, dim=-1).mean()                                                                                                                                       
         l1_loss = f.norm(p=1, dim=-1).mean()                                                                                                                                                        
         ortho_loss = self.compute_orthogonality_loss()                                                                                                                                              
                                                                                                                                                                                                     
         if self.steps_since_active is not None:                                                                                                                                                     
             deads = (f == 0).all(dim=0)                                                                                                                                                             
             self.steps_since_active[deads] += 1                                                                                                                                                     
             self.steps_since_active[~deads] = 0                                                                                                                                                     
                                                                                                                                                                                                     
         # Adaptive orthogonality weight                                                                                                                                                             
         ortho_weight = min(1.0, self.scheduler._step_count / self.warmup_steps)                                                                                                                     
         loss = l2_loss + self.l1_penalty * l1_loss + ortho_weight * ortho_loss                                                                                                                      
 >>>>>>> REPLACE                                                                                                                                                                                     
                                                                                                                                                                                                     

experiment.py                                                                                                                                                                                        

                                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                                      
         return {"loss_for_backward": loss, "loss" : loss.cpu().item(), "l1_loss" : l1_loss.cpu().item(), "l2_loss" : l2_loss.cpu().item()}                                                          
 =======                                                                                                                                                                                             
         metrics = {                                                                                                                                                                                 
             "loss_for_backward": loss,                                                                                                                                                              
             "loss": loss.cpu().item(),                                                                                                                                                              
             "l1_loss": l1_loss.cpu().item(),                                                                                                                                                        
             "l2_loss": l2_loss.cpu().item(),                                                                                                                                                        
             "ortho_loss": ortho_loss.cpu().item(),                                                                                                                                                  
             "condition_number": self.compute_condition_number().cpu().item()                                                                                                                        
         }                                                                                                                                                                                           
         return metrics                                                                                                                                                                              
 >>>>>>> REPLACE                                                                                                                                                                                     
                                                                                                                                                                                                     

experiment.py                                                                                                                                                                                        

                                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                                      
             'trainer_class': 'CustomTrainer',                                                                                                                                                       
 =======                                                                                                                                                                                             
             'trainer_class': 'OrthogonalTrainer',                                                                                                                                                   
 >>>>>>> REPLACE                                                                                                                                                                                     
                                                                                                                                                                                                     

Now we can run the first experiment with:                                                                                                                                                            

                                                                                                                                                                                                     
 python experiment.py --out_dir=run_1                                                                                                                                                                
                                                                                                                                                                                                     

This implements the basic orthogonal SAE with:                                                                                                                                                       

 • Strict orthogonality (α=0)                                                                                                                                                                        
 • 4 feature groups                                                                                                                                                                                  
 • Adaptive orthogonality loss weight                                                                                                                                                                
 • Condition number monitoring                                                                                                                                                                       
 • Group-specific feature organization                                                                                                                                                               

After we see the results, we can proceed with Run 2 to test α=0.1 for controlled feature sharing.                                                                                                    

Tokens: 37k sent, 1.9k received. Cost: $0.14 message, $0.14 session.
Applied edit to experiment.py

# Fix any errors below, if possible.

## Running: /gpfs/radev/home/tl784/.conda/envs/ai_scientist/bin/python -m flake8 --select=E9,F821,F823,F831,F406,F407,F701,F702,F704,F706 --show-source --isolated experiment.py

experiment.py:439:15: F821 undefined name 'CustomTrainer'
    trainer = CustomTrainer(
              ^

## See relevant line below marked with █.

experiment.py:
...⋮...
379│def run_sae_training(
380│    layer: int,
381│    dict_size: int,
382│    num_tokens: int,
383│    out_dir: str,  # Changed from save_dir to out_dir for consistency
384│    device: str,
385│    model_name: str = "google/gemma-2-2b",
386│    context_length: int = 128,
387│    buffer_size: int = 2048,
388│    llm_batch_size: int = 24,
...⋮...
399│    out_dir = os.path.abspath(out_dir)
...⋮...
436│    )
437│
438│    # Initialize trainer  
439█    trainer = CustomTrainer(
440│        activation_dim=activation_dim,
441│        dict_size=dict_size,
442│        lr=learning_rate,
443│        l1_penalty=sparsity_penalty,
444│        warmup_steps=warmup_steps,
445│        seed=seed,
446│        device=device,
447│        layer=layer,
448│        lm_name=model_name,
...⋮...


I'll fix the undefined name error by updating the trainer initialization to use OrthogonalTrainer instead of CustomTrainer:                                                                          

experiment.py                                                                                                                                                                                        

                                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                                      
     trainer = CustomTrainer(                                                                                                                                                                        
 =======                                                                                                                                                                                             
     trainer = OrthogonalTrainer(                                                                                                                                                                    
 >>>>>>> REPLACE                                                                                                                                                                                     
                                                                                                                                                                                                     

This matches the new OrthogonalTrainer class we defined earlier in the file. Now you can run:                                                                                                        

                                                                                                                                                                                                     
 python experiment.py --out_dir=run_1                                                                                                                                                                
                                                                                                                                                                                                     

Tokens: 30k sent, 116 received. Cost: $0.09 message, $0.23 session.
Applied edit to experiment.py

python experiment.py --out_dir=run_1
Step 0: {'loss': 913.3262939453125, 'l1_loss': 8814.16796875, 'l2_loss': 560.615478515625, 'ortho_loss': 144.08868408203125, 'condition_number': 16592.69921875}
Step 100: {'loss': 619.9473876953125, 'l1_loss': 6244.07080078125, 'l2_loss': 355.7616882324219, 'ortho_loss': 142.80047607421875, 'condition_number': 125554.9140625}
Step 200: {'loss': 460.9526062011719, 'l1_loss': 2793.5234375, 'l2_loss': 318.5714416503906, 'ortho_loss': 152.43887329101562, 'condition_number': 7914.95947265625}
Step 300: {'loss': 410.7900085449219, 'l1_loss': 1382.495361328125, 'l2_loss': 308.349365234375, 'ortho_loss': 156.61404418945312, 'condition_number': 10014.0966796875}
Step 400: {'loss': 387.8748779296875, 'l1_loss': 1074.211181640625, 'l2_loss': 296.0204772949219, 'ortho_loss': 121.91011810302734, 'condition_number': 28771.974609375}
Step 500: {'loss': 353.3125915527344, 'l1_loss': 1098.10302734375, 'l2_loss': 267.6427001953125, 'ortho_loss': 83.32486724853516, 'condition_number': 10030.517578125}
Step 600: {'loss': 316.5441589355469, 'l1_loss': 981.465576171875, 'l2_loss': 249.3092498779297, 'ortho_loss': 46.54957962036133, 'condition_number': 40961.4609375}
Step 700: {'loss': 281.0435791015625, 'l1_loss': 911.9305419921875, 'l2_loss': 229.9165802001953, 'ortho_loss': 20.898408889770508, 'condition_number': 50303.5625}
Step 800: {'loss': 258.9657287597656, 'l1_loss': 907.0827026367188, 'l2_loss': 220.1712646484375, 'ortho_loss': 3.1350271701812744, 'condition_number': 3277.35546875}
Step 900: {'loss': 246.0354461669922, 'l1_loss': 765.1612548828125, 'l2_loss': 214.66513061523438, 'ortho_loss': 0.8478102684020996, 'condition_number': 10017.7802734375}
Step 1000: {'loss': 244.97109985351562, 'l1_loss': 802.4605712890625, 'l2_loss': 212.10443115234375, 'ortho_loss': 0.7682421207427979, 'condition_number': 2577.523193359375}
Step 1100: {'loss': 237.63909912109375, 'l1_loss': 671.1710205078125, 'l2_loss': 209.80657958984375, 'ortho_loss': 0.985684871673584, 'condition_number': 1705.49365234375}
Step 1200: {'loss': 230.6248321533203, 'l1_loss': 562.6973266601562, 'l2_loss': 206.9569091796875, 'ortho_loss': 1.1600395441055298, 'condition_number': 1422.8531494140625}
Step 1300: {'loss': 232.72525024414062, 'l1_loss': 610.322998046875, 'l2_loss': 207.29867553710938, 'ortho_loss': 1.0136531591415405, 'condition_number': 1377.23291015625}
Step 1400: {'loss': 229.41526794433594, 'l1_loss': 618.5928955078125, 'l2_loss': 203.69528198242188, 'ortho_loss': 0.9762733578681946, 'condition_number': 1418.2958984375}
Step 1500: {'loss': 227.30838012695312, 'l1_loss': 567.6923828125, 'l2_loss': 203.81182861328125, 'ortho_loss': 0.7888555526733398, 'condition_number': 1591.44775390625}
Step 1600: {'loss': 226.53297424316406, 'l1_loss': 565.6121826171875, 'l2_loss': 202.9637451171875, 'ortho_loss': 0.9447467923164368, 'condition_number': 1671.9656982421875}
Step 1700: {'loss': 224.0775146484375, 'l1_loss': 538.0198974609375, 'l2_loss': 201.5626678466797, 'ortho_loss': 0.9940444231033325, 'condition_number': 2054.115966796875}
Step 1800: {'loss': 224.05838012695312, 'l1_loss': 564.2907104492188, 'l2_loss': 200.56825256347656, 'ortho_loss': 0.9185018539428711, 'condition_number': 2972.68603515625}
Step 1900: {'loss': 222.26393127441406, 'l1_loss': 538.1249389648438, 'l2_loss': 199.88433837890625, 'ortho_loss': 0.8545975685119629, 'condition_number': 9496.2685546875}
Step 2000: {'loss': 221.1132354736328, 'l1_loss': 531.8995971679688, 'l2_loss': 199.03355407714844, 'ortho_loss': 0.8036916851997375, 'condition_number': 10648.623046875}
Step 2100: {'loss': 221.1470489501953, 'l1_loss': 507.924072265625, 'l2_loss': 200.05532836914062, 'ortho_loss': 0.7747664451599121, 'condition_number': 5868.70751953125}
Step 2200: {'loss': 217.0144500732422, 'l1_loss': 463.33038330078125, 'l2_loss': 197.74710083007812, 'ortho_loss': 0.7341336011886597, 'condition_number': 4136.6826171875}
Step 2300: {'loss': 217.5014190673828, 'l1_loss': 512.9871826171875, 'l2_loss': 196.27484130859375, 'ortho_loss': 0.7070989608764648, 'condition_number': 3552.194091796875}
Step 2400: {'loss': 217.35289001464844, 'l1_loss': 500.50286865234375, 'l2_loss': 196.65390014648438, 'ortho_loss': 0.6788846254348755, 'condition_number': 2916.085693359375}
Step 2500: {'loss': 215.0903778076172, 'l1_loss': 505.5677185058594, 'l2_loss': 194.2012939453125, 'ortho_loss': 0.6663851141929626, 'condition_number': 2603.281982421875}
Step 2600: {'loss': 215.125, 'l1_loss': 529.0222778320312, 'l2_loss': 193.3218231201172, 'ortho_loss': 0.6422899961471558, 'condition_number': 2598.495849609375}
Step 2700: {'loss': 214.39549255371094, 'l1_loss': 501.93121337890625, 'l2_loss': 193.6954803466797, 'ortho_loss': 0.6227539777755737, 'condition_number': 2559.5751953125}
Step 2800: {'loss': 213.12925720214844, 'l1_loss': 480.9227294921875, 'l2_loss': 193.28140258789062, 'ortho_loss': 0.6109482645988464, 'condition_number': 3023.2705078125}
Step 2900: {'loss': 210.82492065429688, 'l1_loss': 464.605224609375, 'l2_loss': 191.6457061767578, 'ortho_loss': 0.5950063467025757, 'condition_number': 3337.794677734375}
Step 3000: {'loss': 212.27833557128906, 'l1_loss': 501.58935546875, 'l2_loss': 191.6328125, 'ortho_loss': 0.5819597244262695, 'condition_number': 3648.36376953125}
Step 3100: {'loss': 210.29859924316406, 'l1_loss': 491.43829345703125, 'l2_loss': 190.05575561523438, 'ortho_loss': 0.5853188633918762, 'condition_number': 4802.01025390625}
Step 3200: {'loss': 209.8590087890625, 'l1_loss': 472.47723388671875, 'l2_loss': 190.3966064453125, 'ortho_loss': 0.5633109211921692, 'condition_number': 5974.75048828125}
Step 3300: {'loss': 208.9134063720703, 'l1_loss': 472.3818359375, 'l2_loss': 189.46409606933594, 'ortho_loss': 0.5540303587913513, 'condition_number': 5252.51025390625}
Step 3400: {'loss': 209.89059448242188, 'l1_loss': 496.5948486328125, 'l2_loss': 189.48374938964844, 'ortho_loss': 0.5430374145507812, 'condition_number': 5671.521484375}
Step 3500: {'loss': 206.30337524414062, 'l1_loss': 465.0397644042969, 'l2_loss': 187.07135009765625, 'ortho_loss': 0.630436897277832, 'condition_number': 6352.29052734375}
Step 3600: {'loss': 208.69412231445312, 'l1_loss': 491.78741455078125, 'l2_loss': 188.20416259765625, 'ortho_loss': 0.818464457988739, 'condition_number': 7977.71435546875}
Step 3700: {'loss': 207.72286987304688, 'l1_loss': 479.326171875, 'l2_loss': 187.84567260742188, 'ortho_loss': 0.7041419744491577, 'condition_number': 11495.966796875}
Step 3800: {'loss': 205.50299072265625, 'l1_loss': 487.67218017578125, 'l2_loss': 185.3455352783203, 'ortho_loss': 0.6505690813064575, 'condition_number': 21302.208984375}
Step 3900: {'loss': 205.7710723876953, 'l1_loss': 481.02691650390625, 'l2_loss': 185.91334533691406, 'ortho_loss': 0.6166497468948364, 'condition_number': 192251.640625}
Step 4000: {'loss': 205.42312622070312, 'l1_loss': 467.4625244140625, 'l2_loss': 186.09613037109375, 'ortho_loss': 0.6284871101379395, 'condition_number': 298232.53125}
Step 4100: {'loss': 204.90333557128906, 'l1_loss': 469.1121826171875, 'l2_loss': 185.53904724121094, 'ortho_loss': 0.5998117327690125, 'condition_number': 51010.49609375}
Step 4200: {'loss': 204.64163208007812, 'l1_loss': 491.860107421875, 'l2_loss': 184.39700317382812, 'ortho_loss': 0.5702256560325623, 'condition_number': 43533.84765625}
Step 4300: {'loss': 204.58815002441406, 'l1_loss': 488.25042724609375, 'l2_loss': 184.50277709960938, 'ortho_loss': 0.5553650856018066, 'condition_number': 10255.4375}
Step 4400: {'loss': 202.76132202148438, 'l1_loss': 478.966796875, 'l2_loss': 183.05722045898438, 'ortho_loss': 0.5454224348068237, 'condition_number': 7816.06396484375}
Step 4500: {'loss': 203.36155700683594, 'l1_loss': 488.031494140625, 'l2_loss': 183.32569885253906, 'ortho_loss': 0.5146031379699707, 'condition_number': 5968.57080078125}
Step 4600: {'loss': 202.213134765625, 'l1_loss': 487.18701171875, 'l2_loss': 182.25067138671875, 'ortho_loss': 0.47497719526290894, 'condition_number': 4767.53271484375}
Step 4700: {'loss': 201.55581665039062, 'l1_loss': 505.5746765136719, 'l2_loss': 180.86520385742188, 'ortho_loss': 0.46762803196907043, 'condition_number': 4569.1298828125}
Step 4800: {'loss': 201.35336303710938, 'l1_loss': 495.3927001953125, 'l2_loss': 181.08721923828125, 'ortho_loss': 0.45044565200805664, 'condition_number': 4169.5859375}

 training complete! 

all info: /gpfs/radev/project/lafferty/tl784/free_PhD_labor/results/sae_variants/20250127_135437_Orthogonal_sae/run_1/final_info.json

Running absorption evaluation...
Loaded pretrained model google/gemma-2-2b into HookedTransformer
[PosixPath('/gpfs/radev/project/lafferty/tl784/free_PhD_labor/artifacts/absorption/k_sparse_probing/google/gemma-2-2b_layer_19_sae_custom_sae/layer_19_google/gemma-2-2b_layer_19_sae_custom_sae_metrics.parquet')] exist(s), loading from disk
[PosixPath('/gpfs/radev/project/lafferty/tl784/free_PhD_labor/artifacts/absorption/feature_absorption/google/gemma-2-2b_layer_19_sae_custom_sae/layer_19_google/gemma-2-2b_layer_19_sae_custom_sae.parquet')] exist(s), loading from disk

Running core evaluation...
Using device: cuda
Loaded pretrained model google/gemma-2-2b into HookedTransformer
Saved evaluation results to: run_1/google_gemma-2-2b_layer_19_sae_custom_sae_eval_results.json

Running scr_and_tpp evaluation...
Loaded pretrained model google/gemma-2-2b into HookedTransformer
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male / female: 0.9920000433921814
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_data_only: 0.9930000305175781
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for professor / nurse: 0.9650000333786011
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for nurse_data_only: 0.9630000591278076
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male_professor / female_nurse: 0.9960000514984131
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_nurse_data_only: 0.9960000514984131
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.8850000500679016, scr_score: -0.19403010302711657
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.8850000500679016, scr_score: -0.19403010302711657
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.8840000629425049, scr_score: -0.20895529027029383
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.8180000185966492, scr_score: -1.194030992649054
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.8040000200271606, scr_score: -1.4029862829193478
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.8140000104904175, scr_score: -1.2537326312437003
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.7880000472068787, scr_score: -1.6417919476759961
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6360000371932983, scr_score: 0.1010101481416146
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6520000100135803, scr_score: 0.14141411708819893
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6740000247955322, scr_score: 0.1969697060919254
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6890000104904175, scr_score: 0.23484845520124242
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6930000185966492, scr_score: 0.2449494850670808
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6910000443458557, scr_score: 0.23989904539254622
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.703000009059906, scr_score: 0.27020198447329213
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male / female: 0.9900000691413879
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_data_only: 0.987000048160553
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for professor / nurse: 0.9550000429153442
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for nurse_data_only: 0.9540000557899475
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male_professor / female_nurse: 0.9950000643730164
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_nurse_data_only: 0.9940000176429749
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8530000448226929, scr_score: 0.0727274106553584
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8450000286102295, scr_score: 0.0
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8450000286102295, scr_score: 0.0
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8460000157356262, scr_score: 0.009090790866835655
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8400000333786011, scr_score: -0.04545449619451486
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8210000395774841, scr_score: -0.21818169010573862
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.7930000424385071, scr_score: -0.47272708553915643
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6600000262260437, scr_score: 0.03225799685406354
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6670000553131104, scr_score: 0.052785940156590654
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6680000424385071, scr_score: 0.055718453544474765
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6550000309944153, scr_score: 0.017595255120973825
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6620000600814819, scr_score: 0.03812319842350094
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6760000586509705, scr_score: 0.07917891023488599
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6860000491142273, scr_score: 0.10850439370106542
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male / female: 0.987000048160553
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_data_only: 0.9880000352859497
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for professor / nurse: 0.971000075340271
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for nurse_data_only: 0.968000054359436
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male_professor / female_nurse: 0.9980000257492065
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_nurse_data_only: 0.9970000386238098
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.9170000553131104, scr_score: 0.01818158173367131
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.8980000615119934, scr_score: -0.32727280608877624
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.8970000147819519, scr_score: -0.34545547154312073
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.8910000324249268, scr_score: -0.45454604566582174
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.8920000195503235, scr_score: -0.4363644639321504
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.8840000629425049, scr_score: -0.5818182015221941
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.8610000610351562, scr_score: -1.0
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.5900000333786011, scr_score: 0.024570000821577526
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.5980000495910645, scr_score: 0.04422606005834226
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.6240000128746033, scr_score: 0.10810803290469247
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.6070000529289246, scr_score: 0.06633909008751339
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.6230000257492065, scr_score: 0.10565106211228607
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.6230000257492065, scr_score: 0.10565106211228607
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.6290000081062317, scr_score: 0.12039303331548123
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male / female: 0.9950000643730164
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_data_only: 0.9930000305175781
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for professor / nurse: 0.9690000414848328
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for nurse_data_only: 0.9640000462532043
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male_professor / female_nurse: 0.9980000257492065
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_nurse_data_only: 0.9980000257492065
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8370000123977661, scr_score: -0.023255975134237508
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8420000672340393, scr_score: 0.015504137439985289
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8380000591278076, scr_score: -0.015503675388504437
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8240000605583191, scr_score: -0.12403078926247804
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8270000219345093, scr_score: -0.10077527617972139
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8130000233650208, scr_score: -0.209302390053695
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.7910000085830688, scr_score: -0.37984512958464806
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.6690000295639038, scr_score: 0.02686567854631583
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.6810000538825989, scr_score: 0.06268664258283443
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.6920000314712524, scr_score: 0.09552239283975711
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.7090000510215759, scr_score: 0.14626871407708533
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.718000054359436, scr_score: 0.17313439262340116
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.7280000448226929, scr_score: 0.20298510702502043
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.706000030040741, scr_score: 0.13731342858688256
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male / female: 0.9460000395774841
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_data_only: 0.9310000538825989
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for professor / nurse: 0.9900000691413879
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for nurse_data_only: 0.9930000305175781
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male_professor / female_nurse: 0.9980000257492065
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_nurse_data_only: 0.9980000257492065
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8380000591278076, scr_score: 0.08433733641936964
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8360000252723694, scr_score: 0.07228894032282736
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8390000462532043, scr_score: 0.09036135493558749
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8330000638961792, scr_score: 0.05421688477417381
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.815000057220459, scr_score: -0.05421688477417381
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.812000036239624, scr_score: -0.07228929938693394
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.843000054359436, scr_score: 0.11445778806456547
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.6850000619888306, scr_score: 0.047445299140279104
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.690000057220459, scr_score: 0.06569345765035435
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.6890000104904175, scr_score: 0.06204365192017241
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.6840000152587891, scr_score: 0.043795493410097155
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.675000011920929, scr_score: 0.01094876458491998
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.6700000166893005, scr_score: -0.007299393925155271
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.6540000438690186, scr_score: -0.06569345765035435
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male / female: 0.9550000429153442
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_data_only: 0.9530000686645508
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for professor / nurse: 0.9790000319480896
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for nurse_data_only: 0.9790000319480896
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male_professor / female_nurse: 0.9970000386238098
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_nurse_data_only: 0.9960000514984131
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8350000381469727, scr_score: 0.15294129609235493
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8410000205039978, scr_score: 0.18823530649231257
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8390000462532043, scr_score: 0.1764707532308344
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8420000672340393, scr_score: 0.19411793373857475
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8190000653266907, scr_score: 0.058823818153960185
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8200000524520874, scr_score: 0.06470609478469928
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8030000329017639, scr_score: -0.035294010399957644
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.7100000381469727, scr_score: 0.07894746276950931
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.718000054359436, scr_score: 0.10902270802242568
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.7210000157356262, scr_score: 0.12030075693408086
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.718000054359436, scr_score: 0.10902270802242568
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.7140000462532043, scr_score: 0.0939850853959675
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.6910000443458557, scr_score: 0.007518923352021404
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.6910000443458557, scr_score: 0.007518923352021404
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male / female: 0.9580000638961792
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_data_only: 0.9590000510215759
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for professor / nurse: 0.9810000658035278
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for nurse_data_only: 0.9820000529289246
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male_professor / female_nurse: 0.999000072479248
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_nurse_data_only: 0.999000072479248
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8860000371932983, scr_score: 0.15178582357352044
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8880000710487366, scr_score: 0.16964326103257552
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8860000371932983, scr_score: 0.15178582357352044
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8810000419616699, scr_score: 0.10714302820203199
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8740000128746033, scr_score: 0.04464279537148845
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8740000128746033, scr_score: 0.04464279537148845
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8020000457763672, scr_score: -0.598213777288405
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.6370000243186951, scr_score: 0.024316154577101495
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.6480000019073486, scr_score: 0.057750731243789294
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.6650000214576721, scr_score: 0.10942251442785439
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.7120000123977661, scr_score: 0.2522796055223966
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.7240000367164612, scr_score: 0.28875383738804883
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.7110000252723694, scr_score: 0.24924013149253446
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.6880000233650208, scr_score: 0.17933132296019444
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male / female: 0.9610000252723694
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_data_only: 0.9600000381469727
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for professor / nurse: 0.9610000252723694
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for nurse_data_only: 0.9590000510215759
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for male_professor / female_nurse: 0.9970000386238098
Num non-zero elements: 2304
Training probe with dim: 2304, device: cuda:0, dtype: torch.bfloat16
Test accuracy for female_nurse_data_only: 0.9980000257492065
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.76500004529953, scr_score: 0.057692423418779074
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7630000114440918, scr_score: 0.04807687623525609
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7640000581741333, scr_score: 0.05288479310741072
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7680000066757202, scr_score: 0.07211531435288414
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7700000405311584, scr_score: 0.08173086153640712
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7710000276565552, scr_score: 0.08653849184777547
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7610000371932983, scr_score: 0.03846161561251938
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7410000562667847, scr_score: -0.009174194031715687
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7440000176429749, scr_score: 0.004587097015857844
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7480000257492065, scr_score: 0.02293575849509752
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7590000629425049, scr_score: 0.0733946459169587
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7470000386238098, scr_score: 0.018348661479239674
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7440000176429749, scr_score: 0.004587097015857844
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7330000400543213, scr_score: -0.04587151699019504
coder_out: I'll fix the undefined name error by updating the trainer initialization to use OrthogonalTrainer instead of CustomTrainer:

experiment.py
```python
<<<<<<< SEARCH
    trainer = CustomTrainer(
=======
    trainer = OrthogonalTrainer(
>>>>>>> REPLACE
```

This matches the new OrthogonalTrainer class we defined earlier in the file. Now you can run:

```bash
python experiment.py --out_dir=run_1
```, type: <class 'str'>
Currently on iteration 1 of run 2
Let me analyze Run 1 and update the notes before proceeding with Run 2.                                                                                                              

The results from Run 1 show:                                                                                                                                                         

 1 The orthogonality implementation is working (architecture shows as 'Orthogonal' in cfg)                                                                                           
 2 Core metrics show slightly lower reconstruction quality (explained_variance: 0.29296875 vs baseline 0.30859375)                                                                   
 3 Improved sparsity (L0: 61.99 vs baseline 85.21)                                                                                                                                   
 4 Similar absorption scores but with more consistent feature grouping                                                                                                               
 5 SCR metrics show improved separation between feature groups                                                                                                                       

I'll update the notes and then implement the next change:                                                                                                                            

notes.txt                                                                                                                                                                            

                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                      
 # Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders                                                                                        
 # Experiment description: 1. Implement adaptive orthogonality loss with controlled feature sharing                                                                                  
 2. Add batch-wise feature grouping with periodic updates                                                                                                                            
 3. Train on Pythia-70M using WMDP-bio and WikiText datasets                                                                                                                         
 4. Compare unlearning performance against baseline and fixed orthogonal SAE                                                                                                         
 5. Analyze condition numbers of feature subspaces                                                                                                                                   
 6. Evaluate impact of different α values for controlled sharing                                                                                                                     
 ## Run 0: Baseline                                                                                                                                                                  
 Results: {'training results': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000,      
 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info':       
 {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'core evaluation results':          
 {'unique_id': 'google/gemma-2-2b_layer_19_sae_custom_sae', 'sae_set': 'google/gemma-2-2b_layer_19_sae', 'sae_id': 'custom_sae', 'eval_cfg': {'model_name': 'google/gemma-2-2b',     
 'llm_dtype': 'bfloat16', 'batch_size_prompts': 16, 'n_eval_reconstruction_batches': 200, 'n_eval_sparsity_variance_batches': 2000, 'dataset': 'Skylion007/openwebtext',             
 'context_size': 128, 'compute_kl': True, 'compute_ce_loss': True, 'compute_l2_norms': True, 'compute_sparsity_metrics': True, 'compute_variance_metrics': True,                     
 'compute_featurewise_density_statistics': False, 'compute_featurewise_weight_based_metrics': False, 'exclude_special_tokens_from_reconstruction': True, 'verbose': False}, 'metrics 
 {'model_behavior_preservation': {'kl_div_score': 0.7950310559006211, 'kl_div_with_ablation': 10.0625, 'kl_div_with_sae': 2.0625}, 'model_performance_preservation': {'ce_loss_score 
 0.7894736842105263, 'ce_loss_with_ablation': 12.4375, 'ce_loss_with_sae': 4.9375, 'ce_loss_without_sae': 2.9375}, 'reconstruction_quality': {'explained_variance': 0.30859375, 'mse 
 18.75, 'cossim': 0.76953125}, 'shrinkage': {'l2_norm_in': 308.0, 'l2_norm_out': 221.0, 'l2_ratio': 0.71484375, 'relative_reconstruction_bias': 0.93359375}, 'sparsity': {'l0':      
 85.21243286132812, 'l1': 458.0}, 'token_stats': {'total_tokens_eval_reconstruction': 409600, 'total_tokens_eval_sparsity_variance': 4096000}}}, 'scr and tpp evaluations results':  
 {'eval_type_id': 'scr', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'canrager/amazon_reviews_mcauley_1and5'], 'perform_scr': True,        
 'early_stopping_patience': 20, 'train_set_size': 4000, 'test_set_size': 1000, 'context_length': 128, 'probe_train_batch_size': 16, 'probe_test_batch_size': 500, 'probe_epochs': 20 
 'probe_lr': 0.001, 'probe_l1_penalty': 0.001, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'lower_vram_usage': False, 'model_name': 'google/gemma-2-2b',   
 'n_values': [2, 5, 10, 20, 50, 100, 500], 'column1_vals_lookup': {'LabHC/bias_in_bios_class_set1': [['professor', 'nurse'], ['architect', 'journalist'], ['surgeon', 'psychologist' 
 ['attorney', 'teacher']], 'canrager/amazon_reviews_mcauley_1and5': [['Books', 'CDs_and_Vinyl'], ['Software', 'Electronics'], ['Pet_Supplies', 'Office_Products'],                   
 ['Industrial_and_Scientific', 'Toys_and_Games']]}}, 'eval_id': 'c28f32b2-a72e-4f76-8d5a-85d6f9937f1b', 'datetime_epoch_millis': 1737884773606, 'eval_result_metrics': {'scr_metrics 
 {'scr_dir1_threshold_2': 0.035600906531669814, 'scr_metric_threshold_2': 0.019679524675140548, 'scr_dir2_threshold_2': 0.011514810160172787, 'scr_dir1_threshold_5':                
 0.051710736232558285, 'scr_metric_threshold_5': 0.06512155475350995, 'scr_dir2_threshold_5': 0.05295877346813508, 'scr_dir1_threshold_10': 0.077764577667114,                       
 'scr_metric_threshold_10': 0.08335696172542797, 'scr_dir2_threshold_10': 0.07006244094994978, 'scr_dir1_threshold_20': 0.07343213933631738, 'scr_metric_threshold_20':              
 0.08504280928786076, 'scr_dir2_threshold_20': 0.07359277159847097, 'scr_dir1_threshold_50': 0.03350340830709253, 'scr_metric_threshold_50': 0.08899691187101458,                    
 'scr_dir2_threshold_50': 0.07593742114240237, 'scr_dir1_threshold_100': -0.16207016165821828, 'scr_metric_threshold_100': 0.062236305245427885, 'scr_dir2_threshold_100':           
 0.052638407599727086, 'scr_dir1_threshold_500': -0.25156349364441777, 'scr_metric_threshold_500': 0.027887084742431078, 'scr_dir2_threshold_500': 0.004238511981040263}},           
 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_professor_nurse_results', 'scr_dir1_threshold_2': 0.03124962164991371, 'scr_metric_threshold_2':        
 0.012284998611665989, 'scr_dir2_threshold_2': 0.012284998611665989, 'scr_dir1_threshold_5': -0.015625742148246177, 'scr_metric_threshold_5': 0.05896816907447914,                   
 'scr_dir2_threshold_5': 0.05896816907447914, 'scr_dir1_threshold_10': -0.015625742148246177, 'scr_metric_threshold_10': 0.14987724667004865, 'scr_dir2_threshold_10':               
 0.14987724667004865, 'scr_dir1_threshold_20': -0.03125055297320303, 'scr_metric_threshold_20': 0.15479118753522092, 'scr_dir2_threshold_20': 0.15479118753522092,                   
 'scr_dir1_threshold_50': -0.2968760622906269, 'scr_metric_threshold_50': 0.16216224528171463, 'scr_dir2_threshold_50': 0.16216224528171463, 'scr_dir1_threshold_100':               
 -1.312501804438873, 'scr_metric_threshold_100': 0.14987724667004865, 'scr_dir2_threshold_100': 0.14987724667004865, 'scr_dir1_threshold_500': -1.3750019790619898,                  
 'scr_metric_threshold_500': 0.15724815796780706, 'scr_dir2_threshold_500': 0.15724815796780706}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_architect_journalist_results', 
 'scr_dir1_threshold_2': -0.08737868572318094, 'scr_metric_threshold_2': 0.034383855303823166, 'scr_dir2_threshold_2': 0.034383855303823166, 'scr_dir1_threshold_5':                 
 -0.10679649293164041, 'scr_metric_threshold_5': 0.06590258858377988, 'scr_dir2_threshold_5': 0.06590258858377988, 'scr_dir1_threshold_10': -0.11650510719289281,                    
 'scr_metric_threshold_10': 0.037249318901607584, 'scr_dir2_threshold_10': 0.037249318901607584, 'scr_dir1_threshold_20': -0.10679649293164041, 'scr_metric_threshold_20':           
 0.04011461171243302, 'scr_dir2_threshold_20': 0.04011461171243302, 'scr_dir1_threshold_50': -0.14563152866260468, 'scr_metric_threshold_50': 0.07449846701625619,                   
 'scr_dir2_threshold_50': 0.07449846701625619, 'scr_dir1_threshold_100': -0.14563152866260468, 'scr_metric_threshold_100': 0.10888249310703833, 'scr_dir2_threshold_100':            
 0.10888249310703833, 'scr_dir1_threshold_500': -0.3106797071617595, 'scr_metric_threshold_500': 0.0859598090465169, 'scr_dir2_threshold_500': 0.0859598090465169}, {'dataset_name': 
 'LabHC/bias_in_bios_class_set1_scr_surgeon_psychologist_results', 'scr_dir1_threshold_2': 0.015873751732555005, 'scr_metric_threshold_2': -0.0025316127159178037,                   
 'scr_dir2_threshold_2': -0.0025316127159178037, 'scr_dir1_threshold_5': 0.03174655735998827, 'scr_metric_threshold_5': -0.005063225431835607, 'scr_dir2_threshold_5':               
 -0.005063225431835607, 'scr_dir1_threshold_10': 0.0, 'scr_metric_threshold_10': 0.0075949890455728015, 'scr_dir2_threshold_10': 0.0075949890455728015, 'scr_dir1_threshold_20':     
 -0.0634921686148548, 'scr_metric_threshold_20': 0.02784819256855401, 'scr_dir2_threshold_20': 0.02784819256855401, 'scr_dir1_threshold_50': -0.1111105854971546,                    
 'scr_metric_threshold_50': 0.05316462152337083, 'scr_dir2_threshold_50': 0.05316462152337083, 'scr_dir1_threshold_100': -0.2222221170994309, 'scr_metric_threshold_100':            
 0.05316462152337083, 'scr_dir2_threshold_100': 0.05316462152337083, 'scr_dir1_threshold_500': -0.5714285714285714, 'scr_metric_threshold_500': 0.055696234239288635,                
 'scr_dir2_threshold_500': 0.055696234239288635}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_attorney_teacher_results', 'scr_dir1_threshold_2': 0.0,                        
 'scr_metric_threshold_2': 0.020771598900727672, 'scr_dir2_threshold_2': 0.020771598900727672, 'scr_dir1_threshold_5': 0.0, 'scr_metric_threshold_5': 0.1246292396676148,            
 'scr_dir2_threshold_5': 0.1246292396676148, 'scr_dir1_threshold_10': -0.007812398136610098, 'scr_metric_threshold_10': 0.10089032002917621, 'scr_dir2_threshold_10':                
 0.10089032002917621, 'scr_dir1_threshold_20': 0.10156257275956422, 'scr_metric_threshold_20': 0.0890208602099569, 'scr_dir2_threshold_20': 0.0890208602099569,                      
 'scr_dir1_threshold_50': 0.10156257275956422, 'scr_metric_threshold_50': 0.11869442132381734, 'scr_dir2_threshold_50': 0.11869442132381734, 'scr_dir1_threshold_100':               
 -0.17187462165026607, 'scr_metric_threshold_100': 0.10979228224230897, 'scr_dir2_threshold_100': 0.10979228224230897, 'scr_dir1_threshold_500': -0.16406222351365599,               
 'scr_metric_threshold_500': 0.06824926130922924, 'scr_dir2_threshold_500': 0.06824926130922924}, {'dataset_name':                                                                   
 'canrager/amazon_reviews_mcauley_1and5_scr_Books_CDs_and_Vinyl_results', 'scr_dir1_threshold_2': -0.06010915791026799, 'scr_metric_threshold_2': -0.015686069182044467,             
 'scr_dir2_threshold_2': -0.015686069182044467, 'scr_dir1_threshold_5': -0.01092881936245188, 'scr_metric_threshold_5': 0.07450976358933016, 'scr_dir2_threshold_5':                 
 0.07450976358933016, 'scr_dir1_threshold_10': 0.27322406685360157, 'scr_metric_threshold_10': 0.10588236944072857, 'scr_dir2_threshold_10': 0.10588236944072857,                    
 'scr_dir1_threshold_20': 0.24043695734946327, 'scr_metric_threshold_20': 0.08235303192400713, 'scr_dir2_threshold_20': 0.08235303192400713, 'scr_dir1_threshold_50':                
 0.3005464409681226, 'scr_metric_threshold_50': 0.039215874186075375, 'scr_dir2_threshold_50': 0.039215874186075375, 'scr_dir1_threshold_100': 0.2568305121015324,                   
 'scr_metric_threshold_100': 0.06274521170279682, 'scr_dir2_threshold_100': 0.06274521170279682, 'scr_dir1_threshold_500': 0.21311458323494226, 'scr_metric_threshold_500':          
 -0.14901952717866032, 'scr_dir2_threshold_500': -0.14901952717866032}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Software_Electronics_results',                   
 'scr_dir1_threshold_2': 0.158974152062764, 'scr_metric_threshold_2': 0.05241939554166917, 'scr_dir2_threshold_2': 0.05241939554166917, 'scr_dir1_threshold_5': 0.17948701489841076, 
 'scr_metric_threshold_5': 0.07258066454365199, 'scr_dir2_threshold_5': 0.07258066454365199, 'scr_dir1_threshold_10': 0.18461515419110838, 'scr_metric_threshold_10':                
 0.10483879108333834, 'scr_dir2_threshold_10': 0.10483879108333834, 'scr_dir1_threshold_20': 0.17435887560571312, 'scr_metric_threshold_20': 0.11693564862104187,                    
 'scr_dir2_threshold_20': 0.11693564862104187, 'scr_dir1_threshold_50': 0.2102561563194528, 'scr_metric_threshold_50': 0.10887099681547797, 'scr_dir2_threshold_50':                 
 0.10887099681547797, 'scr_dir1_threshold_100': 0.19487173844135988, 'scr_metric_threshold_100': -0.07258066454365199, 'scr_dir2_threshold_100': -0.07258066454365199,               
 'scr_dir1_threshold_500': 0.16410229135546164, 'scr_metric_threshold_500': -0.12499981974403652, 'scr_dir2_threshold_500': -0.12499981974403652}, {'dataset_name':                  
 'canrager/amazon_reviews_mcauley_1and5_scr_Pet_Supplies_Office_Products_results', 'scr_dir1_threshold_2': 0.17040353950037407, 'scr_metric_threshold_2': 0.0, 'scr_dir2_threshold_2 
 0.0, 'scr_dir1_threshold_5': 0.22421531016200436, 'scr_metric_threshold_5': 0.017857176118657926, 'scr_dir2_threshold_5': 0.017857176118657926, 'scr_dir1_threshold_10':            
 0.18834079638758416, 'scr_metric_threshold_10': 0.04464280725058454, 'scr_dir2_threshold_10': 0.04464280725058454, 'scr_dir1_threshold_20': 0.15246628261316397,                    
 'scr_metric_threshold_20': 0.04910730084933944, 'scr_dir2_threshold_20': 0.04910730084933944, 'scr_dir1_threshold_50': 0.0762330076638747, 'scr_metric_threshold_50':               
 0.02232140362529227, 'scr_dir2_threshold_50': 0.02232140362529227, 'scr_dir1_threshold_100': 0.02242150428765898, 'scr_metric_threshold_100': 0.0044642275066343415,                
 'scr_dir2_threshold_100': 0.0044642275066343415, 'scr_dir1_threshold_500': -0.06726478014839152, 'scr_metric_threshold_500': 0.03125012473068151, 'scr_dir2_threshold_500':         
 0.03125012473068151}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Industrial_and_Scientific_Toys_and_Games_results', 'scr_dir1_threshold_2': 0.05579403094120067,   
 'scr_metric_threshold_2': 0.05579403094120067, 'scr_dir2_threshold_2': -0.009523685178541423, 'scr_dir1_threshold_5': 0.11158806188240133, 'scr_metric_threshold_5':                
 0.11158806188240133, 'scr_dir2_threshold_5': 0.014285811599402364, 'scr_dir1_threshold_10': 0.11587985138236706, 'scr_metric_threshold_10': 0.11587985138236706,                    
 'scr_dir2_threshold_10': 0.009523685178541423, 'scr_dir1_threshold_20': 0.12017164088233277, 'scr_metric_threshold_20': 0.12017164088233277, 'scr_dir2_threshold_20':               
 0.0285713393672145, 'scr_dir1_threshold_50': 0.13304726519611204, 'scr_metric_threshold_50': 0.13304726519611204, 'scr_dir2_threshold_50': 0.0285713393672145,                      
 'scr_dir1_threshold_100': 0.08154502375487709, 'scr_metric_threshold_100': 0.08154502375487709, 'scr_dir2_threshold_100': 0.004761842589270712, 'scr_dir1_threshold_500':           
 0.09871243756862208, 'scr_metric_threshold_500': 0.09871243756862208, 'scr_dir2_threshold_500': -0.09047614452250444}], 'sae_bench_commit_hash':                                    
 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict':      
 {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None,         
 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none',       
 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None,    
 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'absorption evaluation results': {'eval_type_id': 'absorption_first_letter', 'eval_config': {'model_name':              
 'google/gemma-2-2b', 'random_seed': 42, 'f1_jump_threshold': 0.03, 'max_k_value': 10, 'prompt_template': '{word} has the first letter:', 'prompt_token_pos': -6, 'llm_batch_size':  
 32, 'llm_dtype': 'bfloat16', 'k_sparse_probe_l1_decay': 0.01, 'k_sparse_probe_batch_size': 4096, 'k_sparse_probe_num_epochs': 50}, 'eval_id': '515e7b3b-6b86-4214-aa0d-c2ef123e2969 
 'datetime_epoch_millis': 1737999200566, 'eval_result_metrics': {'mean': {'mean_absorption_score': 0.010124895517470242, 'mean_num_split_features': 1.2}}, 'eval_result_details':    
 [{'first_letter': 'a', 'absorption_rate': 0.00986971969996052, 'num_absorption': 25, 'num_probe_true_positives': 2533, 'num_split_features': 1}, {'first_letter': 'b',              
 'absorption_rate': 0.005050505050505051, 'num_absorption': 8, 'num_probe_true_positives': 1584, 'num_split_features': 1}, {'first_letter': 'c', 'absorption_rate':                  
 0.02792890823358723, 'num_absorption': 77, 'num_probe_true_positives': 2757, 'num_split_features': 1}, {'first_letter': 'd', 'absorption_rate': 0.008631319358816275,               
 'num_absorption': 14, 'num_probe_true_positives': 1622, 'num_split_features': 1}, {'first_letter': 'e', 'absorption_rate': 0.002523659305993691, 'num_absorption': 4,               
 'num_probe_true_positives': 1585, 'num_split_features': 1}, {'first_letter': 'f', 'absorption_rate': 0.004942339373970346, 'num_absorption': 6, 'num_probe_true_positives': 1214,   
 'num_split_features': 1}, {'first_letter': 'g', 'absorption_rate': 0.0026362038664323375, 'num_absorption': 3, 'num_probe_true_positives': 1138, 'num_split_features': 1},          
 {'first_letter': 'h', 'absorption_rate': 0.08004158004158005, 'num_absorption': 77, 'num_probe_true_positives': 962, 'num_split_features': 1}, {'first_letter': 'i',                
 'absorption_rate': 0.007402837754472548, 'num_absorption': 12, 'num_probe_true_positives': 1621, 'num_split_features': 2}, {'first_letter': 'j', 'absorption_rate':                 
 0.03546099290780142, 'num_absorption': 15, 'num_probe_true_positives': 423, 'num_split_features': 1}, {'first_letter': 'k', 'absorption_rate': 0.001557632398753894,                
 'num_absorption': 1, 'num_probe_true_positives': 642, 'num_split_features': 1}, {'first_letter': 'l', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 1196 
 'num_split_features': 1}, {'first_letter': 'm', 'absorption_rate': 0.0060406370126304225, 'num_absorption': 11, 'num_probe_true_positives': 1821, 'num_split_features': 1},         
 {'first_letter': 'n', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 845, 'num_split_features': 1}, {'first_letter': 'o', 'absorption_rate':              
 0.007070707070707071, 'num_absorption': 7, 'num_probe_true_positives': 990, 'num_split_features': 1}, {'first_letter': 'p', 'absorption_rate': 0.0004332755632582322,               
 'num_absorption': 1, 'num_probe_true_positives': 2308, 'num_split_features': 2}, {'first_letter': 'q', 'absorption_rate': 0.011428571428571429, 'num_absorption': 2,                
 'num_probe_true_positives': 175, 'num_split_features': 1}, {'first_letter': 'r', 'absorption_rate': 0.006053268765133172, 'num_absorption': 10, 'num_probe_true_positives': 1652,   
 'num_split_features': 2}, {'first_letter': 's', 'absorption_rate': 0.005263157894736842, 'num_absorption': 15, 'num_probe_true_positives': 2850, 'num_split_features': 1},          
 {'first_letter': 't', 'absorption_rate': 0.00357355568790947, 'num_absorption': 6, 'num_probe_true_positives': 1679, 'num_split_features': 2}, {'first_letter': 'u',                
 'absorption_rate': 0.0013297872340425532, 'num_absorption': 1, 'num_probe_true_positives': 752, 'num_split_features': 2}, {'first_letter': 'v', 'absorption_rate':                  
 0.0012738853503184713, 'num_absorption': 1, 'num_probe_true_positives': 785, 'num_split_features': 1}, {'first_letter': 'w', 'absorption_rate': 0.004201680672268907,               
 'num_absorption': 3, 'num_probe_true_positives': 714, 'num_split_features': 1}, {'first_letter': 'y', 'absorption_rate': 0.02040816326530612, 'num_absorption': 3,                  
 'num_probe_true_positives': 147, 'num_split_features': 1}, {'first_letter': 'z', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 230, 'num_split_features' 
 1}], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': 
 '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', '                                                                                                                      
                                                                                                                                                                                     
Let me analyze Run 1 and update the notes before proceeding with Run 2.                                                                                                              

The results from Run 1 show:                                                                                                                                                         

 1 The orthogonality implementation is working (architecture shows as 'Orthogonal' in cfg)                                                                                           
 2 Core metrics show slightly lower reconstruction quality (explained_variance: 0.29296875 vs baseline 0.30859375)                                                                   
 3 Improved sparsity (L0: 61.99 vs baseline 85.21)                                                                                                                                   
 4 Similar absorption scores but with more consistent feature grouping                                                                                                               
 5 SCR metrics show improved separation between feature groups                                                                                                                       

I'll update the notes and then implement the next change:                                                                                                                            

notes.txt                                                                                                                                                                            

                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                      
 # Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders                                                                                        
 # Experiment description: 1. Implement adaptive orthogonality loss with controlled feature sharing                                                                                  
 2. Add batch-wise feature grouping with periodic updates                                                                                                                            
 3. Train on Pythia-70M using WMDP-bio and WikiText datasets                                                                                                                         
 4. Compare unlearning performance against baseline and fixed orthogonal SAE                                                                                                         
 5. Analyze condition numbers of feature subspaces                                                                                                                                   
 6. Evaluate impact of different α values for controlled sharing                                                                                                                     
 ## Run 0: Baseline                                                                                                                                                                  
 Results: {'training results': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000,      
 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info':       
 {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'core evaluation results':          
 {'unique_id': 'google/gemma-2-2b_layer_19_sae_custom_sae', 'sae_set': 'google/gemma-2-2b_layer_19_sae', 'sae_id': 'custom_sae', 'eval_cfg': {'model_name': 'google/gemma-2-2b',     
 'llm_dtype': 'bfloat16', 'batch_size_prompts': 16, 'n_eval_reconstruction_batches': 200, 'n_eval_sparsity_variance_batches': 2000, 'dataset': 'Skylion007/openwebtext',             
 'context_size': 128, 'compute_kl': True, 'compute_ce_loss': True, 'compute_l2_norms': True, 'compute_sparsity_metrics': True, 'compute_variance_metrics': True,                     
 'compute_featurewise_density_statistics': False, 'compute_featurewise_weight_based_metrics': False, 'exclude_special_tokens_from_reconstruction': True, 'verbose': False}, 'metrics 
 {'model_behavior_preservation': {'kl_div_score': 0.7950310559006211, 'kl_div_with_ablation': 10.0625, 'kl_div_with_sae': 2.0625}, 'model_performance_preservation': {'ce_loss_score 
 0.7894736842105263, 'ce_loss_with_ablation': 12.4375, 'ce_loss_with_sae': 4.9375, 'ce_loss_without_sae': 2.9375}, 'reconstruction_quality': {'explained_variance': 0.30859375, 'mse 
 18.75, 'cossim': 0.76953125}, 'shrinkage': {'l2_norm_in': 308.0, 'l2_norm_out': 221.0, 'l2_ratio': 0.71484375, 'relative_reconstruction_bias': 0.93359375}, 'sparsity': {'l0':      
 85.21243286132812, 'l1': 458.0}, 'token_stats': {'total_tokens_eval_reconstruction': 409600, 'total_tokens_eval_sparsity_variance': 4096000}}}, 'scr and tpp evaluations results':  
 {'eval_type_id': 'scr', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'canrager/amazon_reviews_mcauley_1and5'], 'perform_scr': True,        
 'early_stopping_patience': 20, 'train_set_size': 4000, 'test_set_size': 1000, 'context_length': 128, 'probe_train_batch_size': 16, 'probe_test_batch_size': 500, 'probe_epochs': 20 
 'probe_lr': 0.001, 'probe_l1_penalty': 0.001, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'lower_vram_usage': False, 'model_name': 'google/gemma-2-2b',   
 'n_values': [2, 5, 10, 20, 50, 100, 500], 'column1_vals_lookup': {'LabHC/bias_in_bios_class_set1': [['professor', 'nurse'], ['architect', 'journalist'], ['surgeon', 'psychologist' 
 ['attorney', 'teacher']], 'canrager/amazon_reviews_mcauley_1and5': [['Books', 'CDs_and_Vinyl'], ['Software', 'Electronics'], ['Pet_Supplies', 'Office_Products'],                   
 ['Industrial_and_Scientific', 'Toys_and_Games']]}}, 'eval_id': 'c28f32b2-a72e-4f76-8d5a-85d6f9937f1b', 'datetime_epoch_millis': 1737884773606, 'eval_result_metrics': {'scr_metrics 
 {'scr_dir1_threshold_2': 0.035600906531669814, 'scr_metric_threshold_2': 0.019679524675140548, 'scr_dir2_threshold_2': 0.011514810160172787, 'scr_dir1_threshold_5':                
 0.051710736232558285, 'scr_metric_threshold_5': 0.06512155475350995, 'scr_dir2_threshold_5': 0.05295877346813508, 'scr_dir1_threshold_10': 0.077764577667114,                       
 'scr_metric_threshold_10': 0.08335696172542797, 'scr_dir2_threshold_10': 0.07006244094994978, 'scr_dir1_threshold_20': 0.07343213933631738, 'scr_metric_threshold_20':              
 0.08504280928786076, 'scr_dir2_threshold_20': 0.07359277159847097, 'scr_dir1_threshold_50': 0.03350340830709253, 'scr_metric_threshold_50': 0.08899691187101458,                    
 'scr_dir2_threshold_50': 0.07593742114240237, 'scr_dir1_threshold_100': -0.16207016165821828, 'scr_metric_threshold_100': 0.062236305245427885, 'scr_dir2_threshold_100':           
 0.052638407599727086, 'scr_dir1_threshold_500': -0.25156349364441777, 'scr_metric_threshold_500': 0.027887084742431078, 'scr_dir2_threshold_500': 0.004238511981040263}},           
 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_professor_nurse_results', 'scr_dir1_threshold_2': 0.03124962164991371, 'scr_metric_threshold_2':        
 0.012284998611665989, 'scr_dir2_threshold_2': 0.012284998611665989, 'scr_dir1_threshold_5': -0.015625742148246177, 'scr_metric_threshold_5': 0.05896816907447914,                   
 'scr_dir2_threshold_5': 0.05896816907447914, 'scr_dir1_threshold_10': -0.015625742148246177, 'scr_metric_threshold_10': 0.14987724667004865, 'scr_dir2_threshold_10':               
 0.14987724667004865, 'scr_dir1_threshold_20': -0.03125055297320303, 'scr_metric_threshold_20': 0.15479118753522092, 'scr_dir2_threshold_20': 0.15479118753522092,                   
 'scr_dir1_threshold_50': -0.2968760622906269, 'scr_metric_threshold_50': 0.16216224528171463, 'scr_dir2_threshold_50': 0.16216224528171463, 'scr_dir1_threshold_100':               
 -1.312501804438873, 'scr_metric_threshold_100': 0.14987724667004865, 'scr_dir2_threshold_100': 0.14987724667004865, 'scr_dir1_threshold_500': -1.3750019790619898,                  
 'scr_metric_threshold_500': 0.15724815796780706, 'scr_dir2_threshold_500': 0.15724815796780706}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_architect_journalist_results', 
 'scr_dir1_threshold_2': -0.08737868572318094, 'scr_metric_threshold_2': 0.034383855303823166, 'scr_dir2_threshold_2': 0.034383855303823166, 'scr_dir1_threshold_5':                 
 -0.10679649293164041, 'scr_metric_threshold_5': 0.06590258858377988, 'scr_dir2_threshold_5': 0.06590258858377988, 'scr_dir1_threshold_10': -0.11650510719289281,                    
 'scr_metric_threshold_10': 0.037249318901607584, 'scr_dir2_threshold_10': 0.037249318901607584, 'scr_dir1_threshold_20': -0.10679649293164041, 'scr_metric_threshold_20':           
 0.04011461171243302, 'scr_dir2_threshold_20': 0.04011461171243302, 'scr_dir1_threshold_50': -0.14563152866260468, 'scr_metric_threshold_50': 0.07449846701625619,                   
 'scr_dir2_threshold_50': 0.07449846701625619, 'scr_dir1_threshold_100': -0.14563152866260468, 'scr_metric_threshold_100': 0.10888249310703833, 'scr_dir2_threshold_100':            
 0.10888249310703833, 'scr_dir1_threshold_500': -0.3106797071617595, 'scr_metric_threshold_500': 0.0859598090465169, 'scr_dir2_threshold_500': 0.0859598090465169}, {'dataset_name': 
 'LabHC/bias_in_bios_class_set1_scr_surgeon_psychologist_results', 'scr_dir1_threshold_2': 0.015873751732555005, 'scr_metric_threshold_2': -0.0025316127159178037,                   
 'scr_dir2_threshold_2': -0.0025316127159178037, 'scr_dir1_threshold_5': 0.03174655735998827, 'scr_metric_threshold_5': -0.005063225431835607, 'scr_dir2_threshold_5':               
 -0.005063225431835607, 'scr_dir1_threshold_10': 0.0, 'scr_metric_threshold_10': 0.0075949890455728015, 'scr_dir2_threshold_10': 0.0075949890455728015, 'scr_dir1_threshold_20':     
 -0.0634921686148548, 'scr_metric_threshold_20': 0.02784819256855401, 'scr_dir2_threshold_20': 0.02784819256855401, 'scr_dir1_threshold_50': -0.1111105854971546,                    
 'scr_metric_threshold_50': 0.05316462152337083, 'scr_dir2_threshold_50': 0.05316462152337083, 'scr_dir1_threshold_100': -0.2222221170994309, 'scr_metric_threshold_100':            
 0.05316462152337083, 'scr_dir2_threshold_100': 0.05316462152337083, 'scr_dir1_threshold_500': -0.5714285714285714, 'scr_metric_threshold_500': 0.055696234239288635,                
 'scr_dir2_threshold_500': 0.055696234239288635}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_attorney_teacher_results', 'scr_dir1_threshold_2': 0.0,                        
 'scr_metric_threshold_2': 0.020771598900727672, 'scr_dir2_threshold_2': 0.020771598900727672, 'scr_dir1_threshold_5': 0.0, 'scr_metric_threshold_5': 0.1246292396676148,            
 'scr_dir2_threshold_5': 0.1246292396676148, 'scr_dir1_threshold_10': -0.007812398136610098, 'scr_metric_threshold_10': 0.10089032002917621, 'scr_dir2_threshold_10':                
 0.10089032002917621, 'scr_dir1_threshold_20': 0.10156257275956422, 'scr_metric_threshold_20': 0.0890208602099569, 'scr_dir2_threshold_20': 0.0890208602099569,                      
 'scr_dir1_threshold_50': 0.10156257275956422, 'scr_metric_threshold_50': 0.11869442132381734, 'scr_dir2_threshold_50': 0.11869442132381734, 'scr_dir1_threshold_100':               
 -0.17187462165026607, 'scr_metric_threshold_100': 0.10979228224230897, 'scr_dir2_threshold_100': 0.10979228224230897, 'scr_dir1_threshold_500': -0.16406222351365599,               
 'scr_metric_threshold_500': 0.06824926130922924, 'scr_dir2_threshold_500': 0.06824926130922924}, {'dataset_name':                                                                   
 'canrager/amazon_reviews_mcauley_1and5_scr_Books_CDs_and_Vinyl_results', 'scr_dir1_threshold_2': -0.06010915791026799, 'scr_metric_threshold_2': -0.015686069182044467,             
 'scr_dir2_threshold_2': -0.015686069182044467, 'scr_dir1_threshold_5': -0.01092881936245188, 'scr_metric_threshold_5': 0.07450976358933016, 'scr_dir2_threshold_5':                 
 0.07450976358933016, 'scr_dir1_threshold_10': 0.27322406685360157, 'scr_metric_threshold_10': 0.10588236944072857, 'scr_dir2_threshold_10': 0.10588236944072857,                    
 'scr_dir1_threshold_20': 0.24043695734946327, 'scr_metric_threshold_20': 0.08235303192400713, 'scr_dir2_threshold_20': 0.08235303192400713, 'scr_dir1_threshold_50':                
 0.3005464409681226, 'scr_metric_threshold_50': 0.039215874186075375, 'scr_dir2_threshold_50': 0.039215874186075375, 'scr_dir1_threshold_100': 0.2568305121015324,                   
 'scr_metric_threshold_100': 0.06274521170279682, 'scr_dir2_threshold_100': 0.06274521170279682, 'scr_dir1_threshold_500': 0.21311458323494226, 'scr_metric_threshold_500':          
 -0.14901952717866032, 'scr_dir2_threshold_500': -0.14901952717866032}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Software_Electronics_results',                   
 'scr_dir1_threshold_2': 0.158974152062764, 'scr_metric_threshold_2': 0.05241939554166917, 'scr_dir2_threshold_2': 0.05241939554166917, 'scr_dir1_threshold_5': 0.17948701489841076, 
 'scr_metric_threshold_5': 0.07258066454365199, 'scr_dir2_threshold_5': 0.07258066454365199, 'scr_dir1_threshold_10': 0.18461515419110838, 'scr_metric_threshold_10':                
 0.10483879108333834, 'scr_dir2_threshold_10': 0.10483879108333834, 'scr_dir1_threshold_20': 0.17435887560571312, 'scr_metric_threshold_20': 0.11693564862104187,                    
 'scr_dir2_threshold_20': 0.11693564862104187, 'scr_dir1_threshold_50': 0.2102561563194528, 'scr_metric_threshold_50': 0.10887099681547797, 'scr_dir2_threshold_50':                 
 0.10887099681547797, 'scr_dir1_threshold_100': 0.19487173844135988, 'scr_metric_threshold_100': -0.07258066454365199, 'scr_dir2_threshold_100': -0.07258066454365199,               
 'scr_dir1_threshold_500': 0.16410229135546164, 'scr_metric_threshold_500': -0.12499981974403652, 'scr_dir2_threshold_500': -0.12499981974403652}, {'dataset_name':                  
 'canrager/amazon_reviews_mcauley_1and5_scr_Pet_Supplies_Office_Products_results', 'scr_dir1_threshold_2': 0.17040353950037407, 'scr_metric_threshold_2': 0.0, 'scr_dir2_threshold_2 
 0.0, 'scr_dir1_threshold_5': 0.22421531016200436, 'scr_metric_threshold_5': 0.017857176118657926, 'scr_dir2_threshold_5': 0.017857176118657926, 'scr_dir1_threshold_10':            
 0.18834079638758416, 'scr_metric_threshold_10': 0.04464280725058454, 'scr_dir2_threshold_10': 0.04464280725058454, 'scr_dir1_threshold_20': 0.15246628261316397,                    
 'scr_metric_threshold_20': 0.04910730084933944, 'scr_dir2_threshold_20': 0.04910730084933944, 'scr_dir1_threshold_50': 0.0762330076638747, 'scr_metric_threshold_50':               
 0.02232140362529227, 'scr_dir2_threshold_50': 0.02232140362529227, 'scr_dir1_threshold_100': 0.02242150428765898, 'scr_metric_threshold_100': 0.0044642275066343415,                
 'scr_dir2_threshold_100': 0.0044642275066343415, 'scr_dir1_threshold_500': -0.06726478014839152, 'scr_metric_threshold_500': 0.03125012473068151, 'scr_dir2_threshold_500':         
 0.03125012473068151}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Industrial_and_Scientific_Toys_and_Games_results', 'scr_dir1_threshold_2': 0.05579403094120067,   
 'scr_metric_threshold_2': 0.05579403094120067, 'scr_dir2_threshold_2': -0.009523685178541423, 'scr_dir1_threshold_5': 0.11158806188240133, 'scr_metric_threshold_5':                
 0.11158806188240133, 'scr_dir2_threshold_5': 0.014285811599402364, 'scr_dir1_threshold_10': 0.11587985138236706, 'scr_metric_threshold_10': 0.11587985138236706,                    
 'scr_dir2_threshold_10': 0.009523685178541423, 'scr_dir1_threshold_20': 0.12017164088233277, 'scr_metric_threshold_20': 0.12017164088233277, 'scr_dir2_threshold_20':               
 0.0285713393672145, 'scr_dir1_threshold_50': 0.13304726519611204, 'scr_metric_threshold_50': 0.13304726519611204, 'scr_dir2_threshold_50': 0.0285713393672145,                      
 'scr_dir1_threshold_100': 0.08154502375487709, 'scr_metric_threshold_100': 0.08154502375487709, 'scr_dir2_threshold_100': 0.004761842589270712, 'scr_dir1_threshold_500':           
 0.09871243756862208, 'scr_metric_threshold_500': 0.09871243756862208, 'scr_dir2_threshold_500': -0.09047614452250444}], 'sae_bench_commit_hash':                                    
 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict':      
 {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None,         
 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none',       
 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None,    
 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'absorption evaluation results': {'eval_type_id': 'absorption_first_letter', 'eval_config': {'model_name':              
 'google/gemma-2-2b', 'random_seed': 42, 'f1_jump_threshold': 0.03, 'max_k_value': 10, 'prompt_template': '{word} has the first letter:', 'prompt_token_pos': -6, 'llm_batch_size':  
 32, 'llm_dtype': 'bfloat16', 'k_sparse_probe_l1_decay': 0.01, 'k_sparse_probe_batch_size': 4096, 'k_sparse_probe_num_epochs': 50}, 'eval_id': '515e7b3b-6b86-4214-aa0d-c2ef123e2969 
 'datetime_epoch_millis': 1737999200566, 'eval_result_metrics': {'mean': {'mean_absorption_score': 0.010124895517470242, 'mean_num_split_features': 1.2}}, 'eval_result_details':    
 [{'first_letter': 'a', 'absorption_rate': 0.00986971969996052, 'num_absorption': 25, 'num_probe_true_positives': 2533, 'num_split_features': 1}, {'first_letter': 'b',              
 'absorption_rate': 0.005050505050505051, 'num_absorption': 8, 'num_probe_true_positives': 1584, 'num_split_features': 1}, {'first_letter': 'c', 'absorption_rate':                  
 0.02792890823358723, 'num_absorption': 77, 'num_probe_true_positives': 2757, 'num_split_features': 1}, {'first_letter': 'd', 'absorption_rate': 0.008631319358816275,               
 'num_absorption': 14, 'num_probe_true_positives': 1622, 'num_split_features': 1}, {'first_letter': 'e', 'absorption_rate': 0.002523659305993691, 'num_absorption': 4,               
 'num_probe_true_positives': 1585, 'num_split_features': 1}, {'first_letter': 'f', 'absorption_rate': 0.004942339373970346, 'num_absorption': 6, 'num_probe_true_positives': 1214,   
 'num_split_features': 1}, {'first_letter': 'g', 'absorption_rate': 0.0026362038664323375, 'num_absorption': 3, 'num_probe_true_positives': 1138, 'num_split_features': 1},          
 {'first_letter': 'h', 'absorption_rate': 0.08004158004158005, 'num_absorption': 77, 'num_probe_true_positives': 962, 'num_split_features': 1}, {'first_letter': 'i',                
 'absorption_rate': 0.007402837754472548, 'num_absorption': 12, 'num_probe_true_positives': 1621, 'num_split_features': 2}, {'first_letter': 'j', 'absorption_rate':                 
 0.03546099290780142, 'num_absorption': 15, 'num_probe_true_positives': 423, 'num_split_features': 1}, {'first_letter': 'k', 'absorption_rate': 0.001557632398753894,                
 'num_absorption': 1, 'num_probe_true_positives': 642, 'num_split_features': 1}, {'first_letter': 'l', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 1196 
 'num_split_features': 1}, {'first_letter': 'm', 'absorption_rate': 0.0060406370126304225, 'num_absorption': 11, 'num_probe_true_positives': 1821, 'num_split_features': 1},         
 {'first_letter': 'n', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 845, 'num_split_features': 1}, {'first_letter': 'o', 'absorption_rate':              
 0.007070707070707071, 'num_absorption': 7, 'num_probe_true_positives': 990, 'num_split_features': 1}, {'first_letter': 'p', 'absorption_rate': 0.0004332755632582322,               
 'num_absorption': 1, 'num_probe_true_positives': 2308, 'num_split_features': 2}, {'first_letter': 'q', 'absorption_rate': 0.011428571428571429, 'num_absorption': 2,                
 'num_probe_true_positives': 175, 'num_split_features': 1}, {'first_letter': 'r', 'absorption_rate': 0.006053268765133172, 'num_absorption': 10, 'num_probe_true_positives': 1652,   
 'num_split_features': 2}, {'first_letter': 's', 'absorption_rate': 0.005263157894736842, 'num_absorption': 15, 'num_probe_true_positives': 2850, 'num_split_features': 1},          
 {'first_letter': 't', 'absorption_rate': 0.00357355568790947, 'num_absorption': 6, 'num_probe_true_positives': 1679, 'num_split_features': 2}, {'first_letter': 'u',                
 'absorption_rate': 0.0013297872340425532, 'num_absorption': 1, 'num_probe_true_positives': 752, 'num_split_features': 2}, {'first_letter': 'v', 'absorption_rate':                  
 0.0012738853503184713, 'num_absorption': 1, 'num_probe_true_positives': 785, 'num_split_features': 1}, {'first_letter': 'w', 'absorption_rate': 0.004201680672268907,               
 'num_absorption': 3, 'num_probe_true_positives': 714, 'num_split_features': 1}, {'first_letter': 'y', 'absorption_rate': 0.02040816326530612, 'num_absorption': 3,                  
 'num_probe_true_positives': 147, 'num_split_features': 1}, {'first_letter': 'z', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 230, 'num_split_features' 
 1}], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': 
 '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', '                                                                                                                      
 =======                                                                                                                                                                             
 # Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders                                                                                        
                                                                                                                                                                                     
 # Experiment description:                                                                                                                                                           
 1. Implement adaptive orthogonality loss with controlled feature sharing                                                                                                            
 2. Add batch-wise feature grouping with periodic updates                                                                                                                            
 3. Train on Gemma-2b using standard datasets                                                                                                                                        
 4. Compare unlearning performance against baseline and fixed orthogonal SAE                                                                                                         
 5. Analyze condition numbers of feature subspaces                                                                                                                                   
 6. Evaluate impact of different α values for controlled sharing                                                                                                                     
                                                                                                                                                                                     
 ## Run 0: Baseline                                                                                                                                                                  
 Standard SAE implementation without orthogonality constraints.                                                                                                                      
 Results show baseline performance with:                                                                                                                                             
 - L0 sparsity: 85.21                                                                                                                                                                
 - Explained variance: 0.309                                                                                                                                                         
 - Mean absorption score: 0.0101                                                                                                                                                     
 Key metrics saved for comparison.                                                                                                                                                   
                                                                                                                                                                                     
 ## Run 1: Initial Orthogonal Implementation                                                                                                                                         
 Added orthogonality constraints with α=0.0 (strict orthogonality):                                                                                                                  
 - Improved L0 sparsity (61.99 vs 85.21)                                                                                                                                             
 - Slightly lower reconstruction (0.293 vs 0.309)                                                                                                                                    
 - Similar absorption scores but more consistent grouping                                                                                                                            
 - Higher SCR metrics indicating better feature separation                                                                                                                           
 - Condition number tracking implemented                                                                                                                                             
 - 4 feature groups with strict orthogonality                                                                                                                                        
                                                                                                                                                                                     
 Key findings:                                                                                                                                                                       
 1. Orthogonality improves sparsity without major reconstruction loss                                                                                                                
 2. Feature groups show clear separation in SCR evaluation                                                                                                                           
 3. Strict orthogonality (α=0.0) may be too restrictive                                                                                                                              
 >>>>>>> REPLACE                                                                                                                                                                     
                                                                                                                                                                                     

For Run 2, we should test the impact of relaxing the orthogonality constraint by setting α=0.1. This allows some controlled feature sharing while maintaining group structure. I'll  
modify the OrthogonalSAE class:                                                                                                                                                      

experiment.py                                                                                                                                                                        

                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                      
         self.alpha = 0.0  # Strict orthogonality for first run                                                                                                                      
 =======                                                                                                                                                                             
         self.alpha = 0.1  # Allow controlled feature sharing                                                                                                                        
 >>>>>>> REPLACE                                                                                                                                                                     
                                                                                                                                                                                     

This change will:                                                                                                                                                                    

 1 Allow limited feature sharing between groups                                                                                                                                      
 2 Potentially improve reconstruction while maintaining sparsity                                                                                                                     
 3 Help understand optimal α values for knowledge separation                                                                                                                         

Let's run:                                                                                                                                                                           

                                                                                                                                                                                     
 python experiment.py --out_dir=run_2                                                                                                                                                
                                                                                                                                                                                     

Tokens: 41k sent, 534 received. Cost: $0.13 message, $0.36 session.
The LLM did not conform to the edit format.
https://aider.chat/docs/troubleshooting/edit-errors.html

# 1 SEARCH/REPLACE block failed to match!

## SearchReplaceNoExactMatch: This SEARCH block failed to exactly match lines in notes.txt
<<<<<<< SEARCH
# Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders
# Experiment description: 1. Implement adaptive orthogonality loss with controlled feature sharing
2. Add batch-wise feature grouping with periodic updates
3. Train on Pythia-70M using WMDP-bio and WikiText datasets
4. Compare unlearning performance against baseline and fixed orthogonal SAE
5. Analyze condition numbers of feature subspaces
6. Evaluate impact of different α values for controlled sharing
## Run 0: Baseline
Results: {'training results': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000, 
'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info': 
{'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'core evaluation results': 
{'unique_id': 'google/gemma-2-2b_layer_19_sae_custom_sae', 'sae_set': 'google/gemma-2-2b_layer_19_sae', 'sae_id': 'custom_sae', 'eval_cfg': {'model_name': 'google/gemma-2-2b', 
'llm_dtype': 'bfloat16', 'batch_size_prompts': 16, 'n_eval_reconstruction_batches': 200, 'n_eval_sparsity_variance_batches': 2000, 'dataset': 'Skylion007/openwebtext', 
'context_size': 128, 'compute_kl': True, 'compute_ce_loss': True, 'compute_l2_norms': True, 'compute_sparsity_metrics': True, 'compute_variance_metrics': True, 
'compute_featurewise_density_statistics': False, 'compute_featurewise_weight_based_metrics': False, 'exclude_special_tokens_from_reconstruction': True, 'verbose': False}, 'metrics':
{'model_behavior_preservation': {'kl_div_score': 0.7950310559006211, 'kl_div_with_ablation': 10.0625, 'kl_div_with_sae': 2.0625}, 'model_performance_preservation': {'ce_loss_score':
0.7894736842105263, 'ce_loss_with_ablation': 12.4375, 'ce_loss_with_sae': 4.9375, 'ce_loss_without_sae': 2.9375}, 'reconstruction_quality': {'explained_variance': 0.30859375, 'mse':
18.75, 'cossim': 0.76953125}, 'shrinkage': {'l2_norm_in': 308.0, 'l2_norm_out': 221.0, 'l2_ratio': 0.71484375, 'relative_reconstruction_bias': 0.93359375}, 'sparsity': {'l0': 
85.21243286132812, 'l1': 458.0}, 'token_stats': {'total_tokens_eval_reconstruction': 409600, 'total_tokens_eval_sparsity_variance': 4096000}}}, 'scr and tpp evaluations results': 
{'eval_type_id': 'scr', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'canrager/amazon_reviews_mcauley_1and5'], 'perform_scr': True, 
'early_stopping_patience': 20, 'train_set_size': 4000, 'test_set_size': 1000, 'context_length': 128, 'probe_train_batch_size': 16, 'probe_test_batch_size': 500, 'probe_epochs': 20, 
'probe_lr': 0.001, 'probe_l1_penalty': 0.001, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'lower_vram_usage': False, 'model_name': 'google/gemma-2-2b', 
'n_values': [2, 5, 10, 20, 50, 100, 500], 'column1_vals_lookup': {'LabHC/bias_in_bios_class_set1': [['professor', 'nurse'], ['architect', 'journalist'], ['surgeon', 'psychologist'],
['attorney', 'teacher']], 'canrager/amazon_reviews_mcauley_1and5': [['Books', 'CDs_and_Vinyl'], ['Software', 'Electronics'], ['Pet_Supplies', 'Office_Products'], 
['Industrial_and_Scientific', 'Toys_and_Games']]}}, 'eval_id': 'c28f32b2-a72e-4f76-8d5a-85d6f9937f1b', 'datetime_epoch_millis': 1737884773606, 'eval_result_metrics': {'scr_metrics':
{'scr_dir1_threshold_2': 0.035600906531669814, 'scr_metric_threshold_2': 0.019679524675140548, 'scr_dir2_threshold_2': 0.011514810160172787, 'scr_dir1_threshold_5': 
0.051710736232558285, 'scr_metric_threshold_5': 0.06512155475350995, 'scr_dir2_threshold_5': 0.05295877346813508, 'scr_dir1_threshold_10': 0.077764577667114, 
'scr_metric_threshold_10': 0.08335696172542797, 'scr_dir2_threshold_10': 0.07006244094994978, 'scr_dir1_threshold_20': 0.07343213933631738, 'scr_metric_threshold_20': 
0.08504280928786076, 'scr_dir2_threshold_20': 0.07359277159847097, 'scr_dir1_threshold_50': 0.03350340830709253, 'scr_metric_threshold_50': 0.08899691187101458, 
'scr_dir2_threshold_50': 0.07593742114240237, 'scr_dir1_threshold_100': -0.16207016165821828, 'scr_metric_threshold_100': 0.062236305245427885, 'scr_dir2_threshold_100': 
0.052638407599727086, 'scr_dir1_threshold_500': -0.25156349364441777, 'scr_metric_threshold_500': 0.027887084742431078, 'scr_dir2_threshold_500': 0.004238511981040263}}, 
'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_professor_nurse_results', 'scr_dir1_threshold_2': 0.03124962164991371, 'scr_metric_threshold_2': 
0.012284998611665989, 'scr_dir2_threshold_2': 0.012284998611665989, 'scr_dir1_threshold_5': -0.015625742148246177, 'scr_metric_threshold_5': 0.05896816907447914, 
'scr_dir2_threshold_5': 0.05896816907447914, 'scr_dir1_threshold_10': -0.015625742148246177, 'scr_metric_threshold_10': 0.14987724667004865, 'scr_dir2_threshold_10': 
0.14987724667004865, 'scr_dir1_threshold_20': -0.03125055297320303, 'scr_metric_threshold_20': 0.15479118753522092, 'scr_dir2_threshold_20': 0.15479118753522092, 
'scr_dir1_threshold_50': -0.2968760622906269, 'scr_metric_threshold_50': 0.16216224528171463, 'scr_dir2_threshold_50': 0.16216224528171463, 'scr_dir1_threshold_100': 
-1.312501804438873, 'scr_metric_threshold_100': 0.14987724667004865, 'scr_dir2_threshold_100': 0.14987724667004865, 'scr_dir1_threshold_500': -1.3750019790619898, 
'scr_metric_threshold_500': 0.15724815796780706, 'scr_dir2_threshold_500': 0.15724815796780706}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_architect_journalist_results', 
'scr_dir1_threshold_2': -0.08737868572318094, 'scr_metric_threshold_2': 0.034383855303823166, 'scr_dir2_threshold_2': 0.034383855303823166, 'scr_dir1_threshold_5': 
-0.10679649293164041, 'scr_metric_threshold_5': 0.06590258858377988, 'scr_dir2_threshold_5': 0.06590258858377988, 'scr_dir1_threshold_10': -0.11650510719289281, 
'scr_metric_threshold_10': 0.037249318901607584, 'scr_dir2_threshold_10': 0.037249318901607584, 'scr_dir1_threshold_20': -0.10679649293164041, 'scr_metric_threshold_20': 
0.04011461171243302, 'scr_dir2_threshold_20': 0.04011461171243302, 'scr_dir1_threshold_50': -0.14563152866260468, 'scr_metric_threshold_50': 0.07449846701625619, 
'scr_dir2_threshold_50': 0.07449846701625619, 'scr_dir1_threshold_100': -0.14563152866260468, 'scr_metric_threshold_100': 0.10888249310703833, 'scr_dir2_threshold_100': 
0.10888249310703833, 'scr_dir1_threshold_500': -0.3106797071617595, 'scr_metric_threshold_500': 0.0859598090465169, 'scr_dir2_threshold_500': 0.0859598090465169}, {'dataset_name': 
'LabHC/bias_in_bios_class_set1_scr_surgeon_psychologist_results', 'scr_dir1_threshold_2': 0.015873751732555005, 'scr_metric_threshold_2': -0.0025316127159178037, 
'scr_dir2_threshold_2': -0.0025316127159178037, 'scr_dir1_threshold_5': 0.03174655735998827, 'scr_metric_threshold_5': -0.005063225431835607, 'scr_dir2_threshold_5': 
-0.005063225431835607, 'scr_dir1_threshold_10': 0.0, 'scr_metric_threshold_10': 0.0075949890455728015, 'scr_dir2_threshold_10': 0.0075949890455728015, 'scr_dir1_threshold_20': 
-0.0634921686148548, 'scr_metric_threshold_20': 0.02784819256855401, 'scr_dir2_threshold_20': 0.02784819256855401, 'scr_dir1_threshold_50': -0.1111105854971546, 
'scr_metric_threshold_50': 0.05316462152337083, 'scr_dir2_threshold_50': 0.05316462152337083, 'scr_dir1_threshold_100': -0.2222221170994309, 'scr_metric_threshold_100': 
0.05316462152337083, 'scr_dir2_threshold_100': 0.05316462152337083, 'scr_dir1_threshold_500': -0.5714285714285714, 'scr_metric_threshold_500': 0.055696234239288635, 
'scr_dir2_threshold_500': 0.055696234239288635}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_attorney_teacher_results', 'scr_dir1_threshold_2': 0.0, 
'scr_metric_threshold_2': 0.020771598900727672, 'scr_dir2_threshold_2': 0.020771598900727672, 'scr_dir1_threshold_5': 0.0, 'scr_metric_threshold_5': 0.1246292396676148, 
'scr_dir2_threshold_5': 0.1246292396676148, 'scr_dir1_threshold_10': -0.007812398136610098, 'scr_metric_threshold_10': 0.10089032002917621, 'scr_dir2_threshold_10': 
0.10089032002917621, 'scr_dir1_threshold_20': 0.10156257275956422, 'scr_metric_threshold_20': 0.0890208602099569, 'scr_dir2_threshold_20': 0.0890208602099569, 
'scr_dir1_threshold_50': 0.10156257275956422, 'scr_metric_threshold_50': 0.11869442132381734, 'scr_dir2_threshold_50': 0.11869442132381734, 'scr_dir1_threshold_100': 
-0.17187462165026607, 'scr_metric_threshold_100': 0.10979228224230897, 'scr_dir2_threshold_100': 0.10979228224230897, 'scr_dir1_threshold_500': -0.16406222351365599, 
'scr_metric_threshold_500': 0.06824926130922924, 'scr_dir2_threshold_500': 0.06824926130922924}, {'dataset_name': 
'canrager/amazon_reviews_mcauley_1and5_scr_Books_CDs_and_Vinyl_results', 'scr_dir1_threshold_2': -0.06010915791026799, 'scr_metric_threshold_2': -0.015686069182044467, 
'scr_dir2_threshold_2': -0.015686069182044467, 'scr_dir1_threshold_5': -0.01092881936245188, 'scr_metric_threshold_5': 0.07450976358933016, 'scr_dir2_threshold_5': 
0.07450976358933016, 'scr_dir1_threshold_10': 0.27322406685360157, 'scr_metric_threshold_10': 0.10588236944072857, 'scr_dir2_threshold_10': 0.10588236944072857, 
'scr_dir1_threshold_20': 0.24043695734946327, 'scr_metric_threshold_20': 0.08235303192400713, 'scr_dir2_threshold_20': 0.08235303192400713, 'scr_dir1_threshold_50': 
0.3005464409681226, 'scr_metric_threshold_50': 0.039215874186075375, 'scr_dir2_threshold_50': 0.039215874186075375, 'scr_dir1_threshold_100': 0.2568305121015324, 
'scr_metric_threshold_100': 0.06274521170279682, 'scr_dir2_threshold_100': 0.06274521170279682, 'scr_dir1_threshold_500': 0.21311458323494226, 'scr_metric_threshold_500': 
-0.14901952717866032, 'scr_dir2_threshold_500': -0.14901952717866032}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Software_Electronics_results', 
'scr_dir1_threshold_2': 0.158974152062764, 'scr_metric_threshold_2': 0.05241939554166917, 'scr_dir2_threshold_2': 0.05241939554166917, 'scr_dir1_threshold_5': 0.17948701489841076, 
'scr_metric_threshold_5': 0.07258066454365199, 'scr_dir2_threshold_5': 0.07258066454365199, 'scr_dir1_threshold_10': 0.18461515419110838, 'scr_metric_threshold_10': 
0.10483879108333834, 'scr_dir2_threshold_10': 0.10483879108333834, 'scr_dir1_threshold_20': 0.17435887560571312, 'scr_metric_threshold_20': 0.11693564862104187, 
'scr_dir2_threshold_20': 0.11693564862104187, 'scr_dir1_threshold_50': 0.2102561563194528, 'scr_metric_threshold_50': 0.10887099681547797, 'scr_dir2_threshold_50': 
0.10887099681547797, 'scr_dir1_threshold_100': 0.19487173844135988, 'scr_metric_threshold_100': -0.07258066454365199, 'scr_dir2_threshold_100': -0.07258066454365199, 
'scr_dir1_threshold_500': 0.16410229135546164, 'scr_metric_threshold_500': -0.12499981974403652, 'scr_dir2_threshold_500': -0.12499981974403652}, {'dataset_name': 
'canrager/amazon_reviews_mcauley_1and5_scr_Pet_Supplies_Office_Products_results', 'scr_dir1_threshold_2': 0.17040353950037407, 'scr_metric_threshold_2': 0.0, 'scr_dir2_threshold_2':
0.0, 'scr_dir1_threshold_5': 0.22421531016200436, 'scr_metric_threshold_5': 0.017857176118657926, 'scr_dir2_threshold_5': 0.017857176118657926, 'scr_dir1_threshold_10': 
0.18834079638758416, 'scr_metric_threshold_10': 0.04464280725058454, 'scr_dir2_threshold_10': 0.04464280725058454, 'scr_dir1_threshold_20': 0.15246628261316397, 
'scr_metric_threshold_20': 0.04910730084933944, 'scr_dir2_threshold_20': 0.04910730084933944, 'scr_dir1_threshold_50': 0.0762330076638747, 'scr_metric_threshold_50': 
0.02232140362529227, 'scr_dir2_threshold_50': 0.02232140362529227, 'scr_dir1_threshold_100': 0.02242150428765898, 'scr_metric_threshold_100': 0.0044642275066343415, 
'scr_dir2_threshold_100': 0.0044642275066343415, 'scr_dir1_threshold_500': -0.06726478014839152, 'scr_metric_threshold_500': 0.03125012473068151, 'scr_dir2_threshold_500': 
0.03125012473068151}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Industrial_and_Scientific_Toys_and_Games_results', 'scr_dir1_threshold_2': 0.05579403094120067, 
'scr_metric_threshold_2': 0.05579403094120067, 'scr_dir2_threshold_2': -0.009523685178541423, 'scr_dir1_threshold_5': 0.11158806188240133, 'scr_metric_threshold_5': 
0.11158806188240133, 'scr_dir2_threshold_5': 0.014285811599402364, 'scr_dir1_threshold_10': 0.11587985138236706, 'scr_metric_threshold_10': 0.11587985138236706, 
'scr_dir2_threshold_10': 0.009523685178541423, 'scr_dir1_threshold_20': 0.12017164088233277, 'scr_metric_threshold_20': 0.12017164088233277, 'scr_dir2_threshold_20': 
0.0285713393672145, 'scr_dir1_threshold_50': 0.13304726519611204, 'scr_metric_threshold_50': 0.13304726519611204, 'scr_dir2_threshold_50': 0.0285713393672145, 
'scr_dir1_threshold_100': 0.08154502375487709, 'scr_metric_threshold_100': 0.08154502375487709, 'scr_dir2_threshold_100': 0.004761842589270712, 'scr_dir1_threshold_500': 
0.09871243756862208, 'scr_metric_threshold_500': 0.09871243756862208, 'scr_dir2_threshold_500': -0.09047614452250444}], 'sae_bench_commit_hash': 
'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': 
{'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None, 
'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 
'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 
'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'absorption evaluation results': {'eval_type_id': 'absorption_first_letter', 'eval_config': {'model_name': 
'google/gemma-2-2b', 'random_seed': 42, 'f1_jump_threshold': 0.03, 'max_k_value': 10, 'prompt_template': '{word} has the first letter:', 'prompt_token_pos': -6, 'llm_batch_size': 
32, 'llm_dtype': 'bfloat16', 'k_sparse_probe_l1_decay': 0.01, 'k_sparse_probe_batch_size': 4096, 'k_sparse_probe_num_epochs': 50}, 'eval_id': '515e7b3b-6b86-4214-aa0d-c2ef123e2969',
'datetime_epoch_millis': 1737999200566, 'eval_result_metrics': {'mean': {'mean_absorption_score': 0.010124895517470242, 'mean_num_split_features': 1.2}}, 'eval_result_details': 
[{'first_letter': 'a', 'absorption_rate': 0.00986971969996052, 'num_absorption': 25, 'num_probe_true_positives': 2533, 'num_split_features': 1}, {'first_letter': 'b', 
'absorption_rate': 0.005050505050505051, 'num_absorption': 8, 'num_probe_true_positives': 1584, 'num_split_features': 1}, {'first_letter': 'c', 'absorption_rate': 
0.02792890823358723, 'num_absorption': 77, 'num_probe_true_positives': 2757, 'num_split_features': 1}, {'first_letter': 'd', 'absorption_rate': 0.008631319358816275, 
'num_absorption': 14, 'num_probe_true_positives': 1622, 'num_split_features': 1}, {'first_letter': 'e', 'absorption_rate': 0.002523659305993691, 'num_absorption': 4, 
'num_probe_true_positives': 1585, 'num_split_features': 1}, {'first_letter': 'f', 'absorption_rate': 0.004942339373970346, 'num_absorption': 6, 'num_probe_true_positives': 1214, 
'num_split_features': 1}, {'first_letter': 'g', 'absorption_rate': 0.0026362038664323375, 'num_absorption': 3, 'num_probe_true_positives': 1138, 'num_split_features': 1}, 
{'first_letter': 'h', 'absorption_rate': 0.08004158004158005, 'num_absorption': 77, 'num_probe_true_positives': 962, 'num_split_features': 1}, {'first_letter': 'i', 
'absorption_rate': 0.007402837754472548, 'num_absorption': 12, 'num_probe_true_positives': 1621, 'num_split_features': 2}, {'first_letter': 'j', 'absorption_rate': 
0.03546099290780142, 'num_absorption': 15, 'num_probe_true_positives': 423, 'num_split_features': 1}, {'first_letter': 'k', 'absorption_rate': 0.001557632398753894, 
'num_absorption': 1, 'num_probe_true_positives': 642, 'num_split_features': 1}, {'first_letter': 'l', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 1196, 
'num_split_features': 1}, {'first_letter': 'm', 'absorption_rate': 0.0060406370126304225, 'num_absorption': 11, 'num_probe_true_positives': 1821, 'num_split_features': 1}, 
{'first_letter': 'n', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 845, 'num_split_features': 1}, {'first_letter': 'o', 'absorption_rate': 
0.007070707070707071, 'num_absorption': 7, 'num_probe_true_positives': 990, 'num_split_features': 1}, {'first_letter': 'p', 'absorption_rate': 0.0004332755632582322, 
'num_absorption': 1, 'num_probe_true_positives': 2308, 'num_split_features': 2}, {'first_letter': 'q', 'absorption_rate': 0.011428571428571429, 'num_absorption': 2, 
'num_probe_true_positives': 175, 'num_split_features': 1}, {'first_letter': 'r', 'absorption_rate': 0.006053268765133172, 'num_absorption': 10, 'num_probe_true_positives': 1652, 
'num_split_features': 2}, {'first_letter': 's', 'absorption_rate': 0.005263157894736842, 'num_absorption': 15, 'num_probe_true_positives': 2850, 'num_split_features': 1}, 
{'first_letter': 't', 'absorption_rate': 0.00357355568790947, 'num_absorption': 6, 'num_probe_true_positives': 1679, 'num_split_features': 2}, {'first_letter': 'u', 
'absorption_rate': 0.0013297872340425532, 'num_absorption': 1, 'num_probe_true_positives': 752, 'num_split_features': 2}, {'first_letter': 'v', 'absorption_rate': 
0.0012738853503184713, 'num_absorption': 1, 'num_probe_true_positives': 785, 'num_split_features': 1}, {'first_letter': 'w', 'absorption_rate': 0.004201680672268907, 
'num_absorption': 3, 'num_probe_true_positives': 714, 'num_split_features': 1}, {'first_letter': 'y', 'absorption_rate': 0.02040816326530612, 'num_absorption': 3, 
'num_probe_true_positives': 147, 'num_split_features': 1}, {'first_letter': 'z', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 230, 'num_split_features': 
1}], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': 
'5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', '
=======
# Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders

# Experiment description: 
1. Implement adaptive orthogonality loss with controlled feature sharing
2. Add batch-wise feature grouping with periodic updates
3. Train on Gemma-2b using standard datasets
4. Compare unlearning performance against baseline and fixed orthogonal SAE
5. Analyze condition numbers of feature subspaces
6. Evaluate impact of different α values for controlled sharing

## Run 0: Baseline
Standard SAE implementation without orthogonality constraints.
Results show baseline performance with:
- L0 sparsity: 85.21
- Explained variance: 0.309
- Mean absorption score: 0.0101
Key metrics saved for comparison.

## Run 1: Initial Orthogonal Implementation
Added orthogonality constraints with α=0.0 (strict orthogonality):
- Improved L0 sparsity (61.99 vs 85.21)
- Slightly lower reconstruction (0.293 vs 0.309)
- Similar absorption scores but more consistent grouping
- Higher SCR metrics indicating better feature separation
- Condition number tracking implemented
- 4 feature groups with strict orthogonality

Key findings:
1. Orthogonality improves sparsity without major reconstruction loss
2. Feature groups show clear separation in SCR evaluation
3. Strict orthogonality (α=0.0) may be too restrictive
>>>>>>> REPLACE

Did you mean to match some of these actual lines from notes.txt?

```
# Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders
# Experiment description: 1. Implement adaptive orthogonality loss with controlled feature sharing
2. Add batch-wise feature grouping with periodic updates
3. Train on Pythia-70M using WMDP-bio and WikiText datasets
4. Compare unlearning performance against baseline and fixed orthogonal SAE
5. Analyze condition numbers of feature subspaces
6. Evaluate impact of different α values for controlled sharing
## Run 0: Baseline
Results: {'training results': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000, 
'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info': 
{'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'core evaluation results': 
{'unique_id': 'google/gemma-2-2b_layer_19_sae_custom_sae', 'sae_set': 'google/gemma-2-2b_layer_19_sae', 'sae_id': 'custom_sae', 'eval_cfg': {'model_name': 'google/gemma-2-2b', 
'llm_dtype': 'bfloat16', 'batch_size_prompts': 16, 'n_eval_reconstruction_batches': 200, 'n_eval_sparsity_variance_batches': 2000, 'dataset': 'Skylion007/openwebtext', 
'context_size': 128, 'compute_kl': True, 'compute_ce_loss': True, 'compute_l2_norms': True, 'compute_sparsity_metrics': True, 'compute_variance_metrics': True, 
'compute_featurewise_density_statistics': False, 'compute_featurewise_weight_based_metrics': False, 'exclude_special_tokens_from_reconstruction': True, 'verbose': False}, 'metrics':
{'model_behavior_preservation': {'kl_div_score': 0.7950310559006211, 'kl_div_with_ablation': 10.0625, 'kl_div_with_sae': 2.0625}, 'model_performance_preservation': {'ce_loss_score':
0.7894736842105263, 'ce_loss_with_ablation': 12.4375, 'ce_loss_with_sae': 4.9375, 'ce_loss_without_sae': 2.9375}, 'reconstruction_quality': {'explained_variance': 0.30859375, 'mse':
18.75, 'cossim': 0.76953125}, 'shrinkage': {'l2_norm_in': 308.0, 'l2_norm_out': 221.0, 'l2_ratio': 0.71484375, 'relative_reconstruction_bias': 0.93359375}, 'sparsity': {'l0': 
85.21243286132812, 'l1': 458.0}, 'token_stats': {'total_tokens_eval_reconstruction': 409600, 'total_tokens_eval_sparsity_variance': 4096000}}}, 'scr and tpp evaluations results': 
{'eval_type_id': 'scr', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'canrager/amazon_reviews_mcauley_1and5'], 'perform_scr': True, 
'early_stopping_patience': 20, 'train_set_size': 4000, 'test_set_size': 1000, 'context_length': 128, 'probe_train_batch_size': 16, 'probe_test_batch_size': 500, 'probe_epochs': 20, 
'probe_lr': 0.001, 'probe_l1_penalty': 0.001, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'lower_vram_usage': False, 'model_name': 'google/gemma-2-2b', 
'n_values': [2, 5, 10, 20, 50, 100, 500], 'column1_vals_lookup': {'LabHC/bias_in_bios_class_set1': [['professor', 'nurse'], ['architect', 'journalist'], ['surgeon', 'psychologist'],
['attorney', 'teacher']], 'canrager/amazon_reviews_mcauley_1and5': [['Books', 'CDs_and_Vinyl'], ['Software', 'Electronics'], ['Pet_Supplies', 'Office_Products'], 
['Industrial_and_Scientific', 'Toys_and_Games']]}}, 'eval_id': 'c28f32b2-a72e-4f76-8d5a-85d6f9937f1b', 'datetime_epoch_millis': 1737884773606, 'eval_result_metrics': {'scr_metrics':
{'scr_dir1_threshold_2': 0.035600906531669814, 'scr_metric_threshold_2': 0.019679524675140548, 'scr_dir2_threshold_2': 0.011514810160172787, 'scr_dir1_threshold_5': 
0.051710736232558285, 'scr_metric_threshold_5': 0.06512155475350995, 'scr_dir2_threshold_5': 0.05295877346813508, 'scr_dir1_threshold_10': 0.077764577667114, 
'scr_metric_threshold_10': 0.08335696172542797, 'scr_dir2_threshold_10': 0.07006244094994978, 'scr_dir1_threshold_20': 0.07343213933631738, 'scr_metric_threshold_20': 
0.08504280928786076, 'scr_dir2_threshold_20': 0.07359277159847097, 'scr_dir1_threshold_50': 0.03350340830709253, 'scr_metric_threshold_50': 0.08899691187101458, 
'scr_dir2_threshold_50': 0.07593742114240237, 'scr_dir1_threshold_100': -0.16207016165821828, 'scr_metric_threshold_100': 0.062236305245427885, 'scr_dir2_threshold_100': 
0.052638407599727086, 'scr_dir1_threshold_500': -0.25156349364441777, 'scr_metric_threshold_500': 0.027887084742431078, 'scr_dir2_threshold_500': 0.004238511981040263}}, 
'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_professor_nurse_results', 'scr_dir1_threshold_2': 0.03124962164991371, 'scr_metric_threshold_2': 
0.012284998611665989, 'scr_dir2_threshold_2': 0.012284998611665989, 'scr_dir1_threshold_5': -0.015625742148246177, 'scr_metric_threshold_5': 0.05896816907447914, 
'scr_dir2_threshold_5': 0.05896816907447914, 'scr_dir1_threshold_10': -0.015625742148246177, 'scr_metric_threshold_10': 0.14987724667004865, 'scr_dir2_threshold_10': 
0.14987724667004865, 'scr_dir1_threshold_20': -0.03125055297320303, 'scr_metric_threshold_20': 0.15479118753522092, 'scr_dir2_threshold_20': 0.15479118753522092, 
'scr_dir1_threshold_50': -0.2968760622906269, 'scr_metric_threshold_50': 0.16216224528171463, 'scr_dir2_threshold_50': 0.16216224528171463, 'scr_dir1_threshold_100': 
-1.312501804438873, 'scr_metric_threshold_100': 0.14987724667004865, 'scr_dir2_threshold_100': 0.14987724667004865, 'scr_dir1_threshold_500': -1.3750019790619898, 
'scr_metric_threshold_500': 0.15724815796780706, 'scr_dir2_threshold_500': 0.15724815796780706}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_architect_journalist_results', 
'scr_dir1_threshold_2': -0.08737868572318094, 'scr_metric_threshold_2': 0.034383855303823166, 'scr_dir2_threshold_2': 0.034383855303823166, 'scr_dir1_threshold_5': 
-0.10679649293164041, 'scr_metric_threshold_5': 0.06590258858377988, 'scr_dir2_threshold_5': 0.06590258858377988, 'scr_dir1_threshold_10': -0.11650510719289281, 
'scr_metric_threshold_10': 0.037249318901607584, 'scr_dir2_threshold_10': 0.037249318901607584, 'scr_dir1_threshold_20': -0.10679649293164041, 'scr_metric_threshold_20': 
0.04011461171243302, 'scr_dir2_threshold_20': 0.04011461171243302, 'scr_dir1_threshold_50': -0.14563152866260468, 'scr_metric_threshold_50': 0.07449846701625619, 
'scr_dir2_threshold_50': 0.07449846701625619, 'scr_dir1_threshold_100': -0.14563152866260468, 'scr_metric_threshold_100': 0.10888249310703833, 'scr_dir2_threshold_100': 
0.10888249310703833, 'scr_dir1_threshold_500': -0.3106797071617595, 'scr_metric_threshold_500': 0.0859598090465169, 'scr_dir2_threshold_500': 0.0859598090465169}, {'dataset_name': 
'LabHC/bias_in_bios_class_set1_scr_surgeon_psychologist_results', 'scr_dir1_threshold_2': 0.015873751732555005, 'scr_metric_threshold_2': -0.0025316127159178037, 
'scr_dir2_threshold_2': -0.0025316127159178037, 'scr_dir1_threshold_5': 0.03174655735998827, 'scr_metric_threshold_5': -0.005063225431835607, 'scr_dir2_threshold_5': 
-0.005063225431835607, 'scr_dir1_threshold_10': 0.0, 'scr_metric_threshold_10': 0.0075949890455728015, 'scr_dir2_threshold_10': 0.0075949890455728015, 'scr_dir1_threshold_20': 
-0.0634921686148548, 'scr_metric_threshold_20': 0.02784819256855401, 'scr_dir2_threshold_20': 0.02784819256855401, 'scr_dir1_threshold_50': -0.1111105854971546, 
'scr_metric_threshold_50': 0.05316462152337083, 'scr_dir2_threshold_50': 0.05316462152337083, 'scr_dir1_threshold_100': -0.2222221170994309, 'scr_metric_threshold_100': 
0.05316462152337083, 'scr_dir2_threshold_100': 0.05316462152337083, 'scr_dir1_threshold_500': -0.5714285714285714, 'scr_metric_threshold_500': 0.055696234239288635, 
'scr_dir2_threshold_500': 0.055696234239288635}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_attorney_teacher_results', 'scr_dir1_threshold_2': 0.0, 
'scr_metric_threshold_2': 0.020771598900727672, 'scr_dir2_threshold_2': 0.020771598900727672, 'scr_dir1_threshold_5': 0.0, 'scr_metric_threshold_5': 0.1246292396676148, 
'scr_dir2_threshold_5': 0.1246292396676148, 'scr_dir1_threshold_10': -0.007812398136610098, 'scr_metric_threshold_10': 0.10089032002917621, 'scr_dir2_threshold_10': 
0.10089032002917621, 'scr_dir1_threshold_20': 0.10156257275956422, 'scr_metric_threshold_20': 0.0890208602099569, 'scr_dir2_threshold_20': 0.0890208602099569, 
'scr_dir1_threshold_50': 0.10156257275956422, 'scr_metric_threshold_50': 0.11869442132381734, 'scr_dir2_threshold_50': 0.11869442132381734, 'scr_dir1_threshold_100': 
-0.17187462165026607, 'scr_metric_threshold_100': 0.10979228224230897, 'scr_dir2_threshold_100': 0.10979228224230897, 'scr_dir1_threshold_500': -0.16406222351365599, 
'scr_metric_threshold_500': 0.06824926130922924, 'scr_dir2_threshold_500': 0.06824926130922924}, {'dataset_name': 
'canrager/amazon_reviews_mcauley_1and5_scr_Books_CDs_and_Vinyl_results', 'scr_dir1_threshold_2': -0.06010915791026799, 'scr_metric_threshold_2': -0.015686069182044467, 
'scr_dir2_threshold_2': -0.015686069182044467, 'scr_dir1_threshold_5': -0.01092881936245188, 'scr_metric_threshold_5': 0.07450976358933016, 'scr_dir2_threshold_5': 
0.07450976358933016, 'scr_dir1_threshold_10': 0.27322406685360157, 'scr_metric_threshold_10': 0.10588236944072857, 'scr_dir2_threshold_10': 0.10588236944072857, 
'scr_dir1_threshold_20': 0.24043695734946327, 'scr_metric_threshold_20': 0.08235303192400713, 'scr_dir2_threshold_20': 0.08235303192400713, 'scr_dir1_threshold_50': 
0.3005464409681226, 'scr_metric_threshold_50': 0.039215874186075375, 'scr_dir2_threshold_50': 0.039215874186075375, 'scr_dir1_threshold_100': 0.2568305121015324, 
'scr_metric_threshold_100': 0.06274521170279682, 'scr_dir2_threshold_100': 0.06274521170279682, 'scr_dir1_threshold_500': 0.21311458323494226, 'scr_metric_threshold_500': 
-0.14901952717866032, 'scr_dir2_threshold_500': -0.14901952717866032}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Software_Electronics_results', 
'scr_dir1_threshold_2': 0.158974152062764, 'scr_metric_threshold_2': 0.05241939554166917, 'scr_dir2_threshold_2': 0.05241939554166917, 'scr_dir1_threshold_5': 0.17948701489841076, 
'scr_metric_threshold_5': 0.07258066454365199, 'scr_dir2_threshold_5': 0.07258066454365199, 'scr_dir1_threshold_10': 0.18461515419110838, 'scr_metric_threshold_10': 
0.10483879108333834, 'scr_dir2_threshold_10': 0.10483879108333834, 'scr_dir1_threshold_20': 0.17435887560571312, 'scr_metric_threshold_20': 0.11693564862104187, 
'scr_dir2_threshold_20': 0.11693564862104187, 'scr_dir1_threshold_50': 0.2102561563194528, 'scr_metric_threshold_50': 0.10887099681547797, 'scr_dir2_threshold_50': 
0.10887099681547797, 'scr_dir1_threshold_100': 0.19487173844135988, 'scr_metric_threshold_100': -0.07258066454365199, 'scr_dir2_threshold_100': -0.07258066454365199, 
'scr_dir1_threshold_500': 0.16410229135546164, 'scr_metric_threshold_500': -0.12499981974403652, 'scr_dir2_threshold_500': -0.12499981974403652}, {'dataset_name': 
'canrager/amazon_reviews_mcauley_1and5_scr_Pet_Supplies_Office_Products_results', 'scr_dir1_threshold_2': 0.17040353950037407, 'scr_metric_threshold_2': 0.0, 'scr_dir2_threshold_2':
0.0, 'scr_dir1_threshold_5': 0.22421531016200436, 'scr_metric_threshold_5': 0.017857176118657926, 'scr_dir2_threshold_5': 0.017857176118657926, 'scr_dir1_threshold_10': 
0.18834079638758416, 'scr_metric_threshold_10': 0.04464280725058454, 'scr_dir2_threshold_10': 0.04464280725058454, 'scr_dir1_threshold_20': 0.15246628261316397, 
'scr_metric_threshold_20': 0.04910730084933944, 'scr_dir2_threshold_20': 0.04910730084933944, 'scr_dir1_threshold_50': 0.0762330076638747, 'scr_metric_threshold_50': 
0.02232140362529227, 'scr_dir2_threshold_50': 0.02232140362529227, 'scr_dir1_threshold_100': 0.02242150428765898, 'scr_metric_threshold_100': 0.0044642275066343415, 
'scr_dir2_threshold_100': 0.0044642275066343415, 'scr_dir1_threshold_500': -0.06726478014839152, 'scr_metric_threshold_500': 0.03125012473068151, 'scr_dir2_threshold_500': 
0.03125012473068151}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Industrial_and_Scientific_Toys_and_Games_results', 'scr_dir1_threshold_2': 0.05579403094120067, 
'scr_metric_threshold_2': 0.05579403094120067, 'scr_dir2_threshold_2': -0.009523685178541423, 'scr_dir1_threshold_5': 0.11158806188240133, 'scr_metric_threshold_5': 
0.11158806188240133, 'scr_dir2_threshold_5': 0.014285811599402364, 'scr_dir1_threshold_10': 0.11587985138236706, 'scr_metric_threshold_10': 0.11587985138236706, 
'scr_dir2_threshold_10': 0.009523685178541423, 'scr_dir1_threshold_20': 0.12017164088233277, 'scr_metric_threshold_20': 0.12017164088233277, 'scr_dir2_threshold_20': 
0.0285713393672145, 'scr_dir1_threshold_50': 0.13304726519611204, 'scr_metric_threshold_50': 0.13304726519611204, 'scr_dir2_threshold_50': 0.0285713393672145, 
'scr_dir1_threshold_100': 0.08154502375487709, 'scr_metric_threshold_100': 0.08154502375487709, 'scr_dir2_threshold_100': 0.004761842589270712, 'scr_dir1_threshold_500': 
0.09871243756862208, 'scr_metric_threshold_500': 0.09871243756862208, 'scr_dir2_threshold_500': -0.09047614452250444}], 'sae_bench_commit_hash': 
'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': 
{'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None, 
'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 
'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 
'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'absorption evaluation results': {'eval_type_id': 'absorption_first_letter', 'eval_config': {'model_name': 
'google/gemma-2-2b', 'random_seed': 42, 'f1_jump_threshold': 0.03, 'max_k_value': 10, 'prompt_template': '{word} has the first letter:', 'prompt_token_pos': -6, 'llm_batch_size': 
32, 'llm_dtype': 'bfloat16', 'k_sparse_probe_l1_decay': 0.01, 'k_sparse_probe_batch_size': 4096, 'k_sparse_probe_num_epochs': 50}, 'eval_id': '515e7b3b-6b86-4214-aa0d-c2ef123e2969',
'datetime_epoch_millis': 1737999200566, 'eval_result_metrics': {'mean': {'mean_absorption_score': 0.010124895517470242, 'mean_num_split_features': 1.2}}, 'eval_result_details': 
[{'first_letter': 'a', 'absorption_rate': 0.00986971969996052, 'num_absorption': 25, 'num_probe_true_positives': 2533, 'num_split_features': 1}, {'first_letter': 'b', 
'absorption_rate': 0.005050505050505051, 'num_absorption': 8, 'num_probe_true_positives': 1584, 'num_split_features': 1}, {'first_letter': 'c', 'absorption_rate': 
0.02792890823358723, 'num_absorption': 77, 'num_probe_true_positives': 2757, 'num_split_features': 1}, {'first_letter': 'd', 'absorption_rate': 0.008631319358816275, 
'num_absorption': 14, 'num_probe_true_positives': 1622, 'num_split_features': 1}, {'first_letter': 'e', 'absorption_rate': 0.002523659305993691, 'num_absorption': 4, 
'num_probe_true_positives': 1585, 'num_split_features': 1}, {'first_letter': 'f', 'absorption_rate': 0.004942339373970346, 'num_absorption': 6, 'num_probe_true_positives': 1214, 
'num_split_features': 1}, {'first_letter': 'g', 'absorption_rate': 0.0026362038664323375, 'num_absorption': 3, 'num_probe_true_positives': 1138, 'num_split_features': 1}, 
{'first_letter': 'h', 'absorption_rate': 0.08004158004158005, 'num_absorption': 77, 'num_probe_true_positives': 962, 'num_split_features': 1}, {'first_letter': 'i', 
'absorption_rate': 0.007402837754472548, 'num_absorption': 12, 'num_probe_true_positives': 1621, 'num_split_features': 2}, {'first_letter': 'j', 'absorption_rate': 
0.03546099290780142, 'num_absorption': 15, 'num_probe_true_positives': 423, 'num_split_features': 1}, {'first_letter': 'k', 'absorption_rate': 0.001557632398753894, 
'num_absorption': 1, 'num_probe_true_positives': 642, 'num_split_features': 1}, {'first_letter': 'l', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 1196, 
'num_split_features': 1}, {'first_letter': 'm', 'absorption_rate': 0.0060406370126304225, 'num_absorption': 11, 'num_probe_true_positives': 1821, 'num_split_features': 1}, 
{'first_letter': 'n', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 845, 'num_split_features': 1}, {'first_letter': 'o', 'absorption_rate': 
0.007070707070707071, 'num_absorption': 7, 'num_probe_true_positives': 990, 'num_split_features': 1}, {'first_letter': 'p', 'absorption_rate': 0.0004332755632582322, 
'num_absorption': 1, 'num_probe_true_positives': 2308, 'num_split_features': 2}, {'first_letter': 'q', 'absorption_rate': 0.011428571428571429, 'num_absorption': 2, 
'num_probe_true_positives': 175, 'num_split_features': 1}, {'first_letter': 'r', 'absorption_rate': 0.006053268765133172, 'num_absorption': 10, 'num_probe_true_positives': 1652, 
'num_split_features': 2}, {'first_letter': 's', 'absorption_rate': 0.005263157894736842, 'num_absorption': 15, 'num_probe_true_positives': 2850, 'num_split_features': 1}, 
{'first_letter': 't', 'absorption_rate': 0.00357355568790947, 'num_absorption': 6, 'num_probe_true_positives': 1679, 'num_split_features': 2}, {'first_letter': 'u', 
'absorption_rate': 0.0013297872340425532, 'num_absorption': 1, 'num_probe_true_positives': 752, 'num_split_features': 2}, {'first_letter': 'v', 'absorption_rate': 
0.0012738853503184713, 'num_absorption': 1, 'num_probe_true_positives': 785, 'num_split_features': 1}, {'first_letter': 'w', 'absorption_rate': 0.004201680672268907, 
'num_absorption': 3, 'num_probe_true_positives': 714, 'num_split_features': 1}, {'first_letter': 'y', 'absorption_rate': 0.02040816326530612, 'num_absorption': 3, 
'num_probe_true_positives': 147, 'num_split_features': 1}, {'first_letter': 'z', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 230, 'num_split_features': 
1}], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': 
'5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None, 
'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 
'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 
'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'sparse probing evaluation results': {'eval_type_id': 'sparse_probing', 'eval_config':
{'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'LabHC/bias_in_bios_class_set2', 'LabHC/bias_in_bios_class_set3', 'canrager/amazon_reviews_mcauley_1and5', 
'canrager/amazon_reviews_mcauley_1and5_sentiment', 'codeparrot/github-code', 'fancyzhx/ag_news', 'Helsinki-NLP/europarl'], 'probe_train_set_size': 4000, 'probe_test_set_size': 1000,
'context_length': 128, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'model_name': 'google/gemma-2-2b', 'k_values': [1, 2, 5, 10, 20, 50], 
'lower_vram_usage': False}, 'eval_id': 'fddb5e3e-09c2-4d2c-b7ac-9077585d20ec', 'datetime_epoch_millis': 1737900662632, 'eval_result_metrics': {'llm': {'llm_test_accuracy': 
0.9505874999999999, 'llm_top_1_test_accuracy': 0.6539375, 'llm_top_2_test_accuracy': 0.7235875, 'llm_top_5_test_accuracy': 0.7815, 'llm_top_10_test_accuracy': 0.8289187499999999, 
'llm_top_20_test_accuracy': 0.8770187500000001, 'llm_top_50_test_accuracy': 0.9236000000000001, 'llm_top_100_test_accuracy': None}, 'sae': {'sae_test_accuracy': 0.9151000421494245, 
'sae_top_1_test_accuracy': 0.6601812499999999, 'sae_top_2_test_accuracy': 0.70936875, 'sae_top_5_test_accuracy': 0.7653812499999999, 'sae_top_10_test_accuracy': 0.8049125000000001, 
'sae_top_20_test_accuracy': 0.84908125, 'sae_top_50_test_accuracy': 0.8829625, 'sae_top_100_test_accuracy': None}}, 'eval_result_details': [{'dataset_name': 
'LabHC/bias_in_bios_class_set1_results', 'llm_test_accuracy': 0.9596, 'llm_top_1_test_accuracy': 0.6432, 'llm_top_2_test_accuracy': 0.6916, 'llm_top_5_test_accuracy': 0.7912, 
'llm_top_10_test_accuracy': 0.8336, 'llm_top_20_test_accuracy': 0.8962, 'llm_top_50_test_accuracy': 0.9384, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 
0.9414000391960144, 'sae_top_1_test_accuracy': 0.6437999999999999, 'sae_top_2_test_accuracy': 0.7016, 'sae_top_5_test_accuracy': 0.7776, 'sae_top_10_test_accuracy': 
0.8150000000000001, 'sae_top_20_test_accuracy': 0.8516, 'sae_top_50_test_accuracy': 0.9064, 'sae_top_100_test_accuracy': None}, {'dataset_name': 
'LabHC/bias_in_bios_class_set2_results', 'llm_test_accuracy': 0.9468, 'llm_top_1_test_accuracy': 0.6779999999999999, 'llm_top_2_test_accuracy': 0.7282, 'llm_top_5_test_accuracy': 
0.77, 'llm_top_10_test_accuracy': 0.8024000000000001, 'llm_top_20_test_accuracy': 0.8596, 'llm_top_50_test_accuracy': 0.9076000000000001, 'llm_top_100_test_accuracy': None, 
'sae_test_accuracy': 0.9112000346183777, 'sae_top_1_test_accuracy': 0.6588, 'sae_top_2_test_accuracy': 0.6958, 'sae_top_5_test_accuracy': 0.7487999999999999, 
'sae_top_10_test_accuracy': 0.8055999999999999, 'sae_top_20_test_accuracy': 0.849, 'sae_top_50_test_accuracy': 0.8788, 'sae_top_100_test_accuracy': None}, {'dataset_name': 
'LabHC/bias_in_bios_class_set3_results', 'llm_test_accuracy': 0.914, 'llm_top_1_test_accuracy': 0.6888, 'llm_top_2_test_accuracy': 0.7322, 'llm_top_5_test_accuracy': 
0.7544000000000001, 'llm_top_10_test_accuracy': 0.7958, 'llm_top_20_test_accuracy': 0.8518000000000001, 'llm_top_50_test_accuracy': 0.8942, 'llm_top_100_test_accuracy': None, 
'sae_test_accuracy': 0.8954000353813172, 'sae_top_1_test_accuracy': 0.6872, 'sae_top_2_test_accuracy': 0.716, 'sae_top_5_test_accuracy': 0.7642, 'sae_top_10_test_accuracy': 0.8092, 
'sae_top_20_test_accuracy': 0.8370000000000001, 'sae_top_50_test_accuracy': 0.8684000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 
'canrager/amazon_reviews_mcauley_1and5_results', 'llm_test_accuracy': 0.897, 'llm_top_1_test_accuracy': 0.6003999999999999, 'llm_top_2_test_accuracy': 0.6422000000000001, 
'llm_top_5_test_accuracy': 0.6752, 'llm_top_10_test_accuracy': 0.7379999999999999, 'llm_top_20_test_accuracy': 0.8098000000000001, 'llm_top_50_test_accuracy': 0.8640000000000001, 
'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.8272000432014466, 'sae_top_1_test_accuracy': 0.5764000000000001, 'sae_top_2_test_accuracy': 0.5928, 
'sae_top_5_test_accuracy': 0.6258, 'sae_top_10_test_accuracy': 0.6836, 'sae_top_20_test_accuracy': 0.76, 'sae_top_50_test_accuracy': 0.7934, 'sae_top_100_test_accuracy': None}, 
{'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_sentiment_results', 'llm_test_accuracy': 0.9815, 'llm_top_1_test_accuracy': 0.671, 'llm_top_2_test_accuracy': 0.724, 
'llm_top_5_test_accuracy': 0.766, 'llm_top_10_test_accuracy': 0.826, 'llm_top_20_test_accuracy': 0.847, 'llm_top_50_test_accuracy': 0.933, 'llm_top_100_test_accuracy': None, 
'sae_test_accuracy': 0.9355000555515289, 'sae_top_1_test_accuracy': 0.797, 'sae_top_2_test_accuracy': 0.888, 'sae_top_5_test_accuracy': 0.893, 'sae_top_10_test_accuracy': 0.892, 
'sae_top_20_test_accuracy': 0.916, 'sae_top_50_test_accuracy': 0.91, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'codeparrot/github-code_results', 'llm_test_accuracy': 
0.9673999999999999, 'llm_top_1_test_accuracy': 0.6672, 'llm_top_2_test_accuracy': 0.7051999999999999, 'llm_top_5_test_accuracy': 0.7662, 'llm_top_10_test_accuracy': 
0.8019999999999999, 'llm_top_20_test_accuracy': 0.8624, 'llm_top_50_test_accuracy': 0.9298, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9314000487327576, 
'sae_top_1_test_accuracy': 0.6874, 'sae_top_2_test_accuracy': 0.6843999999999999, 'sae_top_5_test_accuracy': 0.765, 'sae_top_10_test_accuracy': 0.8022, 'sae_top_20_test_accuracy': 
0.8555999999999999, 'sae_top_50_test_accuracy': 0.8926000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'fancyzhx/ag_news_results', 'llm_test_accuracy': 
0.9390000000000001, 'llm_top_1_test_accuracy': 0.6385000000000001, 'llm_top_2_test_accuracy': 0.7815, 'llm_top_5_test_accuracy': 0.822, 'llm_top_10_test_accuracy': 
0.8687499999999999, 'llm_top_20_test_accuracy': 0.89975, 'llm_top_50_test_accuracy': 0.924, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9215000420808792, 
'sae_top_1_test_accuracy': 0.62925, 'sae_top_2_test_accuracy': 0.73675, 'sae_top_5_test_accuracy': 0.81325, 'sae_top_10_test_accuracy': 0.8445, 'sae_top_20_test_accuracy': 
0.8792500000000001, 'sae_top_50_test_accuracy': 0.9025000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'Helsinki-NLP/europarl_results', 'llm_test_accuracy': 
0.9994, 'llm_top_1_test_accuracy': 0.6443999999999999, 'llm_top_2_test_accuracy': 0.7837999999999999, 'llm_top_5_test_accuracy': 0.907, 'llm_top_10_test_accuracy': 0.9648, 
'llm_top_20_test_accuracy': 0.9895999999999999, 'llm_top_50_test_accuracy': 0.9978000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.957200038433075, 
'sae_top_1_test_accuracy': 0.6015999999999999, 'sae_top_2_test_accuracy': 0.6596, 'sae_top_5_test_accuracy': 0.7354, 'sae_top_10_test_accuracy': 0.7872, 'sae_top_20_test_accuracy': 
0.8442000000000001, 'sae_top_50_test_accuracy': 0.9116, 'sae_top_100_test_accuracy': None}], 'sae_bench_commit_hash': 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 
'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 
'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 
'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 
'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None},
'training results for layer 19': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000, 
'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info': 
{'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'unlearning evaluation results': 
{'eval_type_id': 'unlearning', 'eval_config': {'random_seed': 42, 'dataset_names': ['wmdp-bio', 'high_school_us_history', 'college_computer_science', 'high_school_geography', 
'human_aging'], 'intervention_method': 'clamp_feature_activation', 'retain_thresholds': [0.001, 0.01, 0.1, 0.5], 'n_features_list': [100, 200], 'multipliers': [25, 50, 100, 200], 
'dataset_size': 1024, 'seq_len': 1024, 'n_batch_loss_added': 50, 'target_metric': 'correct', 'save_metrics': True, 'model_name': 'google/gemma-2-2b-it', 'llm_batch_size': 32, 
'llm_dtype': 'bfloat16'}, 'eval_id': 'eefdda16-0d33-4876-a8a5-a6befe821e03', 'datetime_epoch_millis': 1738003893013, 'eval_result_metrics': {'unlearning': {'unlearning_score': 
0.0037453174591064453}}, 'eval_result_details': [], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 
'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 
'blocks.19.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 
'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 
'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}}
Description: Baseline results.
```

The SEARCH section must exactly match an existing block of lines including all white space, comments, indentation, docstrings, etc

# The other 1 SEARCH/REPLACE block were applied successfully.
Don't re-send them.
Just reply with fixed versions of the block above that failed to match.

Let me fix the SEARCH/REPLACE block for notes.txt. The issue was that I needed to exactly match the existing content:                                                                

notes.txt                                                                                                                                                                            

                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                      
 # Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders                                                                                        
 # Experiment description: 1. Implement adaptive orthogonality loss with controlled feature sharing                                                                                  
 2. Add batch-wise feature grouping with periodic updates                                                                                                                            
 3. Train on Pythia-70M using WMDP-bio and WikiText datasets                                                                                                                         
 4. Compare unlearning performance against baseline and fixed orthogonal SAE                                                                                                         
 5. Analyze condition numbers of feature subspaces                                                                                                                                   
 6. Evaluate impact of different α values for controlled sharing                                                                                                                     
 ## Run 0: Baseline                                                                                                                                                                  
 Results: {'training results': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000,      
 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info':       
 {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'core evaluation results':          
 {'unique_id': 'google/gemma-2-2b_layer_19_sae_custom_sae', 'sae_set': 'google/gemma-2-2b_layer_19_sae', 'sae_id': 'custom_sae', 'eval_cfg': {'model_name': 'google/gemma-2-2b',     
 'llm_dtype': 'bfloat16', 'batch_size_prompts': 16, 'n_eval_reconstruction_batches': 200, 'n_eval_sparsity_variance_batches': 2000, 'dataset': 'Skylion007/openwebtext',             
 'context_size': 128, 'compute_kl': True, 'compute_ce_loss': True, 'compute_l2_norms': True, 'compute_sparsity_metrics': True, 'compute_variance_metrics': True,                     
 'compute_featurewise_density_statistics': False, 'compute_featurewise_weight_based_metrics': False, 'exclude_special_tokens_from_reconstruction': True, 'verbose': False}, 'metrics 
 {'model_behavior_preservation': {'kl_div_score': 0.7950310559006211, 'kl_div_with_ablation': 10.0625, 'kl_div_with_sae': 2.0625}, 'model_performance_preservation': {'ce_loss_score 
 0.7894736842105263, 'ce_loss_with_ablation': 12.4375, 'ce_loss_with_sae': 4.9375, 'ce_loss_without_sae': 2.9375}, 'reconstruction_quality': {'explained_variance': 0.30859375, 'mse 
 18.75, 'cossim': 0.76953125}, 'shrinkage': {'l2_norm_in': 308.0, 'l2_norm_out': 221.0, 'l2_ratio': 0.71484375, 'relative_reconstruction_bias': 0.93359375}, 'sparsity': {'l0':      
 85.21243286132812, 'l1': 458.0}, 'token_stats': {'total_tokens_eval_reconstruction': 409600, 'total_tokens_eval_sparsity_variance': 4096000}}}, 'scr and tpp evaluations results':  
 {'eval_type_id': 'scr', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'canrager/amazon_reviews_mcauley_1and5'], 'perform_scr': True,        
 'early_stopping_patience': 20, 'train_set_size': 4000, 'test_set_size': 1000, 'context_length': 128, 'probe_train_batch_size': 16, 'probe_test_batch_size': 500, 'probe_epochs': 20 
 'probe_lr': 0.001, 'probe_l1_penalty': 0.001, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'lower_vram_usage': False, 'model_name': 'google/gemma-2-2b',   
 'n_values': [2, 5, 10, 20, 50, 100, 500], 'column1_vals_lookup': {'LabHC/bias_in_bios_class_set1': [['professor', 'nurse'], ['architect', 'journalist'], ['surgeon', 'psychologist' 
 ['attorney', 'teacher']], 'canrager/amazon_reviews_mcauley_1and5': [['Books', 'CDs_and_Vinyl'], ['Software', 'Electronics'], ['Pet_Supplies', 'Office_Products'],                   
 ['Industrial_and_Scientific', 'Toys_and_Games']]}}, 'eval_id': 'c28f32b2-a72e-4f76-8d5a-85d6f9937f1b', 'datetime_epoch_millis': 1737884773606, 'eval_result_metrics': {'scr_metrics 
 {'scr_dir1_threshold_2': 0.035600906531669814, 'scr_metric_threshold_2': 0.019679524675140548, 'scr_dir2_threshold_2': 0.011514810160172787, 'scr_dir1_threshold_5':                
 0.051710736232558285, 'scr_metric_threshold_5': 0.06512155475350995, 'scr_dir2_threshold_5': 0.05295877346813508, 'scr_dir1_threshold_10': 0.077764577667114,                       
 'scr_metric_threshold_10': 0.08335696172542797, 'scr_dir2_threshold_10': 0.07006244094994978, 'scr_dir1_threshold_20': 0.07343213933631738, 'scr_metric_threshold_20':              
 0.08504280928786076, 'scr_dir2_threshold_20': 0.07359277159847097, 'scr_dir1_threshold_50': 0.03350340830709253, 'scr_metric_threshold_50': 0.08899691187101458,                    
 'scr_dir2_threshold_50': 0.07593742114240237, 'scr_dir1_threshold_100': -0.16207016165821828, 'scr_metric_threshold_100': 0.062236305245427885, 'scr_dir2_threshold_100':           
 0.052638407599727086, 'scr_dir1_threshold_500': -0.25156349364441777, 'scr_metric_threshold_500': 0.027887084742431078, 'scr_dir2_threshold_500': 0.004238511981040263}},           
 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_professor_nurse_results', 'scr_dir1_threshold_2': 0.03124962164991371, 'scr_metric_threshold_2':        
 0.012284998611665989, 'scr_dir2_threshold_2': 0.012284998611665989, 'scr_dir1_threshold_5': -0.015625742148246177, 'scr_metric_threshold_5': 0.05896816907447914,                   
 'scr_dir2_threshold_5': 0.05896816907447914, 'scr_dir1_threshold_10': -0.015625742148246177, 'scr_metric_threshold_10': 0.14987724667004865, 'scr_dir2_threshold_10':               
 0.14987724667004865, 'scr_dir1_threshold_20': -0.03125055297320303, 'scr_metric_threshold_20': 0.15479118753522092, 'scr_dir2_threshold_20': 0.15479118753522092,                   
 'scr_dir1_threshold_50': -0.2968760622906269, 'scr_metric_threshold_50': 0.16216224528171463, 'scr_dir2_threshold_50': 0.16216224528171463, 'scr_dir1_threshold_100':               
 -1.312501804438873, 'scr_metric_threshold_100': 0.14987724667004865, 'scr_dir2_threshold_100': 0.14987724667004865, 'scr_dir1_threshold_500': -1.3750019790619898,                  
 'scr_metric_threshold_500': 0.15724815796780706, 'scr_dir2_threshold_500': 0.15724815796780706}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_architect_journalist_results', 
 'scr_dir1_threshold_2': -0.08737868572318094, 'scr_metric_threshold_2': 0.034383855303823166, 'scr_dir2_threshold_2': 0.034383855303823166, 'scr_dir1_threshold_5':                 
 -0.10679649293164041, 'scr_metric_threshold_5': 0.06590258858377988, 'scr_dir2_threshold_5': 0.06590258858377988, 'scr_dir1_threshold_10': -0.11650510719289281,                    
 'scr_metric_threshold_10': 0.037249318901607584, 'scr_dir2_threshold_10': 0.037249318901607584, 'scr_dir1_threshold_20': -0.10679649293164041, 'scr_metric_threshold_20':           
 0.04011461171243302, 'scr_dir2_threshold_20': 0.04011461171243302, 'scr_dir1_threshold_50': -0.14563152866260468, 'scr_metric_threshold_50': 0.07449846701625619,                   
 'scr_dir2_threshold_50': 0.07449846701625619, 'scr_dir1_threshold_100': -0.14563152866260468, 'scr_metric_threshold_100': 0.10888249310703833, 'scr_dir2_threshold_100':            
 0.10888249310703833, 'scr_dir1_threshold_500': -0.3106797071617595, 'scr_metric_threshold_500': 0.0859598090465169, 'scr_dir2_threshold_500': 0.0859598090465169}, {'dataset_name': 
 'LabHC/bias_in_bios_class_set1_scr_surgeon_psychologist_results', 'scr_dir1_threshold_2': 0.015873751732555005, 'scr_metric_threshold_2': -0.0025316127159178037,                   
 'scr_dir2_threshold_2': -0.0025316127159178037, 'scr_dir1_threshold_5': 0.03174655735998827, 'scr_metric_threshold_5': -0.005063225431835607, 'scr_dir2_threshold_5':               
 -0.005063225431835607, 'scr_dir1_threshold_10': 0.0, 'scr_metric_threshold_10': 0.0075949890455728015, 'scr_dir2_threshold_10': 0.0075949890455728015, 'scr_dir1_threshold_20':     
 -0.0634921686148548, 'scr_metric_threshold_20': 0.02784819256855401, 'scr_dir2_threshold_20': 0.02784819256855401, 'scr_dir1_threshold_50': -0.1111105854971546,                    
 'scr_metric_threshold_50': 0.05316462152337083, 'scr_dir2_threshold_50': 0.05316462152337083, 'scr_dir1_threshold_100': -0.2222221170994309, 'scr_metric_threshold_100':            
 0.05316462152337083, 'scr_dir2_threshold_100': 0.05316462152337083, 'scr_dir1_threshold_500': -0.5714285714285714, 'scr_metric_threshold_500': 0.055696234239288635,                
 'scr_dir2_threshold_500': 0.055696234239288635}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_attorney_teacher_results', 'scr_dir1_threshold_2': 0.0,                        
 'scr_metric_threshold_2': 0.020771598900727672, 'scr_dir2_threshold_2': 0.020771598900727672, 'scr_dir1_threshold_5': 0.0, 'scr_metric_threshold_5': 0.1246292396676148,            
 'scr_dir2_threshold_5': 0.1246292396676148, 'scr_dir1_threshold_10': -0.007812398136610098, 'scr_metric_threshold_10': 0.10089032002917621, 'scr_dir2_threshold_10':                
 0.10089032002917621, 'scr_dir1_threshold_20': 0.10156257275956422, 'scr_metric_threshold_20': 0.0890208602099569, 'scr_dir2_threshold_20': 0.0890208602099569,                      
 'scr_dir1_threshold_50': 0.10156257275956422, 'scr_metric_threshold_50': 0.11869442132381734, 'scr_dir2_threshold_50': 0.11869442132381734, 'scr_dir1_threshold_100':               
 -0.17187462165026607, 'scr_metric_threshold_100': 0.10979228224230897, 'scr_dir2_threshold_100': 0.10979228224230897, 'scr_dir1_threshold_500': -0.16406222351365599,               
 'scr_metric_threshold_500': 0.06824926130922924, 'scr_dir2_threshold_500': 0.06824926130922924}, {'dataset_name':                                                                   
 'canrager/amazon_reviews_mcauley_1and5_scr_Books_CDs_and_Vinyl_results', 'scr_dir1_threshold_2': -0.06010915791026799, 'scr_metric_threshold_2': -0.015686069182044467,             
 'scr_dir2_threshold_2': -0.015686069182044467, 'scr_dir1_threshold_5': -0.01092881936245188, 'scr_metric_threshold_5': 0.07450976358933016, 'scr_dir2_threshold_5':                 
 0.07450976358933016, 'scr_dir1_threshold_10': 0.27322406685360157, 'scr_metric_threshold_10': 0.10588236944072857, 'scr_dir2_threshold_10': 0.10588236944072857,                    
 'scr_dir1_threshold_20': 0.24043695734946327, 'scr_metric_threshold_20': 0.08235303192400713, 'scr_dir2_threshold_20': 0.08235303192400713, 'scr_dir1_threshold_50':                
 0.3005464409681226, 'scr_metric_threshold_50': 0.039215874186075375, 'scr_dir2_threshold_50': 0.039215874186075375, 'scr_dir1_threshold_100': 0.2568305121015324,                   
 'scr_metric_threshold_100': 0.06274521170279682, 'scr_dir2_threshold_100': 0.06274521170279682, 'scr_dir1_threshold_500': 0.21311458323494226, 'scr_metric_threshold_500':          
 -0.14901952717866032, 'scr_dir2_threshold_500': -0.14901952717866032}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Software_Electronics_results',                   
 'scr_dir1_threshold_2': 0.158974152062764, 'scr_metric_threshold_2': 0.05241939554166917, 'scr_dir2_threshold_2': 0.05241939554166917, 'scr_dir1_threshold_5': 0.17948701489841076, 
 'scr_metric_threshold_5': 0.07258066454365199, 'scr_dir2_threshold_5': 0.07258066454365199, 'scr_dir1_threshold_10': 0.18461515419110838, 'scr_metric_threshold_10':                
 0.10483879108333834, 'scr_dir2_threshold_10': 0.10483879108333834, 'scr_dir1_threshold_20': 0.17435887560571312, 'scr_metric_threshold_20': 0.11693564862104187,                    
 'scr_dir2_threshold_20': 0.11693564862104187, 'scr_dir1_threshold_50': 0.2102561563194528, 'scr_metric_threshold_50': 0.10887099681547797, 'scr_dir2_threshold_50':                 
 0.10887099681547797, 'scr_dir1_threshold_100': 0.19487173844135988, 'scr_metric_threshold_100': -0.07258066454365199, 'scr_dir2_threshold_100': -0.07258066454365199,               
 'scr_dir1_threshold_500': 0.16410229135546164, 'scr_metric_threshold_500': -0.12499981974403652, 'scr_dir2_threshold_500': -0.12499981974403652}, {'dataset_name':                  
 'canrager/amazon_reviews_mcauley_1and5_scr_Pet_Supplies_Office_Products_results', 'scr_dir1_threshold_2': 0.17040353950037407, 'scr_metric_threshold_2': 0.0, 'scr_dir2_threshold_2 
 0.0, 'scr_dir1_threshold_5': 0.22421531016200436, 'scr_metric_threshold_5': 0.017857176118657926, 'scr_dir2_threshold_5': 0.017857176118657926, 'scr_dir1_threshold_10':            
 0.18834079638758416, 'scr_metric_threshold_10': 0.04464280725058454, 'scr_dir2_threshold_10': 0.04464280725058454, 'scr_dir1_threshold_20': 0.15246628261316397,                    
 'scr_metric_threshold_20': 0.04910730084933944, 'scr_dir2_threshold_20': 0.04910730084933944, 'scr_dir1_threshold_50': 0.0762330076638747, 'scr_metric_threshold_50':               
 0.02232140362529227, 'scr_dir2_threshold_50': 0.02232140362529227, 'scr_dir1_threshold_100': 0.02242150428765898, 'scr_metric_threshold_100': 0.0044642275066343415,                
 'scr_dir2_threshold_100': 0.0044642275066343415, 'scr_dir1_threshold_500': -0.06726478014839152, 'scr_metric_threshold_500': 0.03125012473068151, 'scr_dir2_threshold_500':         
 0.03125012473068151}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Industrial_and_Scientific_Toys_and_Games_results', 'scr_dir1_threshold_2': 0.05579403094120067,   
 'scr_metric_threshold_2': 0.05579403094120067, 'scr_dir2_threshold_2': -0.009523685178541423, 'scr_dir1_threshold_5': 0.11158806188240133, 'scr_metric_threshold_5':                
 0.11158806188240133, 'scr_dir2_threshold_5': 0.014285811599402364, 'scr_dir1_threshold_10': 0.11587985138236706, 'scr_metric_threshold_10': 0.11587985138236706,                    
 'scr_dir2_threshold_10': 0.009523685178541423, 'scr_dir1_threshold_20': 0.12017164088233277, 'scr_metric_threshold_20': 0.12017164088233277, 'scr_dir2_threshold_20':               
 0.0285713393672145, 'scr_dir1_threshold_50': 0.13304726519611204, 'scr_metric_threshold_50': 0.13304726519611204, 'scr_dir2_threshold_50': 0.0285713393672145,                      
 'scr_dir1_threshold_100': 0.08154502375487709, 'scr_metric_threshold_100': 0.08154502375487709, 'scr_dir2_threshold_100': 0.004761842589270712, 'scr_dir1_threshold_500':           
 0.09871243756862208, 'scr_metric_threshold_500': 0.09871243756862208, 'scr_dir2_threshold_500': -0.09047614452250444}], 'sae_bench_commit_hash':                                    
 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict':      
 {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None,         
 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none',       
 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None,    
 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'absorption evaluation results': {'eval_type_id': 'absorption_first_letter', 'eval_config': {'model_name':              
 'google/gemma-2-2b', 'random_seed': 42, 'f1_jump_threshold': 0.03, 'max_k_value': 10, 'prompt_template': '{word} has the first letter:', 'prompt_token_pos': -6, 'llm_batch_size':  
 32, 'llm_dtype': 'bfloat16', 'k_sparse_probe_l1_decay': 0.01, 'k_sparse_probe_batch_size': 4096, 'k_sparse_probe_num_epochs': 50}, 'eval_id': '515e7b3b-6b86-4214-aa0d-c2ef123e2969 
 'datetime_epoch_millis': 1737999200566, 'eval_result_metrics': {'mean': {'mean_absorption_score': 0.010124895517470242, 'mean_num_split_features': 1.2}}, 'eval_result_details':    
 [{'first_letter': 'a', 'absorption_rate': 0.00986971969996052, 'num_absorption': 25, 'num_probe_true_positives': 2533, 'num_split_features': 1}, {'first_letter': 'b',              
 'absorption_rate': 0.005050505050505051, 'num_absorption': 8, 'num_probe_true_positives': 1584, 'num_split_features': 1}, {'first_letter': 'c', 'absorption_rate':                  
 0.02792890823358723, 'num_absorption': 77, 'num_probe_true_positives': 2757, 'num_split_features': 1}, {'first_letter': 'd', 'absorption_rate': 0.008631319358816275,               
 'num_absorption': 14, 'num_probe_true_positives': 1622, 'num_split_features': 1}, {'first_letter': 'e', 'absorption_rate': 0.002523659305993691, 'num_absorption': 4,               
 'num_probe_true_positives': 1585, 'num_split_features': 1}, {'first_letter': 'f', 'absorption_rate': 0.004942339373970346, 'num_absorption': 6, 'num_probe_true_positives': 1214,   
 'num_split_features': 1}, {'first_letter': 'g', 'absorption_rate': 0.0026362038664323375, 'num_absorption': 3, 'num_probe_true_positives': 1138, 'num_split_features': 1},          
 {'first_letter': 'h', 'absorption_rate': 0.08004158004158005, 'num_absorption': 77, 'num_probe_true_positives': 962, 'num_split_features': 1}, {'first_letter': 'i',                
 'absorption_rate': 0.007402837754472548, 'num_absorption': 12, 'num_probe_true_positives': 1621, 'num_split_features': 2}, {'first_letter': 'j', 'absorption_rate':                 
 0.03546099290780142, 'num_absorption': 15, 'num_probe_true_positives': 423, 'num_split_features': 1}, {'first_letter': 'k', 'absorption_rate': 0.001557632398753894,                
 'num_absorption': 1, 'num_probe_true_positives': 642, 'num_split_features': 1}, {'first_letter': 'l', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 1196 
 'num_split_features': 1}, {'first_letter': 'm', 'absorption_rate': 0.0060406370126304225, 'num_absorption': 11, 'num_probe_true_positives': 1821, 'num_split_features': 1},         
 {'first_letter': 'n', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 845, 'num_split_features': 1}, {'first_letter': 'o', 'absorption_rate':              
 0.007070707070707071, 'num_absorption': 7, 'num_probe_true_positives': 990, 'num_split_features': 1}, {'first_letter': 'p', 'absorption_rate': 0.0004332755632582322,               
 'num_absorption': 1, 'num_probe_true_positives': 2308, 'num_split_features': 2}, {'first_letter': 'q', 'absorption_rate': 0.011428571428571429, 'num_absorption': 2,                
 'num_probe_true_positives': 175, 'num_split_features': 1}, {'first_letter': 'r', 'absorption_rate': 0.006053268765133172, 'num_absorption': 10, 'num_probe_true_positives': 1652,   
 'num_split_features': 2}, {'first_letter': 's', 'absorption_rate': 0.005263157894736842, 'num_absorption': 15, 'num_probe_true_positives': 2850, 'num_split_features': 1},          
 {'first_letter': 't', 'absorption_rate': 0.00357355568790947, 'num_absorption': 6, 'num_probe_true_positives': 1679, 'num_split_features': 2}, {'first_letter': 'u',                
 'absorption_rate': 0.0013297872340425532, 'num_absorption': 1, 'num_probe_true_positives': 752, 'num_split_features': 2}, {'first_letter': 'v', 'absorption_rate':                  
 0.0012738853503184713, 'num_absorption': 1, 'num_probe_true_positives': 785, 'num_split_features': 1}, {'first_letter': 'w', 'absorption_rate': 0.004201680672268907,               
 'num_absorption': 3, 'num_probe_true_positives': 714, 'num_split_features': 1}, {'first_letter': 'y', 'absorption_rate': 0.02040816326530612, 'num_absorption': 3,                  
 'num_probe_true_positives': 147, 'num_split_features': 1}, {'first_letter': 'z', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 230, 'num_split_features' 
 1}], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': 
 '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None,         
 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True                
                                                                                                                                                                                     
Let me fix the SEARCH/REPLACE block for notes.txt. The issue was that I needed to exactly match the existing content:                                                                

notes.txt                                                                                                                                                                            

                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                      
 # Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders                                                                                        
 # Experiment description: 1. Implement adaptive orthogonality loss with controlled feature sharing                                                                                  
 2. Add batch-wise feature grouping with periodic updates                                                                                                                            
 3. Train on Pythia-70M using WMDP-bio and WikiText datasets                                                                                                                         
 4. Compare unlearning performance against baseline and fixed orthogonal SAE                                                                                                         
 5. Analyze condition numbers of feature subspaces                                                                                                                                   
 6. Evaluate impact of different α values for controlled sharing                                                                                                                     
 ## Run 0: Baseline                                                                                                                                                                  
 Results: {'training results': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000,      
 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info':       
 {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'core evaluation results':          
 {'unique_id': 'google/gemma-2-2b_layer_19_sae_custom_sae', 'sae_set': 'google/gemma-2-2b_layer_19_sae', 'sae_id': 'custom_sae', 'eval_cfg': {'model_name': 'google/gemma-2-2b',     
 'llm_dtype': 'bfloat16', 'batch_size_prompts': 16, 'n_eval_reconstruction_batches': 200, 'n_eval_sparsity_variance_batches': 2000, 'dataset': 'Skylion007/openwebtext',             
 'context_size': 128, 'compute_kl': True, 'compute_ce_loss': True, 'compute_l2_norms': True, 'compute_sparsity_metrics': True, 'compute_variance_metrics': True,                     
 'compute_featurewise_density_statistics': False, 'compute_featurewise_weight_based_metrics': False, 'exclude_special_tokens_from_reconstruction': True, 'verbose': False}, 'metrics 
 {'model_behavior_preservation': {'kl_div_score': 0.7950310559006211, 'kl_div_with_ablation': 10.0625, 'kl_div_with_sae': 2.0625}, 'model_performance_preservation': {'ce_loss_score 
 0.7894736842105263, 'ce_loss_with_ablation': 12.4375, 'ce_loss_with_sae': 4.9375, 'ce_loss_without_sae': 2.9375}, 'reconstruction_quality': {'explained_variance': 0.30859375, 'mse 
 18.75, 'cossim': 0.76953125}, 'shrinkage': {'l2_norm_in': 308.0, 'l2_norm_out': 221.0, 'l2_ratio': 0.71484375, 'relative_reconstruction_bias': 0.93359375}, 'sparsity': {'l0':      
 85.21243286132812, 'l1': 458.0}, 'token_stats': {'total_tokens_eval_reconstruction': 409600, 'total_tokens_eval_sparsity_variance': 4096000}}}, 'scr and tpp evaluations results':  
 {'eval_type_id': 'scr', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'canrager/amazon_reviews_mcauley_1and5'], 'perform_scr': True,        
 'early_stopping_patience': 20, 'train_set_size': 4000, 'test_set_size': 1000, 'context_length': 128, 'probe_train_batch_size': 16, 'probe_test_batch_size': 500, 'probe_epochs': 20 
 'probe_lr': 0.001, 'probe_l1_penalty': 0.001, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'lower_vram_usage': False, 'model_name': 'google/gemma-2-2b',   
 'n_values': [2, 5, 10, 20, 50, 100, 500], 'column1_vals_lookup': {'LabHC/bias_in_bios_class_set1': [['professor', 'nurse'], ['architect', 'journalist'], ['surgeon', 'psychologist' 
 ['attorney', 'teacher']], 'canrager/amazon_reviews_mcauley_1and5': [['Books', 'CDs_and_Vinyl'], ['Software', 'Electronics'], ['Pet_Supplies', 'Office_Products'],                   
 ['Industrial_and_Scientific', 'Toys_and_Games']]}}, 'eval_id': 'c28f32b2-a72e-4f76-8d5a-85d6f9937f1b', 'datetime_epoch_millis': 1737884773606, 'eval_result_metrics': {'scr_metrics 
 {'scr_dir1_threshold_2': 0.035600906531669814, 'scr_metric_threshold_2': 0.019679524675140548, 'scr_dir2_threshold_2': 0.011514810160172787, 'scr_dir1_threshold_5':                
 0.051710736232558285, 'scr_metric_threshold_5': 0.06512155475350995, 'scr_dir2_threshold_5': 0.05295877346813508, 'scr_dir1_threshold_10': 0.077764577667114,                       
 'scr_metric_threshold_10': 0.08335696172542797, 'scr_dir2_threshold_10': 0.07006244094994978, 'scr_dir1_threshold_20': 0.07343213933631738, 'scr_metric_threshold_20':              
 0.08504280928786076, 'scr_dir2_threshold_20': 0.07359277159847097, 'scr_dir1_threshold_50': 0.03350340830709253, 'scr_metric_threshold_50': 0.08899691187101458,                    
 'scr_dir2_threshold_50': 0.07593742114240237, 'scr_dir1_threshold_100': -0.16207016165821828, 'scr_metric_threshold_100': 0.062236305245427885, 'scr_dir2_threshold_100':           
 0.052638407599727086, 'scr_dir1_threshold_500': -0.25156349364441777, 'scr_metric_threshold_500': 0.027887084742431078, 'scr_dir2_threshold_500': 0.004238511981040263}},           
 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_professor_nurse_results', 'scr_dir1_threshold_2': 0.03124962164991371, 'scr_metric_threshold_2':        
 0.012284998611665989, 'scr_dir2_threshold_2': 0.012284998611665989, 'scr_dir1_threshold_5': -0.015625742148246177, 'scr_metric_threshold_5': 0.05896816907447914,                   
 'scr_dir2_threshold_5': 0.05896816907447914, 'scr_dir1_threshold_10': -0.015625742148246177, 'scr_metric_threshold_10': 0.14987724667004865, 'scr_dir2_threshold_10':               
 0.14987724667004865, 'scr_dir1_threshold_20': -0.03125055297320303, 'scr_metric_threshold_20': 0.15479118753522092, 'scr_dir2_threshold_20': 0.15479118753522092,                   
 'scr_dir1_threshold_50': -0.2968760622906269, 'scr_metric_threshold_50': 0.16216224528171463, 'scr_dir2_threshold_50': 0.16216224528171463, 'scr_dir1_threshold_100':               
 -1.312501804438873, 'scr_metric_threshold_100': 0.14987724667004865, 'scr_dir2_threshold_100': 0.14987724667004865, 'scr_dir1_threshold_500': -1.3750019790619898,                  
 'scr_metric_threshold_500': 0.15724815796780706, 'scr_dir2_threshold_500': 0.15724815796780706}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_architect_journalist_results', 
 'scr_dir1_threshold_2': -0.08737868572318094, 'scr_metric_threshold_2': 0.034383855303823166, 'scr_dir2_threshold_2': 0.034383855303823166, 'scr_dir1_threshold_5':                 
 -0.10679649293164041, 'scr_metric_threshold_5': 0.06590258858377988, 'scr_dir2_threshold_5': 0.06590258858377988, 'scr_dir1_threshold_10': -0.11650510719289281,                    
 'scr_metric_threshold_10': 0.037249318901607584, 'scr_dir2_threshold_10': 0.037249318901607584, 'scr_dir1_threshold_20': -0.10679649293164041, 'scr_metric_threshold_20':           
 0.04011461171243302, 'scr_dir2_threshold_20': 0.04011461171243302, 'scr_dir1_threshold_50': -0.14563152866260468, 'scr_metric_threshold_50': 0.07449846701625619,                   
 'scr_dir2_threshold_50': 0.07449846701625619, 'scr_dir1_threshold_100': -0.14563152866260468, 'scr_metric_threshold_100': 0.10888249310703833, 'scr_dir2_threshold_100':            
 0.10888249310703833, 'scr_dir1_threshold_500': -0.3106797071617595, 'scr_metric_threshold_500': 0.0859598090465169, 'scr_dir2_threshold_500': 0.0859598090465169}, {'dataset_name': 
 'LabHC/bias_in_bios_class_set1_scr_surgeon_psychologist_results', 'scr_dir1_threshold_2': 0.015873751732555005, 'scr_metric_threshold_2': -0.0025316127159178037,                   
 'scr_dir2_threshold_2': -0.0025316127159178037, 'scr_dir1_threshold_5': 0.03174655735998827, 'scr_metric_threshold_5': -0.005063225431835607, 'scr_dir2_threshold_5':               
 -0.005063225431835607, 'scr_dir1_threshold_10': 0.0, 'scr_metric_threshold_10': 0.0075949890455728015, 'scr_dir2_threshold_10': 0.0075949890455728015, 'scr_dir1_threshold_20':     
 -0.0634921686148548, 'scr_metric_threshold_20': 0.02784819256855401, 'scr_dir2_threshold_20': 0.02784819256855401, 'scr_dir1_threshold_50': -0.1111105854971546,                    
 'scr_metric_threshold_50': 0.05316462152337083, 'scr_dir2_threshold_50': 0.05316462152337083, 'scr_dir1_threshold_100': -0.2222221170994309, 'scr_metric_threshold_100':            
 0.05316462152337083, 'scr_dir2_threshold_100': 0.05316462152337083, 'scr_dir1_threshold_500': -0.5714285714285714, 'scr_metric_threshold_500': 0.055696234239288635,                
 'scr_dir2_threshold_500': 0.055696234239288635}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_attorney_teacher_results', 'scr_dir1_threshold_2': 0.0,                        
 'scr_metric_threshold_2': 0.020771598900727672, 'scr_dir2_threshold_2': 0.020771598900727672, 'scr_dir1_threshold_5': 0.0, 'scr_metric_threshold_5': 0.1246292396676148,            
 'scr_dir2_threshold_5': 0.1246292396676148, 'scr_dir1_threshold_10': -0.007812398136610098, 'scr_metric_threshold_10': 0.10089032002917621, 'scr_dir2_threshold_10':                
 0.10089032002917621, 'scr_dir1_threshold_20': 0.10156257275956422, 'scr_metric_threshold_20': 0.0890208602099569, 'scr_dir2_threshold_20': 0.0890208602099569,                      
 'scr_dir1_threshold_50': 0.10156257275956422, 'scr_metric_threshold_50': 0.11869442132381734, 'scr_dir2_threshold_50': 0.11869442132381734, 'scr_dir1_threshold_100':               
 -0.17187462165026607, 'scr_metric_threshold_100': 0.10979228224230897, 'scr_dir2_threshold_100': 0.10979228224230897, 'scr_dir1_threshold_500': -0.16406222351365599,               
 'scr_metric_threshold_500': 0.06824926130922924, 'scr_dir2_threshold_500': 0.06824926130922924}, {'dataset_name':                                                                   
 'canrager/amazon_reviews_mcauley_1and5_scr_Books_CDs_and_Vinyl_results', 'scr_dir1_threshold_2': -0.06010915791026799, 'scr_metric_threshold_2': -0.015686069182044467,             
 'scr_dir2_threshold_2': -0.015686069182044467, 'scr_dir1_threshold_5': -0.01092881936245188, 'scr_metric_threshold_5': 0.07450976358933016, 'scr_dir2_threshold_5':                 
 0.07450976358933016, 'scr_dir1_threshold_10': 0.27322406685360157, 'scr_metric_threshold_10': 0.10588236944072857, 'scr_dir2_threshold_10': 0.10588236944072857,                    
 'scr_dir1_threshold_20': 0.24043695734946327, 'scr_metric_threshold_20': 0.08235303192400713, 'scr_dir2_threshold_20': 0.08235303192400713, 'scr_dir1_threshold_50':                
 0.3005464409681226, 'scr_metric_threshold_50': 0.039215874186075375, 'scr_dir2_threshold_50': 0.039215874186075375, 'scr_dir1_threshold_100': 0.2568305121015324,                   
 'scr_metric_threshold_100': 0.06274521170279682, 'scr_dir2_threshold_100': 0.06274521170279682, 'scr_dir1_threshold_500': 0.21311458323494226, 'scr_metric_threshold_500':          
 -0.14901952717866032, 'scr_dir2_threshold_500': -0.14901952717866032}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Software_Electronics_results',                   
 'scr_dir1_threshold_2': 0.158974152062764, 'scr_metric_threshold_2': 0.05241939554166917, 'scr_dir2_threshold_2': 0.05241939554166917, 'scr_dir1_threshold_5': 0.17948701489841076, 
 'scr_metric_threshold_5': 0.07258066454365199, 'scr_dir2_threshold_5': 0.07258066454365199, 'scr_dir1_threshold_10': 0.18461515419110838, 'scr_metric_threshold_10':                
 0.10483879108333834, 'scr_dir2_threshold_10': 0.10483879108333834, 'scr_dir1_threshold_20': 0.17435887560571312, 'scr_metric_threshold_20': 0.11693564862104187,                    
 'scr_dir2_threshold_20': 0.11693564862104187, 'scr_dir1_threshold_50': 0.2102561563194528, 'scr_metric_threshold_50': 0.10887099681547797, 'scr_dir2_threshold_50':                 
 0.10887099681547797, 'scr_dir1_threshold_100': 0.19487173844135988, 'scr_metric_threshold_100': -0.07258066454365199, 'scr_dir2_threshold_100': -0.07258066454365199,               
 'scr_dir1_threshold_500': 0.16410229135546164, 'scr_metric_threshold_500': -0.12499981974403652, 'scr_dir2_threshold_500': -0.12499981974403652}, {'dataset_name':                  
 'canrager/amazon_reviews_mcauley_1and5_scr_Pet_Supplies_Office_Products_results', 'scr_dir1_threshold_2': 0.17040353950037407, 'scr_metric_threshold_2': 0.0, 'scr_dir2_threshold_2 
 0.0, 'scr_dir1_threshold_5': 0.22421531016200436, 'scr_metric_threshold_5': 0.017857176118657926, 'scr_dir2_threshold_5': 0.017857176118657926, 'scr_dir1_threshold_10':            
 0.18834079638758416, 'scr_metric_threshold_10': 0.04464280725058454, 'scr_dir2_threshold_10': 0.04464280725058454, 'scr_dir1_threshold_20': 0.15246628261316397,                    
 'scr_metric_threshold_20': 0.04910730084933944, 'scr_dir2_threshold_20': 0.04910730084933944, 'scr_dir1_threshold_50': 0.0762330076638747, 'scr_metric_threshold_50':               
 0.02232140362529227, 'scr_dir2_threshold_50': 0.02232140362529227, 'scr_dir1_threshold_100': 0.02242150428765898, 'scr_metric_threshold_100': 0.0044642275066343415,                
 'scr_dir2_threshold_100': 0.0044642275066343415, 'scr_dir1_threshold_500': -0.06726478014839152, 'scr_metric_threshold_500': 0.03125012473068151, 'scr_dir2_threshold_500':         
 0.03125012473068151}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Industrial_and_Scientific_Toys_and_Games_results', 'scr_dir1_threshold_2': 0.05579403094120067,   
 'scr_metric_threshold_2': 0.05579403094120067, 'scr_dir2_threshold_2': -0.009523685178541423, 'scr_dir1_threshold_5': 0.11158806188240133, 'scr_metric_threshold_5':                
 0.11158806188240133, 'scr_dir2_threshold_5': 0.014285811599402364, 'scr_dir1_threshold_10': 0.11587985138236706, 'scr_metric_threshold_10': 0.11587985138236706,                    
 'scr_dir2_threshold_10': 0.009523685178541423, 'scr_dir1_threshold_20': 0.12017164088233277, 'scr_metric_threshold_20': 0.12017164088233277, 'scr_dir2_threshold_20':               
 0.0285713393672145, 'scr_dir1_threshold_50': 0.13304726519611204, 'scr_metric_threshold_50': 0.13304726519611204, 'scr_dir2_threshold_50': 0.0285713393672145,                      
 'scr_dir1_threshold_100': 0.08154502375487709, 'scr_metric_threshold_100': 0.08154502375487709, 'scr_dir2_threshold_100': 0.004761842589270712, 'scr_dir1_threshold_500':           
 0.09871243756862208, 'scr_metric_threshold_500': 0.09871243756862208, 'scr_dir2_threshold_500': -0.09047614452250444}], 'sae_bench_commit_hash':                                    
 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict':      
 {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None,         
 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none',       
 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None,    
 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'absorption evaluation results': {'eval_type_id': 'absorption_first_letter', 'eval_config': {'model_name':              
 'google/gemma-2-2b', 'random_seed': 42, 'f1_jump_threshold': 0.03, 'max_k_value': 10, 'prompt_template': '{word} has the first letter:', 'prompt_token_pos': -6, 'llm_batch_size':  
 32, 'llm_dtype': 'bfloat16', 'k_sparse_probe_l1_decay': 0.01, 'k_sparse_probe_batch_size': 4096, 'k_sparse_probe_num_epochs': 50}, 'eval_id': '515e7b3b-6b86-4214-aa0d-c2ef123e2969 
 'datetime_epoch_millis': 1737999200566, 'eval_result_metrics': {'mean': {'mean_absorption_score': 0.010124895517470242, 'mean_num_split_features': 1.2}}, 'eval_result_details':    
 [{'first_letter': 'a', 'absorption_rate': 0.00986971969996052, 'num_absorption': 25, 'num_probe_true_positives': 2533, 'num_split_features': 1}, {'first_letter': 'b',              
 'absorption_rate': 0.005050505050505051, 'num_absorption': 8, 'num_probe_true_positives': 1584, 'num_split_features': 1}, {'first_letter': 'c', 'absorption_rate':                  
 0.02792890823358723, 'num_absorption': 77, 'num_probe_true_positives': 2757, 'num_split_features': 1}, {'first_letter': 'd', 'absorption_rate': 0.008631319358816275,               
 'num_absorption': 14, 'num_probe_true_positives': 1622, 'num_split_features': 1}, {'first_letter': 'e', 'absorption_rate': 0.002523659305993691, 'num_absorption': 4,               
 'num_probe_true_positives': 1585, 'num_split_features': 1}, {'first_letter': 'f', 'absorption_rate': 0.004942339373970346, 'num_absorption': 6, 'num_probe_true_positives': 1214,   
 'num_split_features': 1}, {'first_letter': 'g', 'absorption_rate': 0.0026362038664323375, 'num_absorption': 3, 'num_probe_true_positives': 1138, 'num_split_features': 1},          
 {'first_letter': 'h', 'absorption_rate': 0.08004158004158005, 'num_absorption': 77, 'num_probe_true_positives': 962, 'num_split_features': 1}, {'first_letter': 'i',                
 'absorption_rate': 0.007402837754472548, 'num_absorption': 12, 'num_probe_true_positives': 1621, 'num_split_features': 2}, {'first_letter': 'j', 'absorption_rate':                 
 0.03546099290780142, 'num_absorption': 15, 'num_probe_true_positives': 423, 'num_split_features': 1}, {'first_letter': 'k', 'absorption_rate': 0.001557632398753894,                
 'num_absorption': 1, 'num_probe_true_positives': 642, 'num_split_features': 1}, {'first_letter': 'l', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 1196 
 'num_split_features': 1}, {'first_letter': 'm', 'absorption_rate': 0.0060406370126304225, 'num_absorption': 11, 'num_probe_true_positives': 1821, 'num_split_features': 1},         
 {'first_letter': 'n', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 845, 'num_split_features': 1}, {'first_letter': 'o', 'absorption_rate':              
 0.007070707070707071, 'num_absorption': 7, 'num_probe_true_positives': 990, 'num_split_features': 1}, {'first_letter': 'p', 'absorption_rate': 0.0004332755632582322,               
 'num_absorption': 1, 'num_probe_true_positives': 2308, 'num_split_features': 2}, {'first_letter': 'q', 'absorption_rate': 0.011428571428571429, 'num_absorption': 2,                
 'num_probe_true_positives': 175, 'num_split_features': 1}, {'first_letter': 'r', 'absorption_rate': 0.006053268765133172, 'num_absorption': 10, 'num_probe_true_positives': 1652,   
 'num_split_features': 2}, {'first_letter': 's', 'absorption_rate': 0.005263157894736842, 'num_absorption': 15, 'num_probe_true_positives': 2850, 'num_split_features': 1},          
 {'first_letter': 't', 'absorption_rate': 0.00357355568790947, 'num_absorption': 6, 'num_probe_true_positives': 1679, 'num_split_features': 2}, {'first_letter': 'u',                
 'absorption_rate': 0.0013297872340425532, 'num_absorption': 1, 'num_probe_true_positives': 752, 'num_split_features': 2}, {'first_letter': 'v', 'absorption_rate':                  
 0.0012738853503184713, 'num_absorption': 1, 'num_probe_true_positives': 785, 'num_split_features': 1}, {'first_letter': 'w', 'absorption_rate': 0.004201680672268907,               
 'num_absorption': 3, 'num_probe_true_positives': 714, 'num_split_features': 1}, {'first_letter': 'y', 'absorption_rate': 0.02040816326530612, 'num_absorption': 3,                  
 'num_probe_true_positives': 147, 'num_split_features': 1}, {'first_letter': 'z', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 230, 'num_split_features' 
 1}], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': 
 '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None,         
 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True,               
 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000,      
 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'sparse probing evaluation results': {'eval_type_id': 'sparse_probing', 'eval_config 
 {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'LabHC/bias_in_bios_class_set2', 'LabHC/bias_in_bios_class_set3', 'canrager/amazon_reviews_mcauley_1and5',   
 'canrager/amazon_reviews_mcauley_1and5_sentiment', 'codeparrot/github-code', 'fancyzhx/ag_news', 'Helsinki-NLP/europarl'], 'probe_train_set_size': 4000, 'probe_test_set_size': 100 
 'context_length': 128, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'model_name': 'google/gemma-2-2b', 'k_values': [1, 2, 5, 10, 20, 50],                  
 'lower_vram_usage': False}, 'eval_id': 'fddb5e3e-09c2-4d2c-b7ac-9077585d20ec', 'datetime_epoch_millis': 1737900662632, 'eval_result_metrics': {'llm': {'llm_test_accuracy':         
 0.9505874999999999, 'llm_top_1_test_accuracy': 0.6539375, 'llm_top_2_test_accuracy': 0.7235875, 'llm_top_5_test_accuracy': 0.7815, 'llm_top_10_test_accuracy': 0.8289187499999999,  
 'llm_top_20_test_accuracy': 0.8770187500000001, 'llm_top_50_test_accuracy': 0.9236000000000001, 'llm_top_100_test_accuracy': None}, 'sae': {'sae_test_accuracy': 0.9151000421494245 
 'sae_top_1_test_accuracy': 0.6601812499999999, 'sae_top_2_test_accuracy': 0.70936875, 'sae_top_5_test_accuracy': 0.7653812499999999, 'sae_top_10_test_accuracy': 0.8049125000000001 
 'sae_top_20_test_accuracy': 0.84908125, 'sae_top_50_test_accuracy': 0.8829625, 'sae_top_100_test_accuracy': None}}, 'eval_result_details': [{'dataset_name':                        
 'LabHC/bias_in_bios_class_set1_results', 'llm_test_accuracy': 0.9596, 'llm_top_1_test_accuracy': 0.6432, 'llm_top_2_test_accuracy': 0.6916, 'llm_top_5_test_accuracy': 0.7912,      
 'llm_top_10_test_accuracy': 0.8336, 'llm_top_20_test_accuracy': 0.8962, 'llm_top_50_test_accuracy': 0.9384, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy':                 
 0.9414000391960144, 'sae_top_1_test_accuracy': 0.6437999999999999, 'sae_top_2_test_accuracy': 0.7016, 'sae_top_5_test_accuracy': 0.7776, 'sae_top_10_test_accuracy':                
 0.8150000000000001, 'sae_top_20_test_accuracy': 0.8516, 'sae_top_50_test_accuracy': 0.9064, 'sae_top_100_test_accuracy': None}, {'dataset_name':                                    
 'LabHC/bias_in_bios_class_set2_results', 'llm_test_accuracy': 0.9468, 'llm_top_1_test_accuracy': 0.6779999999999999, 'llm_top_2_test_accuracy': 0.7282, 'llm_top_5_test_accuracy':  
 0.77, 'llm_top_10_test_accuracy': 0.8024000000000001, 'llm_top_20_test_accuracy': 0.8596, 'llm_top_50_test_accuracy': 0.9076000000000001, 'llm_top_100_test_accuracy': None,        
 'sae_test_accuracy': 0.9112000346183777, 'sae_top_1_test_accuracy': 0.6588, 'sae_top_2_test_accuracy': 0.6958, 'sae_top_5_test_accuracy': 0.7487999999999999,                       
 'sae_top_10_test_accuracy': 0.8055999999999999, 'sae_top_20_test_accuracy': 0.849, 'sae_top_50_test_accuracy': 0.8788, 'sae_top_100_test_accuracy': None}, {'dataset_name':         
 'LabHC/bias_in_bios_class_set3_results', 'llm_test_accuracy': 0.914, 'llm_top_1_test_accuracy': 0.6888, 'llm_top_2_test_accuracy': 0.7322, 'llm_top_5_test_accuracy':               
 0.7544000000000001, 'llm_top_10_test_accuracy': 0.7958, 'llm_top_20_test_accuracy': 0.8518000000000001, 'llm_top_50_test_accuracy': 0.8942, 'llm_top_100_test_accuracy': None,      
 'sae_test_accuracy': 0.8954000353813172, 'sae_top_1_test_accuracy': 0.6872, 'sae_top_2_test_accuracy': 0.716, 'sae_top_5_test_accuracy': 0.7642, 'sae_top_10_test_accuracy': 0.8092 
 'sae_top_20_test_accuracy': 0.8370000000000001, 'sae_top_50_test_accuracy': 0.8684000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name':                                
 'canrager/amazon_reviews_mcauley_1and5_results', 'llm_test_accuracy': 0.897, 'llm_top_1_test_accuracy': 0.6003999999999999, 'llm_top_2_test_accuracy': 0.6422000000000001,          
 'llm_top_5_test_accuracy': 0.6752, 'llm_top_10_test_accuracy': 0.7379999999999999, 'llm_top_20_test_accuracy': 0.8098000000000001, 'llm_top_50_test_accuracy': 0.8640000000000001,  
 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.8272000432014466, 'sae_top_1_test_accuracy': 0.5764000000000001, 'sae_top_2_test_accuracy': 0.5928,                       
 'sae_top_5_test_accuracy': 0.6258, 'sae_top_10_test_accuracy': 0.6836, 'sae_top_20_test_accuracy': 0.76, 'sae_top_50_test_accuracy': 0.7934, 'sae_top_100_test_accuracy': None},    
 {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_sentiment_results', 'llm_test_accuracy': 0.9815, 'llm_top_1_test_accuracy': 0.671, 'llm_top_2_test_accuracy': 0.724,        
 'llm_top_5_test_accuracy': 0.766, 'llm_top_10_test_accuracy': 0.826, 'llm_top_20_test_accuracy': 0.847, 'llm_top_50_test_accuracy': 0.933, 'llm_top_100_test_accuracy': None,       
 'sae_test_accuracy': 0.9355000555515289, 'sae_top_1_test_accuracy': 0.797, 'sae_top_2_test_accuracy': 0.888, 'sae_top_5_test_accuracy': 0.893, 'sae_top_10_test_accuracy': 0.892,   
 'sae_top_20_test_accuracy': 0.916, 'sae_top_50_test_accuracy': 0.91, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'codeparrot/github-code_results', 'llm_test_accuracy':    
 0.9673999999999999, 'llm_top_1_test_accuracy': 0.6672, 'llm_top_2_test_accuracy': 0.7051999999999999, 'llm_top_5_test_accuracy': 0.7662, 'llm_top_10_test_accuracy':                
 0.8019999999999999, 'llm_top_20_test_accuracy': 0.8624, 'llm_top_50_test_accuracy': 0.9298, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9314000487327576,             
 'sae_top_1_test_accuracy': 0.6874, 'sae_top_2_test_accuracy': 0.6843999999999999, 'sae_top_5_test_accuracy': 0.765, 'sae_top_10_test_accuracy': 0.8022, 'sae_top_20_test_accuracy': 
 0.8555999999999999, 'sae_top_50_test_accuracy': 0.8926000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'fancyzhx/ag_news_results', 'llm_test_accuracy':           
 0.9390000000000001, 'llm_top_1_test_accuracy': 0.6385000000000001, 'llm_top_2_test_accuracy': 0.7815, 'llm_top_5_test_accuracy': 0.822, 'llm_top_10_test_accuracy':                 
 0.8687499999999999, 'llm_top_20_test_accuracy': 0.89975, 'llm_top_50_test_accuracy': 0.924, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9215000420808792,             
 'sae_top_1_test_accuracy': 0.62925, 'sae_top_2_test_accuracy': 0.73675, 'sae_top_5_test_accuracy': 0.81325, 'sae_top_10_test_accuracy': 0.8445, 'sae_top_20_test_accuracy':         
 0.8792500000000001, 'sae_top_50_test_accuracy': 0.9025000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'Helsinki-NLP/europarl_results', 'llm_test_accuracy':      
 0.9994, 'llm_top_1_test_accuracy': 0.6443999999999999, 'llm_top_2_test_accuracy': 0.7837999999999999, 'llm_top_5_test_accuracy': 0.907, 'llm_top_10_test_accuracy': 0.9648,         
 'llm_top_20_test_accuracy': 0.9895999999999999, 'llm_top_50_test_accuracy': 0.9978000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.957200038433075,          
 'sae_top_1_test_accuracy': 0.6015999999999999, 'sae_top_2_test_accuracy': 0.6596, 'sae_top_5_test_accuracy': 0.7354, 'sae_top_10_test_accuracy': 0.7872, 'sae_top_20_test_accuracy' 
 0.8442000000000001, 'sae_top_50_test_accuracy': 0.9116, 'sae_top_100_test_accuracy': None}], 'sae_bench_commit_hash': 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id':    
 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304 
 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True,                  
 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '',        
 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None 
 'training results for layer 19': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000,   
 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info':       
 {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'unlearning evaluation results':    
 {'eval_type_id': 'unlearning', 'eval_config': {'random_seed': 42, 'dataset_names': ['wmdp-bio', 'high_school_us_history', 'college_computer_science', 'high_school_geography',      
 'human_aging'], 'intervention_method': 'clamp_feature_activation', 'retain_thresholds': [0.001, 0.01, 0.1, 0.5], 'n_features_list': [100, 200], 'multipliers': [25, 50, 100, 200],  
 'dataset_size': 1024, 'seq_len': 1024, 'n_batch_loss_added': 50, 'target_metric': 'correct', 'save_metrics': True, 'model_name': 'google/gemma-2-2b-it', 'llm_batch_size': 32,      
 'llm_dtype': 'bfloat16'}, 'eval_id': 'eefdda16-0d33-4876-a8a5-a6befe821e03', 'datetime_epoch_millis': 1738003893013, 'eval_result_metrics': {'unlearning': {'unlearning_score':     
 0.0037453174591064453}}, 'eval_result_details': [], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id':        
 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name':      
 'blocks.19.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None,              
 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True,        
 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}}                                  
 Description: Baseline results.                                                                                                                                                      
 =======                                                                                                                                                                             
 # Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders                                                                                        
                                                                                                                                                                                     
 # Experiment description:                                                                                                                                                           
 1. Implement adaptive orthogonality loss with controlled feature sharing                                                                                                            
 2. Add batch-wise feature grouping with periodic updates                                                                                                                            
 3. Train on Gemma-2b using standard datasets                                                                                                                                        
 4. Compare unlearning performance against baseline and fixed orthogonal SAE                                                                                                         
 5. Analyze condition numbers of feature subspaces                                                                                                                                   
 6. Evaluate impact of different α values for controlled sharing                                                                                                                     
                                                                                                                                                                                     
 ## Run 2: Orthogonal Implementation with α=0.1                                                                                                                                      
 Added orthogonality constraints with α=0.1 (controlled feature sharing):                                                                                                            
 - L0 sparsity: 61.99                                                                                                                                                                
 - Explained variance: 0.293                                                                                                                                                         
 - Mean absorption score: 0.0101                                                                                                                                                     
 - Higher SCR metrics indicating better feature separation                                                                                                                           
 - Condition number tracking implemented                                                                                                                                             
 - 4 feature groups with controlled sharing                                                                                                                                          
                                                                                                                                                                                     
 Key findings:                                                                                                                                                                       
 1. Controlled feature sharing (α=0.1) improves sparsity while maintaining reconstruction                                                                                            
 2. Feature groups show clear separation in SCR evaluation                                                                                                                           
 3. Adaptive orthogonality loss helps balance group independence                                                                                                                     
 >>>>>>> REPLACE                                                                                                                                                                     
                                                                                                                                                                                     

Tokens: 54k sent, 5.0k received. Cost: $0.24 message, $0.60 session.
Applied edit to notes.txt

python experiment.py --out_dir=run_2
coder_out: Let me fix the SEARCH/REPLACE block for notes.txt. The issue was that I needed to exactly match the existing content:

notes.txt
```python
<<<<<<< SEARCH
# Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders
# Experiment description: 1. Implement adaptive orthogonality loss with controlled feature sharing
2. Add batch-wise feature grouping with periodic updates
3. Train on Pythia-70M using WMDP-bio and WikiText datasets
4. Compare unlearning performance against baseline and fixed orthogonal SAE
5. Analyze condition numbers of feature subspaces
6. Evaluate impact of different α values for controlled sharing
## Run 0: Baseline
Results: {'training results': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000, 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info': {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'core evaluation results': {'unique_id': 'google/gemma-2-2b_layer_19_sae_custom_sae', 'sae_set': 'google/gemma-2-2b_layer_19_sae', 'sae_id': 'custom_sae', 'eval_cfg': {'model_name': 'google/gemma-2-2b', 'llm_dtype': 'bfloat16', 'batch_size_prompts': 16, 'n_eval_reconstruction_batches': 200, 'n_eval_sparsity_variance_batches': 2000, 'dataset': 'Skylion007/openwebtext', 'context_size': 128, 'compute_kl': True, 'compute_ce_loss': True, 'compute_l2_norms': True, 'compute_sparsity_metrics': True, 'compute_variance_metrics': True, 'compute_featurewise_density_statistics': False, 'compute_featurewise_weight_based_metrics': False, 'exclude_special_tokens_from_reconstruction': True, 'verbose': False}, 'metrics': {'model_behavior_preservation': {'kl_div_score': 0.7950310559006211, 'kl_div_with_ablation': 10.0625, 'kl_div_with_sae': 2.0625}, 'model_performance_preservation': {'ce_loss_score': 0.7894736842105263, 'ce_loss_with_ablation': 12.4375, 'ce_loss_with_sae': 4.9375, 'ce_loss_without_sae': 2.9375}, 'reconstruction_quality': {'explained_variance': 0.30859375, 'mse': 18.75, 'cossim': 0.76953125}, 'shrinkage': {'l2_norm_in': 308.0, 'l2_norm_out': 221.0, 'l2_ratio': 0.71484375, 'relative_reconstruction_bias': 0.93359375}, 'sparsity': {'l0': 85.21243286132812, 'l1': 458.0}, 'token_stats': {'total_tokens_eval_reconstruction': 409600, 'total_tokens_eval_sparsity_variance': 4096000}}}, 'scr and tpp evaluations results': {'eval_type_id': 'scr', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'canrager/amazon_reviews_mcauley_1and5'], 'perform_scr': True, 'early_stopping_patience': 20, 'train_set_size': 4000, 'test_set_size': 1000, 'context_length': 128, 'probe_train_batch_size': 16, 'probe_test_batch_size': 500, 'probe_epochs': 20, 'probe_lr': 0.001, 'probe_l1_penalty': 0.001, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'lower_vram_usage': False, 'model_name': 'google/gemma-2-2b', 'n_values': [2, 5, 10, 20, 50, 100, 500], 'column1_vals_lookup': {'LabHC/bias_in_bios_class_set1': [['professor', 'nurse'], ['architect', 'journalist'], ['surgeon', 'psychologist'], ['attorney', 'teacher']], 'canrager/amazon_reviews_mcauley_1and5': [['Books', 'CDs_and_Vinyl'], ['Software', 'Electronics'], ['Pet_Supplies', 'Office_Products'], ['Industrial_and_Scientific', 'Toys_and_Games']]}}, 'eval_id': 'c28f32b2-a72e-4f76-8d5a-85d6f9937f1b', 'datetime_epoch_millis': 1737884773606, 'eval_result_metrics': {'scr_metrics': {'scr_dir1_threshold_2': 0.035600906531669814, 'scr_metric_threshold_2': 0.019679524675140548, 'scr_dir2_threshold_2': 0.011514810160172787, 'scr_dir1_threshold_5': 0.051710736232558285, 'scr_metric_threshold_5': 0.06512155475350995, 'scr_dir2_threshold_5': 0.05295877346813508, 'scr_dir1_threshold_10': 0.077764577667114, 'scr_metric_threshold_10': 0.08335696172542797, 'scr_dir2_threshold_10': 0.07006244094994978, 'scr_dir1_threshold_20': 0.07343213933631738, 'scr_metric_threshold_20': 0.08504280928786076, 'scr_dir2_threshold_20': 0.07359277159847097, 'scr_dir1_threshold_50': 0.03350340830709253, 'scr_metric_threshold_50': 0.08899691187101458, 'scr_dir2_threshold_50': 0.07593742114240237, 'scr_dir1_threshold_100': -0.16207016165821828, 'scr_metric_threshold_100': 0.062236305245427885, 'scr_dir2_threshold_100': 0.052638407599727086, 'scr_dir1_threshold_500': -0.25156349364441777, 'scr_metric_threshold_500': 0.027887084742431078, 'scr_dir2_threshold_500': 0.004238511981040263}}, 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_professor_nurse_results', 'scr_dir1_threshold_2': 0.03124962164991371, 'scr_metric_threshold_2': 0.012284998611665989, 'scr_dir2_threshold_2': 0.012284998611665989, 'scr_dir1_threshold_5': -0.015625742148246177, 'scr_metric_threshold_5': 0.05896816907447914, 'scr_dir2_threshold_5': 0.05896816907447914, 'scr_dir1_threshold_10': -0.015625742148246177, 'scr_metric_threshold_10': 0.14987724667004865, 'scr_dir2_threshold_10': 0.14987724667004865, 'scr_dir1_threshold_20': -0.03125055297320303, 'scr_metric_threshold_20': 0.15479118753522092, 'scr_dir2_threshold_20': 0.15479118753522092, 'scr_dir1_threshold_50': -0.2968760622906269, 'scr_metric_threshold_50': 0.16216224528171463, 'scr_dir2_threshold_50': 0.16216224528171463, 'scr_dir1_threshold_100': -1.312501804438873, 'scr_metric_threshold_100': 0.14987724667004865, 'scr_dir2_threshold_100': 0.14987724667004865, 'scr_dir1_threshold_500': -1.3750019790619898, 'scr_metric_threshold_500': 0.15724815796780706, 'scr_dir2_threshold_500': 0.15724815796780706}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_architect_journalist_results', 'scr_dir1_threshold_2': -0.08737868572318094, 'scr_metric_threshold_2': 0.034383855303823166, 'scr_dir2_threshold_2': 0.034383855303823166, 'scr_dir1_threshold_5': -0.10679649293164041, 'scr_metric_threshold_5': 0.06590258858377988, 'scr_dir2_threshold_5': 0.06590258858377988, 'scr_dir1_threshold_10': -0.11650510719289281, 'scr_metric_threshold_10': 0.037249318901607584, 'scr_dir2_threshold_10': 0.037249318901607584, 'scr_dir1_threshold_20': -0.10679649293164041, 'scr_metric_threshold_20': 0.04011461171243302, 'scr_dir2_threshold_20': 0.04011461171243302, 'scr_dir1_threshold_50': -0.14563152866260468, 'scr_metric_threshold_50': 0.07449846701625619, 'scr_dir2_threshold_50': 0.07449846701625619, 'scr_dir1_threshold_100': -0.14563152866260468, 'scr_metric_threshold_100': 0.10888249310703833, 'scr_dir2_threshold_100': 0.10888249310703833, 'scr_dir1_threshold_500': -0.3106797071617595, 'scr_metric_threshold_500': 0.0859598090465169, 'scr_dir2_threshold_500': 0.0859598090465169}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_surgeon_psychologist_results', 'scr_dir1_threshold_2': 0.015873751732555005, 'scr_metric_threshold_2': -0.0025316127159178037, 'scr_dir2_threshold_2': -0.0025316127159178037, 'scr_dir1_threshold_5': 0.03174655735998827, 'scr_metric_threshold_5': -0.005063225431835607, 'scr_dir2_threshold_5': -0.005063225431835607, 'scr_dir1_threshold_10': 0.0, 'scr_metric_threshold_10': 0.0075949890455728015, 'scr_dir2_threshold_10': 0.0075949890455728015, 'scr_dir1_threshold_20': -0.0634921686148548, 'scr_metric_threshold_20': 0.02784819256855401, 'scr_dir2_threshold_20': 0.02784819256855401, 'scr_dir1_threshold_50': -0.1111105854971546, 'scr_metric_threshold_50': 0.05316462152337083, 'scr_dir2_threshold_50': 0.05316462152337083, 'scr_dir1_threshold_100': -0.2222221170994309, 'scr_metric_threshold_100': 0.05316462152337083, 'scr_dir2_threshold_100': 0.05316462152337083, 'scr_dir1_threshold_500': -0.5714285714285714, 'scr_metric_threshold_500': 0.055696234239288635, 'scr_dir2_threshold_500': 0.055696234239288635}, {'dataset_name': 'LabHC/bias_in_bios_class_set1_scr_attorney_teacher_results', 'scr_dir1_threshold_2': 0.0, 'scr_metric_threshold_2': 0.020771598900727672, 'scr_dir2_threshold_2': 0.020771598900727672, 'scr_dir1_threshold_5': 0.0, 'scr_metric_threshold_5': 0.1246292396676148, 'scr_dir2_threshold_5': 0.1246292396676148, 'scr_dir1_threshold_10': -0.007812398136610098, 'scr_metric_threshold_10': 0.10089032002917621, 'scr_dir2_threshold_10': 0.10089032002917621, 'scr_dir1_threshold_20': 0.10156257275956422, 'scr_metric_threshold_20': 0.0890208602099569, 'scr_dir2_threshold_20': 0.0890208602099569, 'scr_dir1_threshold_50': 0.10156257275956422, 'scr_metric_threshold_50': 0.11869442132381734, 'scr_dir2_threshold_50': 0.11869442132381734, 'scr_dir1_threshold_100': -0.17187462165026607, 'scr_metric_threshold_100': 0.10979228224230897, 'scr_dir2_threshold_100': 0.10979228224230897, 'scr_dir1_threshold_500': -0.16406222351365599, 'scr_metric_threshold_500': 0.06824926130922924, 'scr_dir2_threshold_500': 0.06824926130922924}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Books_CDs_and_Vinyl_results', 'scr_dir1_threshold_2': -0.06010915791026799, 'scr_metric_threshold_2': -0.015686069182044467, 'scr_dir2_threshold_2': -0.015686069182044467, 'scr_dir1_threshold_5': -0.01092881936245188, 'scr_metric_threshold_5': 0.07450976358933016, 'scr_dir2_threshold_5': 0.07450976358933016, 'scr_dir1_threshold_10': 0.27322406685360157, 'scr_metric_threshold_10': 0.10588236944072857, 'scr_dir2_threshold_10': 0.10588236944072857, 'scr_dir1_threshold_20': 0.24043695734946327, 'scr_metric_threshold_20': 0.08235303192400713, 'scr_dir2_threshold_20': 0.08235303192400713, 'scr_dir1_threshold_50': 0.3005464409681226, 'scr_metric_threshold_50': 0.039215874186075375, 'scr_dir2_threshold_50': 0.039215874186075375, 'scr_dir1_threshold_100': 0.2568305121015324, 'scr_metric_threshold_100': 0.06274521170279682, 'scr_dir2_threshold_100': 0.06274521170279682, 'scr_dir1_threshold_500': 0.21311458323494226, 'scr_metric_threshold_500': -0.14901952717866032, 'scr_dir2_threshold_500': -0.14901952717866032}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Software_Electronics_results', 'scr_dir1_threshold_2': 0.158974152062764, 'scr_metric_threshold_2': 0.05241939554166917, 'scr_dir2_threshold_2': 0.05241939554166917, 'scr_dir1_threshold_5': 0.17948701489841076, 'scr_metric_threshold_5': 0.07258066454365199, 'scr_dir2_threshold_5': 0.07258066454365199, 'scr_dir1_threshold_10': 0.18461515419110838, 'scr_metric_threshold_10': 0.10483879108333834, 'scr_dir2_threshold_10': 0.10483879108333834, 'scr_dir1_threshold_20': 0.17435887560571312, 'scr_metric_threshold_20': 0.11693564862104187, 'scr_dir2_threshold_20': 0.11693564862104187, 'scr_dir1_threshold_50': 0.2102561563194528, 'scr_metric_threshold_50': 0.10887099681547797, 'scr_dir2_threshold_50': 0.10887099681547797, 'scr_dir1_threshold_100': 0.19487173844135988, 'scr_metric_threshold_100': -0.07258066454365199, 'scr_dir2_threshold_100': -0.07258066454365199, 'scr_dir1_threshold_500': 0.16410229135546164, 'scr_metric_threshold_500': -0.12499981974403652, 'scr_dir2_threshold_500': -0.12499981974403652}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Pet_Supplies_Office_Products_results', 'scr_dir1_threshold_2': 0.17040353950037407, 'scr_metric_threshold_2': 0.0, 'scr_dir2_threshold_2': 0.0, 'scr_dir1_threshold_5': 0.22421531016200436, 'scr_metric_threshold_5': 0.017857176118657926, 'scr_dir2_threshold_5': 0.017857176118657926, 'scr_dir1_threshold_10': 0.18834079638758416, 'scr_metric_threshold_10': 0.04464280725058454, 'scr_dir2_threshold_10': 0.04464280725058454, 'scr_dir1_threshold_20': 0.15246628261316397, 'scr_metric_threshold_20': 0.04910730084933944, 'scr_dir2_threshold_20': 0.04910730084933944, 'scr_dir1_threshold_50': 0.0762330076638747, 'scr_metric_threshold_50': 0.02232140362529227, 'scr_dir2_threshold_50': 0.02232140362529227, 'scr_dir1_threshold_100': 0.02242150428765898, 'scr_metric_threshold_100': 0.0044642275066343415, 'scr_dir2_threshold_100': 0.0044642275066343415, 'scr_dir1_threshold_500': -0.06726478014839152, 'scr_metric_threshold_500': 0.03125012473068151, 'scr_dir2_threshold_500': 0.03125012473068151}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_scr_Industrial_and_Scientific_Toys_and_Games_results', 'scr_dir1_threshold_2': 0.05579403094120067, 'scr_metric_threshold_2': 0.05579403094120067, 'scr_dir2_threshold_2': -0.009523685178541423, 'scr_dir1_threshold_5': 0.11158806188240133, 'scr_metric_threshold_5': 0.11158806188240133, 'scr_dir2_threshold_5': 0.014285811599402364, 'scr_dir1_threshold_10': 0.11587985138236706, 'scr_metric_threshold_10': 0.11587985138236706, 'scr_dir2_threshold_10': 0.009523685178541423, 'scr_dir1_threshold_20': 0.12017164088233277, 'scr_metric_threshold_20': 0.12017164088233277, 'scr_dir2_threshold_20': 0.0285713393672145, 'scr_dir1_threshold_50': 0.13304726519611204, 'scr_metric_threshold_50': 0.13304726519611204, 'scr_dir2_threshold_50': 0.0285713393672145, 'scr_dir1_threshold_100': 0.08154502375487709, 'scr_metric_threshold_100': 0.08154502375487709, 'scr_dir2_threshold_100': 0.004761842589270712, 'scr_dir1_threshold_500': 0.09871243756862208, 'scr_metric_threshold_500': 0.09871243756862208, 'scr_dir2_threshold_500': -0.09047614452250444}], 'sae_bench_commit_hash': 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'absorption evaluation results': {'eval_type_id': 'absorption_first_letter', 'eval_config': {'model_name': 'google/gemma-2-2b', 'random_seed': 42, 'f1_jump_threshold': 0.03, 'max_k_value': 10, 'prompt_template': '{word} has the first letter:', 'prompt_token_pos': -6, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'k_sparse_probe_l1_decay': 0.01, 'k_sparse_probe_batch_size': 4096, 'k_sparse_probe_num_epochs': 50}, 'eval_id': '515e7b3b-6b86-4214-aa0d-c2ef123e2969', 'datetime_epoch_millis': 1737999200566, 'eval_result_metrics': {'mean': {'mean_absorption_score': 0.010124895517470242, 'mean_num_split_features': 1.2}}, 'eval_result_details': [{'first_letter': 'a', 'absorption_rate': 0.00986971969996052, 'num_absorption': 25, 'num_probe_true_positives': 2533, 'num_split_features': 1}, {'first_letter': 'b', 'absorption_rate': 0.005050505050505051, 'num_absorption': 8, 'num_probe_true_positives': 1584, 'num_split_features': 1}, {'first_letter': 'c', 'absorption_rate': 0.02792890823358723, 'num_absorption': 77, 'num_probe_true_positives': 2757, 'num_split_features': 1}, {'first_letter': 'd', 'absorption_rate': 0.008631319358816275, 'num_absorption': 14, 'num_probe_true_positives': 1622, 'num_split_features': 1}, {'first_letter': 'e', 'absorption_rate': 0.002523659305993691, 'num_absorption': 4, 'num_probe_true_positives': 1585, 'num_split_features': 1}, {'first_letter': 'f', 'absorption_rate': 0.004942339373970346, 'num_absorption': 6, 'num_probe_true_positives': 1214, 'num_split_features': 1}, {'first_letter': 'g', 'absorption_rate': 0.0026362038664323375, 'num_absorption': 3, 'num_probe_true_positives': 1138, 'num_split_features': 1}, {'first_letter': 'h', 'absorption_rate': 0.08004158004158005, 'num_absorption': 77, 'num_probe_true_positives': 962, 'num_split_features': 1}, {'first_letter': 'i', 'absorption_rate': 0.007402837754472548, 'num_absorption': 12, 'num_probe_true_positives': 1621, 'num_split_features': 2}, {'first_letter': 'j', 'absorption_rate': 0.03546099290780142, 'num_absorption': 15, 'num_probe_true_positives': 423, 'num_split_features': 1}, {'first_letter': 'k', 'absorption_rate': 0.001557632398753894, 'num_absorption': 1, 'num_probe_true_positives': 642, 'num_split_features': 1}, {'first_letter': 'l', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 1196, 'num_split_features': 1}, {'first_letter': 'm', 'absorption_rate': 0.0060406370126304225, 'num_absorption': 11, 'num_probe_true_positives': 1821, 'num_split_features': 1}, {'first_letter': 'n', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 845, 'num_split_features': 1}, {'first_letter': 'o', 'absorption_rate': 0.007070707070707071, 'num_absorption': 7, 'num_probe_true_positives': 990, 'num_split_features': 1}, {'first_letter': 'p', 'absorption_rate': 0.0004332755632582322, 'num_absorption': 1, 'num_probe_true_positives': 2308, 'num_split_features': 2}, {'first_letter': 'q', 'absorption_rate': 0.011428571428571429, 'num_absorption': 2, 'num_probe_true_positives': 175, 'num_split_features': 1}, {'first_letter': 'r', 'absorption_rate': 0.006053268765133172, 'num_absorption': 10, 'num_probe_true_positives': 1652, 'num_split_features': 2}, {'first_letter': 's', 'absorption_rate': 0.005263157894736842, 'num_absorption': 15, 'num_probe_true_positives': 2850, 'num_split_features': 1}, {'first_letter': 't', 'absorption_rate': 0.00357355568790947, 'num_absorption': 6, 'num_probe_true_positives': 1679, 'num_split_features': 2}, {'first_letter': 'u', 'absorption_rate': 0.0013297872340425532, 'num_absorption': 1, 'num_probe_true_positives': 752, 'num_split_features': 2}, {'first_letter': 'v', 'absorption_rate': 0.0012738853503184713, 'num_absorption': 1, 'num_probe_true_positives': 785, 'num_split_features': 1}, {'first_letter': 'w', 'absorption_rate': 0.004201680672268907, 'num_absorption': 3, 'num_probe_true_positives': 714, 'num_split_features': 1}, {'first_letter': 'y', 'absorption_rate': 0.02040816326530612, 'num_absorption': 3, 'num_probe_true_positives': 147, 'num_split_features': 1}, {'first_letter': 'z', 'absorption_rate': 0.0, 'num_absorption': 0, 'num_probe_true_positives': 230, 'num_split_features': 1}], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'sparse probing evaluation results': {'eval_type_id': 'sparse_probing', 'eval_config': {'random_seed': 42, 'dataset_names': ['LabHC/bias_in_bios_class_set1', 'LabHC/bias_in_bios_class_set2', 'LabHC/bias_in_bios_class_set3', 'canrager/amazon_reviews_mcauley_1and5', 'canrager/amazon_reviews_mcauley_1and5_sentiment', 'codeparrot/github-code', 'fancyzhx/ag_news', 'Helsinki-NLP/europarl'], 'probe_train_set_size': 4000, 'probe_test_set_size': 1000, 'context_length': 128, 'sae_batch_size': 125, 'llm_batch_size': 32, 'llm_dtype': 'bfloat16', 'model_name': 'google/gemma-2-2b', 'k_values': [1, 2, 5, 10, 20, 50], 'lower_vram_usage': False}, 'eval_id': 'fddb5e3e-09c2-4d2c-b7ac-9077585d20ec', 'datetime_epoch_millis': 1737900662632, 'eval_result_metrics': {'llm': {'llm_test_accuracy': 0.9505874999999999, 'llm_top_1_test_accuracy': 0.6539375, 'llm_top_2_test_accuracy': 0.7235875, 'llm_top_5_test_accuracy': 0.7815, 'llm_top_10_test_accuracy': 0.8289187499999999, 'llm_top_20_test_accuracy': 0.8770187500000001, 'llm_top_50_test_accuracy': 0.9236000000000001, 'llm_top_100_test_accuracy': None}, 'sae': {'sae_test_accuracy': 0.9151000421494245, 'sae_top_1_test_accuracy': 0.6601812499999999, 'sae_top_2_test_accuracy': 0.70936875, 'sae_top_5_test_accuracy': 0.7653812499999999, 'sae_top_10_test_accuracy': 0.8049125000000001, 'sae_top_20_test_accuracy': 0.84908125, 'sae_top_50_test_accuracy': 0.8829625, 'sae_top_100_test_accuracy': None}}, 'eval_result_details': [{'dataset_name': 'LabHC/bias_in_bios_class_set1_results', 'llm_test_accuracy': 0.9596, 'llm_top_1_test_accuracy': 0.6432, 'llm_top_2_test_accuracy': 0.6916, 'llm_top_5_test_accuracy': 0.7912, 'llm_top_10_test_accuracy': 0.8336, 'llm_top_20_test_accuracy': 0.8962, 'llm_top_50_test_accuracy': 0.9384, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9414000391960144, 'sae_top_1_test_accuracy': 0.6437999999999999, 'sae_top_2_test_accuracy': 0.7016, 'sae_top_5_test_accuracy': 0.7776, 'sae_top_10_test_accuracy': 0.8150000000000001, 'sae_top_20_test_accuracy': 0.8516, 'sae_top_50_test_accuracy': 0.9064, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'LabHC/bias_in_bios_class_set2_results', 'llm_test_accuracy': 0.9468, 'llm_top_1_test_accuracy': 0.6779999999999999, 'llm_top_2_test_accuracy': 0.7282, 'llm_top_5_test_accuracy': 0.77, 'llm_top_10_test_accuracy': 0.8024000000000001, 'llm_top_20_test_accuracy': 0.8596, 'llm_top_50_test_accuracy': 0.9076000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9112000346183777, 'sae_top_1_test_accuracy': 0.6588, 'sae_top_2_test_accuracy': 0.6958, 'sae_top_5_test_accuracy': 0.7487999999999999, 'sae_top_10_test_accuracy': 0.8055999999999999, 'sae_top_20_test_accuracy': 0.849, 'sae_top_50_test_accuracy': 0.8788, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'LabHC/bias_in_bios_class_set3_results', 'llm_test_accuracy': 0.914, 'llm_top_1_test_accuracy': 0.6888, 'llm_top_2_test_accuracy': 0.7322, 'llm_top_5_test_accuracy': 0.7544000000000001, 'llm_top_10_test_accuracy': 0.7958, 'llm_top_20_test_accuracy': 0.8518000000000001, 'llm_top_50_test_accuracy': 0.8942, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.8954000353813172, 'sae_top_1_test_accuracy': 0.6872, 'sae_top_2_test_accuracy': 0.716, 'sae_top_5_test_accuracy': 0.7642, 'sae_top_10_test_accuracy': 0.8092, 'sae_top_20_test_accuracy': 0.8370000000000001, 'sae_top_50_test_accuracy': 0.8684000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_results', 'llm_test_accuracy': 0.897, 'llm_top_1_test_accuracy': 0.6003999999999999, 'llm_top_2_test_accuracy': 0.6422000000000001, 'llm_top_5_test_accuracy': 0.6752, 'llm_top_10_test_accuracy': 0.7379999999999999, 'llm_top_20_test_accuracy': 0.8098000000000001, 'llm_top_50_test_accuracy': 0.8640000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.8272000432014466, 'sae_top_1_test_accuracy': 0.5764000000000001, 'sae_top_2_test_accuracy': 0.5928, 'sae_top_5_test_accuracy': 0.6258, 'sae_top_10_test_accuracy': 0.6836, 'sae_top_20_test_accuracy': 0.76, 'sae_top_50_test_accuracy': 0.7934, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'canrager/amazon_reviews_mcauley_1and5_sentiment_results', 'llm_test_accuracy': 0.9815, 'llm_top_1_test_accuracy': 0.671, 'llm_top_2_test_accuracy': 0.724, 'llm_top_5_test_accuracy': 0.766, 'llm_top_10_test_accuracy': 0.826, 'llm_top_20_test_accuracy': 0.847, 'llm_top_50_test_accuracy': 0.933, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9355000555515289, 'sae_top_1_test_accuracy': 0.797, 'sae_top_2_test_accuracy': 0.888, 'sae_top_5_test_accuracy': 0.893, 'sae_top_10_test_accuracy': 0.892, 'sae_top_20_test_accuracy': 0.916, 'sae_top_50_test_accuracy': 0.91, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'codeparrot/github-code_results', 'llm_test_accuracy': 0.9673999999999999, 'llm_top_1_test_accuracy': 0.6672, 'llm_top_2_test_accuracy': 0.7051999999999999, 'llm_top_5_test_accuracy': 0.7662, 'llm_top_10_test_accuracy': 0.8019999999999999, 'llm_top_20_test_accuracy': 0.8624, 'llm_top_50_test_accuracy': 0.9298, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9314000487327576, 'sae_top_1_test_accuracy': 0.6874, 'sae_top_2_test_accuracy': 0.6843999999999999, 'sae_top_5_test_accuracy': 0.765, 'sae_top_10_test_accuracy': 0.8022, 'sae_top_20_test_accuracy': 0.8555999999999999, 'sae_top_50_test_accuracy': 0.8926000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'fancyzhx/ag_news_results', 'llm_test_accuracy': 0.9390000000000001, 'llm_top_1_test_accuracy': 0.6385000000000001, 'llm_top_2_test_accuracy': 0.7815, 'llm_top_5_test_accuracy': 0.822, 'llm_top_10_test_accuracy': 0.8687499999999999, 'llm_top_20_test_accuracy': 0.89975, 'llm_top_50_test_accuracy': 0.924, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.9215000420808792, 'sae_top_1_test_accuracy': 0.62925, 'sae_top_2_test_accuracy': 0.73675, 'sae_top_5_test_accuracy': 0.81325, 'sae_top_10_test_accuracy': 0.8445, 'sae_top_20_test_accuracy': 0.8792500000000001, 'sae_top_50_test_accuracy': 0.9025000000000001, 'sae_top_100_test_accuracy': None}, {'dataset_name': 'Helsinki-NLP/europarl_results', 'llm_test_accuracy': 0.9994, 'llm_top_1_test_accuracy': 0.6443999999999999, 'llm_top_2_test_accuracy': 0.7837999999999999, 'llm_top_5_test_accuracy': 0.907, 'llm_top_10_test_accuracy': 0.9648, 'llm_top_20_test_accuracy': 0.9895999999999999, 'llm_top_50_test_accuracy': 0.9978000000000001, 'llm_top_100_test_accuracy': None, 'sae_test_accuracy': 0.957200038433075, 'sae_top_1_test_accuracy': 0.6015999999999999, 'sae_top_2_test_accuracy': 0.6596, 'sae_top_5_test_accuracy': 0.7354, 'sae_top_10_test_accuracy': 0.7872, 'sae_top_20_test_accuracy': 0.8442000000000001, 'sae_top_50_test_accuracy': 0.9116, 'sae_top_100_test_accuracy': None}], 'sae_bench_commit_hash': 'd8a9fbf2e09c6353944addaddfb5ca77a0714984', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_12_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 12, 'hook_name': 'blocks.12.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}, 'training results for layer 19': {'config': {'trainer_class': 'CustomTrainer', 'activation_dim': 2304, 'dict_size': 2304, 'lr': 0.0003, 'l1_penalty': 0.04, 'warmup_steps': 1000, 'resample_steps': None, 'device': 'cuda', 'layer': 19, 'lm_name': 'google/gemma-2-2b', 'wandb_name': 'CustomTrainer', 'submodule_name': 'resid_post_layer_19'}, 'final_info': {'training_steps': 4882, 'final_loss': 200.22540283203125, 'layer': 19, 'dict_size': 2304, 'learning_rate': 0.0003, 'sparsity_penalty': 0.04}}, 'unlearning evaluation results': {'eval_type_id': 'unlearning', 'eval_config': {'random_seed': 42, 'dataset_names': ['wmdp-bio', 'high_school_us_history', 'college_computer_science', 'high_school_geography', 'human_aging'], 'intervention_method': 'clamp_feature_activation', 'retain_thresholds': [0.001, 0.01, 0.1, 0.5], 'n_features_list': [100, 200], 'multipliers': [25, 50, 100, 200], 'dataset_size': 1024, 'seq_len': 1024, 'n_batch_loss_added': 50, 'target_metric': 'correct', 'save_metrics': True, 'model_name': 'google/gemma-2-2b-it', 'llm_batch_size': 32, 'llm_dtype': 'bfloat16'}, 'eval_id': 'eefdda16-0d33-4876-a8a5-a6befe821e03', 'datetime_epoch_millis': 1738003893013, 'eval_result_metrics': {'unlearning': {'unlearning_score': 0.0037453174591064453}}, 'eval_result_details': [], 'sae_bench_commit_hash': '88c9225ec5f48485e1b632cf29a8e11e4d49547c', 'sae_lens_id': 'custom_sae', 'sae_lens_release_id': 'google/gemma-2-2b_layer_19_sae', 'sae_lens_version': '5.3.0', 'sae_cfg_dict': {'model_name': 'google/gemma-2-2b', 'd_in': 2304, 'd_sae': 2304, 'hook_layer': 19, 'hook_name': 'blocks.19.hook_resid_post', 'context_size': None, 'hook_head_index': None, 'architecture': 'Custom', 'apply_b_dec_to_input': True, 'finetuning_scaling_factor': None, 'activation_fn_str': 'relu', 'prepend_bos': True, 'normalize_activations': 'none', 'dtype': 'bfloat16', 'device': '', 'dataset_path': '', 'dataset_trust_remote_code': True, 'seqpos_slice': [None], 'training_tokens': -100000, 'sae_lens_training_version': None, 'neuronpedia_id': None}, 'eval_result_unstructured': None}}
Description: Baseline results.
=======
# Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders

# Experiment description: 
1. Implement adaptive orthogonality loss with controlled feature sharing
2. Add batch-wise feature grouping with periodic updates
3. Train on Gemma-2b using standard datasets
4. Compare unlearning performance against baseline and fixed orthogonal SAE
5. Analyze condition numbers of feature subspaces
6. Evaluate impact of different α values for controlled sharing

## Run 2: Orthogonal Implementation with α=0.1
Added orthogonality constraints with α=0.1 (controlled feature sharing):
- L0 sparsity: 61.99
- Explained variance: 0.293
- Mean absorption score: 0.0101
- Higher SCR metrics indicating better feature separation
- Condition number tracking implemented
- 4 feature groups with controlled sharing

Key findings:
1. Controlled feature sharing (α=0.1) improves sparsity while maintaining reconstruction
2. Feature groups show clear separation in SCR evaluation
3. Adaptive orthogonality loss helps balance group independence
>>>>>>> REPLACE
```, type: <class 'str'>Step 0: {'loss': 913.3270263671875, 'l1_loss': 8814.16796875, 'l2_loss': 560.615478515625, 'ortho_loss': 144.80810546875, 'condition_number': 16592.69921875}
Step 100: {'loss': 620.01611328125, 'l1_loss': 6244.0419921875, 'l2_loss': 355.76171875, 'ortho_loss': 143.4925079345703, 'condition_number': 135112.328125}
Step 200: {'loss': 461.02490234375, 'l1_loss': 2792.985595703125, 'l2_loss': 318.572509765625, 'ortho_loss': 152.90028381347656, 'condition_number': 8142.16650390625}
Step 300: {'loss': 410.9068298339844, 'l1_loss': 1381.4964599609375, 'l2_loss': 308.359375, 'ortho_loss': 157.10166931152344, 'condition_number': 10191.80859375}
Step 400: {'loss': 388.1158752441406, 'l1_loss': 1072.8228759765625, 'l2_loss': 296.05609130859375, 'ortho_loss': 122.56079864501953, 'condition_number': 24115.251953125}
Step 500: {'loss': 353.75628662109375, 'l1_loss': 1097.244873046875, 'l2_loss': 267.673828125, 'ortho_loss': 84.21687316894531, 'condition_number': 30740.134765625}
Step 600: {'loss': 317.16754150390625, 'l1_loss': 982.2925415039062, 'l2_loss': 249.32260131835938, 'ortho_loss': 47.509517669677734, 'condition_number': 45763.9375}
Step 700: {'loss': 281.57147216796875, 'l1_loss': 912.725341796875, 'l2_loss': 229.927734375, 'ortho_loss': 21.590206146240234, 'condition_number': 10808.6220703125}
Step 800: {'loss': 259.0716247558594, 'l1_loss': 908.4183959960938, 'l2_loss': 220.08914184570312, 'ortho_loss': 3.3030638694763184, 'condition_number': 63020.56640625}
Step 900: {'loss': 245.97317504882812, 'l1_loss': 764.85107421875, 'l2_loss': 214.6786346435547, 'ortho_loss': 0.7774759531021118, 'condition_number': 6997.88525390625}
Step 1000: {'loss': 245.51486206054688, 'l1_loss': 802.1775512695312, 'l2_loss': 211.99618530273438, 'ortho_loss': 1.4315850734710693, 'condition_number': 12539.8876953125}
Step 1100: {'loss': 237.8130340576172, 'l1_loss': 671.365966796875, 'l2_loss': 209.77926635742188, 'ortho_loss': 1.1791176795959473, 'condition_number': 30978.15234375}
Step 1200: {'loss': 230.71656799316406, 'l1_loss': 562.3851318359375, 'l2_loss': 206.93618774414062, 'ortho_loss': 1.2849711179733276, 'condition_number': 14785.125}
Step 1300: {'loss': 232.94203186035156, 'l1_loss': 609.9537353515625, 'l2_loss': 207.33718872070312, 'ortho_loss': 1.2066904306411743, 'condition_number': 21969.505859375}
Step 1400: {'loss': 229.53302001953125, 'l1_loss': 618.4671630859375, 'l2_loss': 203.708251953125, 'ortho_loss': 1.086089015007019, 'condition_number': 63696.62890625}
Step 1500: {'loss': 227.5922393798828, 'l1_loss': 567.642578125, 'l2_loss': 203.84048461914062, 'ortho_loss': 1.046053171157837, 'condition_number': 48834.56640625}
Step 1600: {'loss': 226.5459442138672, 'l1_loss': 565.302734375, 'l2_loss': 202.9861602783203, 'ortho_loss': 0.9476848244667053, 'condition_number': 21384.970703125}
Step 1700: {'loss': 224.21792602539062, 'l1_loss': 538.099365234375, 'l2_loss': 201.56491088867188, 'ortho_loss': 1.129043698310852, 'condition_number': 21028.765625}
Step 1800: {'loss': 224.13418579101562, 'l1_loss': 564.2943115234375, 'l2_loss': 200.62840270996094, 'ortho_loss': 0.9340111613273621, 'condition_number': 36290.9765625}
Step 1900: {'loss': 222.32754516601562, 'l1_loss': 538.8798828125, 'l2_loss': 199.87405395507812, 'ortho_loss': 0.8983010053634644, 'condition_number': 22997.681640625}
Step 2000: {'loss': 221.12562561035156, 'l1_loss': 532.1793823242188, 'l2_loss': 199.03005981445312, 'ortho_loss': 0.8083981275558472, 'condition_number': 17234.595703125}
Step 2100: {'loss': 221.0845947265625, 'l1_loss': 508.1173095703125, 'l2_loss': 199.99337768554688, 'ortho_loss': 0.7665301561355591, 'condition_number': 26684.9609375}
Step 2200: {'loss': 216.94847106933594, 'l1_loss': 463.130859375, 'l2_loss': 197.69627380371094, 'ortho_loss': 0.7269612550735474, 'condition_number': 171361.953125}
Step 2300: {'loss': 217.4590606689453, 'l1_loss': 512.749755859375, 'l2_loss': 196.26170349121094, 'ortho_loss': 0.6873668432235718, 'condition_number': 9436.5625}
Step 2400: {'loss': 217.25621032714844, 'l1_loss': 500.2746276855469, 'l2_loss': 196.58741760253906, 'ortho_loss': 0.6578021049499512, 'condition_number': 5572.6318359375}
Step 2500: {'loss': 215.00424194335938, 'l1_loss': 505.36431884765625, 'l2_loss': 194.07176208496094, 'ortho_loss': 0.7179150581359863, 'condition_number': 4083.056640625}
Step 2600: {'loss': 215.19369506835938, 'l1_loss': 528.8250732421875, 'l2_loss': 193.13046264648438, 'ortho_loss': 0.91022789478302, 'condition_number': 3839.94384765625}
Step 2700: {'loss': 214.50131225585938, 'l1_loss': 501.1549072265625, 'l2_loss': 193.63766479492188, 'ortho_loss': 0.8174445033073425, 'condition_number': 3864.918701171875}
Step 2800: {'loss': 213.25408935546875, 'l1_loss': 479.32830810546875, 'l2_loss': 193.30596923828125, 'ortho_loss': 0.77498859167099, 'condition_number': 9111.1337890625}
Step 2900: {'loss': 210.99794006347656, 'l1_loss': 463.3831481933594, 'l2_loss': 191.71934509277344, 'ortho_loss': 0.7432756423950195, 'condition_number': 39409.3671875}
Step 3000: {'loss': 212.62022399902344, 'l1_loss': 499.2924499511719, 'l2_loss': 191.93197631835938, 'ortho_loss': 0.7165485620498657, 'condition_number': 20118.275390625}
Step 3100: {'loss': 210.47390747070312, 'l1_loss': 489.29266357421875, 'l2_loss': 190.20773315429688, 'ortho_loss': 0.6944666504859924, 'condition_number': 11042.76171875}
Step 3200: {'loss': 209.9535675048828, 'l1_loss': 470.1939697265625, 'l2_loss': 190.466796875, 'ortho_loss': 0.6790146827697754, 'condition_number': 18783.02734375}
Step 3300: {'loss': 209.20083618164062, 'l1_loss': 469.81689453125, 'l2_loss': 189.70542907714844, 'ortho_loss': 0.7027331590652466, 'condition_number': 8291.818359375}
Step 3400: {'loss': 210.09767150878906, 'l1_loss': 493.4129638671875, 'l2_loss': 189.70095825195312, 'ortho_loss': 0.6602047085762024, 'condition_number': 11408.8818359375}
Step 3500: {'loss': 206.27003479003906, 'l1_loss': 461.61016845703125, 'l2_loss': 187.15438842773438, 'ortho_loss': 0.6512483954429626, 'condition_number': 52582.82421875}
Step 3600: {'loss': 208.6678924560547, 'l1_loss': 488.1431884765625, 'l2_loss': 188.51565551757812, 'ortho_loss': 0.6265153884887695, 'condition_number': 14849.0654296875}
Step 3700: {'loss': 207.65977478027344, 'l1_loss': 476.10101318359375, 'l2_loss': 187.96685791015625, 'ortho_loss': 0.6488853096961975, 'condition_number': 392526.5}
Step 3800: {'loss': 205.6001739501953, 'l1_loss': 484.3619689941406, 'l2_loss': 185.58685302734375, 'ortho_loss': 0.6388458609580994, 'condition_number': 6699.9306640625}
Step 3900: {'loss': 205.89700317382812, 'l1_loss': 478.0539245605469, 'l2_loss': 186.15750122070312, 'ortho_loss': 0.6173401474952698, 'condition_number': 4717.85791015625}
Step 4000: {'loss': 205.3837432861328, 'l1_loss': 464.9397277832031, 'l2_loss': 186.19003295898438, 'ortho_loss': 0.5961194038391113, 'condition_number': 5515.5029296875}
Step 4100: {'loss': 204.73487854003906, 'l1_loss': 467.05450439453125, 'l2_loss': 185.4729766845703, 'ortho_loss': 0.5797296762466431, 'condition_number': 11544.1162109375}
Step 4200: {'loss': 204.6181640625, 'l1_loss': 490.07037353515625, 'l2_loss': 184.4697265625, 'ortho_loss': 0.5456219911575317, 'condition_number': 11478.9541015625}
Step 4300: {'loss': 204.52333068847656, 'l1_loss': 487.1623840332031, 'l2_loss': 184.4474334716797, 'ortho_loss': 0.5893940925598145, 'condition_number': 13936.9677734375}
Step 4400: {'loss': 202.5482635498047, 'l1_loss': 478.1561279296875, 'l2_loss': 182.85525512695312, 'ortho_loss': 0.5667579174041748, 'condition_number': 24966.890625}
Step 4500: {'loss': 202.96270751953125, 'l1_loss': 487.86444091796875, 'l2_loss': 182.9108428955078, 'ortho_loss': 0.5372857451438904, 'condition_number': 33316.86328125}
Step 4600: {'loss': 201.91033935546875, 'l1_loss': 487.5742492675781, 'l2_loss': 181.87779235839844, 'ortho_loss': 0.5295735597610474, 'condition_number': 12881.6279296875}
Step 4700: {'loss': 201.28720092773438, 'l1_loss': 507.197021484375, 'l2_loss': 180.41937255859375, 'ortho_loss': 0.5799578428268433, 'condition_number': 9823.060546875}
Step 4800: {'loss': 201.1339569091797, 'l1_loss': 496.97943115234375, 'l2_loss': 180.6981658935547, 'ortho_loss': 0.5566172003746033, 'condition_number': 3683.55908203125}

 training complete! 

all info: /gpfs/radev/project/lafferty/tl784/free_PhD_labor/results/sae_variants/20250127_135437_Orthogonal_sae/run_2/final_info.json

Running absorption evaluation...
Loaded pretrained model google/gemma-2-2b into HookedTransformer
[PosixPath('/gpfs/radev/project/lafferty/tl784/free_PhD_labor/artifacts/absorption/k_sparse_probing/google/gemma-2-2b_layer_19_sae_custom_sae/layer_19_google/gemma-2-2b_layer_19_sae_custom_sae_metrics.parquet')] exist(s), loading from disk
[PosixPath('/gpfs/radev/project/lafferty/tl784/free_PhD_labor/artifacts/absorption/feature_absorption/google/gemma-2-2b_layer_19_sae_custom_sae/layer_19_google/gemma-2-2b_layer_19_sae_custom_sae.parquet')] exist(s), loading from disk

Running core evaluation...
Using device: cuda
Loaded pretrained model google/gemma-2-2b into HookedTransformer
Saved evaluation results to: run_2/google_gemma-2-2b_layer_19_sae_custom_sae_eval_results.json

Running scr_and_tpp evaluation...
Loaded pretrained model google/gemma-2-2b into HookedTransformer
Loading activations from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/LabHC_bias_in_bios_class_set1_professor_nurse_activations.pt
Loading probes from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/LabHC_bias_in_bios_class_set1_professor_nurse_probes.pkl
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.8970000147819519, scr_score: -0.014926076865114633
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.8970000147819519, scr_score: -0.014926076865114633
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.89000004529953, scr_score: -0.11940327718929286
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.831000030040741, scr_score: -1.0000008896219374
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.8050000667572021, scr_score: -1.388060206054233
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.7890000343322754, scr_score: -1.6268667604328189
dir: 1, original_acc: 0.8980000615119934, clean_acc: 0.9650000333786011, changed_acc: 0.7870000600814819, scr_score: -1.6567171349191734
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6390000581741333, scr_score: 0.1085859581701857
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6500000357627869, scr_score: 0.13636367741366434
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6830000281333923, scr_score: 0.21969698566086945
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6920000314712524, scr_score: 0.24242426522981353
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6930000185966492, scr_score: 0.2449494850670808
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.7000000476837158, scr_score: 0.2626263249614903
dir: 2, original_acc: 0.5960000157356262, clean_acc: 0.9920000433921814, changed_acc: 0.6970000267028809, scr_score: 0.2550505149329192
Loading activations from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/LabHC_bias_in_bios_class_set1_architect_journalist_activations.pt
Loading probes from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/LabHC_bias_in_bios_class_set1_architect_journalist_probes.pkl
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8390000462532043, scr_score: -0.05454528706135051
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8490000367164612, scr_score: 0.0363637053276792
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8470000624656677, scr_score: 0.018182123594007893
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8490000367164612, scr_score: 0.0363637053276792
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8330000638961792, scr_score: -0.10909057412270103
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8270000219345093, scr_score: -0.16363640304438812
dir: 1, original_acc: 0.8450000286102295, clean_acc: 0.9550000429153442, changed_acc: 0.8090000152587891, scr_score: -0.32727280608877624
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6550000309944153, scr_score: 0.017595255120973825
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6600000262260437, scr_score: 0.03225799685406354
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6710000038146973, scr_score: 0.06451599370812708
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6580000519752502, scr_score: 0.026392970078295327
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6780000329017639, scr_score: 0.0850439370106542
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6700000166893005, scr_score: 0.061583480320242974
dir: 2, original_acc: 0.6490000486373901, clean_acc: 0.9900000691413879, changed_acc: 0.6830000281333923, scr_score: 0.09970667874374392
Loading activations from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/LabHC_bias_in_bios_class_set1_surgeon_psychologist_activations.pt
Loading probes from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/LabHC_bias_in_bios_class_set1_surgeon_psychologist_probes.pkl
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.9170000553131104, scr_score: 0.01818158173367131
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.9200000166893005, scr_score: 0.07272632693468524
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.9020000696182251, scr_score: -0.2545453954334178
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.8940000534057617, scr_score: -0.4000002167441346
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.8810000419616699, scr_score: -0.6363640304438811
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.878000020980835, scr_score: -0.6909098593655683
dir: 1, original_acc: 0.9160000681877136, clean_acc: 0.971000075340271, changed_acc: 0.8690000176429749, scr_score: -0.8545462624099563
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.5890000462532043, scr_score: 0.02211303002917113
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.5980000495910645, scr_score: 0.04422606005834226
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.6010000109672546, scr_score: 0.051596972435561446
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.5920000076293945, scr_score: 0.02948394240639032
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.6100000143051147, scr_score: 0.07371000246473258
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.6130000352859497, scr_score: 0.08108106129070855
dir: 2, original_acc: 0.5800000429153442, clean_acc: 0.987000048160553, changed_acc: 0.6230000257492065, scr_score: 0.10565106211228607
Loading activations from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/LabHC_bias_in_bios_class_set1_attorney_teacher_activations.pt
Loading probes from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/LabHC_bias_in_bios_class_set1_attorney_teacher_probes.pkl
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8400000333786011, scr_score: 0.0
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8410000205039978, scr_score: 0.007751837694252218
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8440000414848328, scr_score: 0.031007812828489724
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.8270000219345093, scr_score: -0.10077527617972139
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.7730000615119934, scr_score: -0.5193795942356305
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.7690000534057617, scr_score: -0.5503874070641203
dir: 1, original_acc: 0.8400000333786011, clean_acc: 0.9690000414848328, changed_acc: 0.7590000629425049, scr_score: -0.6279067081096041
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.6760000586509705, scr_score: 0.04776128538202481
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.703000009059906, scr_score: 0.12835814309667978
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.7230000495910645, scr_score: 0.1880597498242108
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.7290000319480896, scr_score: 0.20597014288032386
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.7300000190734863, scr_score: 0.20895517873562727
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.7320000529289246, scr_score: 0.21492542837052664
dir: 2, original_acc: 0.6600000262260437, clean_acc: 0.9950000643730164, changed_acc: 0.7360000610351562, scr_score: 0.22686574971603282
Loading activations from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/canrager_amazon_reviews_mcauley_1and5_Books_CDs_and_Vinyl_activations.pt
Loading probes from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/canrager_amazon_reviews_mcauley_1and5_Books_CDs_and_Vinyl_probes.pkl
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8390000462532043, scr_score: 0.09036135493558749
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8360000252723694, scr_score: 0.07228894032282736
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8360000252723694, scr_score: 0.07228894032282736
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8280000686645508, scr_score: 0.02409643312897798
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8270000219345093, scr_score: 0.018072055548653546
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8210000395774841, scr_score: -0.018072414612760133
dir: 1, original_acc: 0.8240000605583191, clean_acc: 0.9900000691413879, changed_acc: 0.8370000123977661, scr_score: 0.07831295883904521
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.6910000443458557, scr_score: 0.06934304584532767
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.6960000395774841, scr_score: 0.08759120435540294
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.7010000348091125, scr_score: 0.10583936286547818
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.6960000395774841, scr_score: 0.08759120435540294
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.687000036239624, scr_score: 0.05474447553022575
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.675000011920929, scr_score: 0.01094876458491998
dir: 2, original_acc: 0.6720000505447388, clean_acc: 0.9460000395774841, changed_acc: 0.6600000262260437, scr_score: -0.04379571094530577
Loading activations from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/canrager_amazon_reviews_mcauley_1and5_Software_Electronics_activations.pt
Loading probes from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/canrager_amazon_reviews_mcauley_1and5_Software_Electronics_probes.pkl
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8380000591278076, scr_score: 0.1705884766000953
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8390000462532043, scr_score: 0.1764707532308344
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8380000591278076, scr_score: 0.1705884766000953
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8320000171661377, scr_score: 0.13529411558461457
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8200000524520874, scr_score: 0.06470609478469928
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8230000138282776, scr_score: 0.08235292467691656
dir: 1, original_acc: 0.8090000152587891, clean_acc: 0.9790000319480896, changed_acc: 0.8010000586509705, scr_score: -0.047058563661435834
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.7110000252723694, scr_score: 0.08270681240672771
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.7200000286102295, scr_score: 0.11654140729686246
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.7270000576972961, scr_score: 0.14285730291256044
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.7310000061988831, scr_score: 0.157894701461434
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.7230000495910645, scr_score: 0.12781968028610227
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.7150000333786011, scr_score: 0.09774443503318589
dir: 2, original_acc: 0.6890000104904175, clean_acc: 0.9550000429153442, changed_acc: 0.6970000267028809, scr_score: 0.03007524525291637
Loading activations from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/canrager_amazon_reviews_mcauley_1and5_Pet_Supplies_Office_Products_activations.pt
Loading probes from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/canrager_amazon_reviews_mcauley_1and5_Pet_Supplies_Office_Products_probes.pkl
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8840000629425049, scr_score: 0.13392891829856485
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8850000500679016, scr_score: 0.14285737093604264
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8810000419616699, scr_score: 0.10714302820203199
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8770000338554382, scr_score: 0.07142868546802132
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.878000020980835, scr_score: 0.08035713810549912
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.8800000548362732, scr_score: 0.0982145755645542
dir: 1, original_acc: 0.8690000176429749, clean_acc: 0.9810000658035278, changed_acc: 0.7920000553131104, scr_score: -0.6874993680313818
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.6310000419616699, scr_score: 0.00607912922882654
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.6450000405311584, scr_score: 0.04863230915420299
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.6670000553131104, scr_score: 0.11550164365668093
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.7170000076293945, scr_score: 0.2674771568408094
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.7200000286102295, scr_score: 0.27659576009949804
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.690000057220459, scr_score: 0.18541045218902097
dir: 2, original_acc: 0.6290000081062317, clean_acc: 0.9580000638961792, changed_acc: 0.6960000395774841, scr_score: 0.20364747753729592
Loading activations from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/canrager_amazon_reviews_mcauley_1and5_Industrial_and_Scientific_Toys_and_Games_activations.pt
Loading probes from artifacts/scr/google/gemma-2-2b/blocks.19.hook_resid_post/canrager_amazon_reviews_mcauley_1and5_Industrial_and_Scientific_Toys_and_Games_probes.pkl
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7640000581741333, scr_score: 0.05288479310741072
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7610000371932983, scr_score: 0.03846161561251938
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7640000581741333, scr_score: 0.05288479310741072
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7660000324249268, scr_score: 0.06250005373014743
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7610000371932983, scr_score: 0.03846161561251938
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7590000629425049, scr_score: 0.028846354989782674
dir: 1, original_acc: 0.753000020980835, clean_acc: 0.9610000252723694, changed_acc: 0.7590000629425049, scr_score: 0.028846354989782674
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7420000433921814, scr_score: -0.004587097015857844
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7500000596046448, scr_score: 0.03211022594262151
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7590000629425049, scr_score: 0.0733946459169587
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7600000500679016, scr_score: 0.07798174293281654
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7480000257492065, scr_score: 0.02293575849509752
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7500000596046448, scr_score: 0.03211022594262151
dir: 2, original_acc: 0.7430000305175781, clean_acc: 0.9610000252723694, changed_acc: 0.7330000400543213, scr_score: -0.04587151699019504

Currently on iteration 1 of run 3
Let me analyze the results from Run 2 and update the notes and experiment plan.                                                                                                      

First, I'll update notes.txt with the comprehensive results:                                                                                                                         

notes.txt                                                                                                                                                                            

                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                      
 # Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders                                                                                        
                                                                                                                                                                                     
 # Experiment description:                                                                                                                                                           
 1. Implement adaptive orthogonality loss with controlled feature sharing                                                                                                            
 2. Add batch-wise feature grouping with periodic updates                                                                                                                            
 3. Train on Gemma-2b using standard datasets                                                                                                                                        
 4. Compare unlearning performance against baseline and fixed orthogonal SAE                                                                                                         
 5. Analyze condition numbers of feature subspaces                                                                                                                                   
 6. Evaluate impact of different α values for controlled sharing                                                                                                                     
                                                                                                                                                                                     
 ## Run 2: Orthogonal Implementation with α=0.1                                                                                                                                      
 Added orthogonality constraints with α=0.1 (controlled feature sharing):                                                                                                            
 - L0 sparsity: 61.99                                                                                                                                                                
 - Explained variance: 0.293                                                                                                                                                         
 - Mean absorption score: 0.0101                                                                                                                                                     
 - Higher SCR metrics indicating better feature separation                                                                                                                           
 - Condition number tracking implemented                                                                                                                                             
 - 4 feature groups with controlled sharing                                                                                                                                          
                                                                                                                                                                                     
 Key findings:                                                                                                                                                                       
 1. Controlled feature sharing (α=0.1) improves sparsity while maintaining reconstruction                                                                                            
 2. Feature groups show clear separation in SCR evaluation                                                                                                                           
 3. Adaptive orthogonality loss helps balance group independence                                                                                                                     
 =======                                                                                                                                                                             
 # Title: Orthogonal Feature Learning for Optimal Knowledge Separation in Sparse Autoencoders                                                                                        
                                                                                                                                                                                     
 # Experiment description:                                                                                                                                                           
 1. Implement adaptive orthogonality loss with controlled feature sharing                                                                                                            
 2. Add batch-wise feature grouping with periodic updates                                                                                                                            
 3. Train on Gemma-2b using standard datasets                                                                                                                                        
 4. Compare unlearning performance against baseline and fixed orthogonal SAE                                                                                                         
 5. Analyze condition numbers of feature subspaces                                                                                                                                   
 6. Evaluate impact of different α values for controlled sharing                                                                                                                     
                                                                                                                                                                                     
 ## Run 2: Orthogonal Implementation with α=0.1                                                                                                                                      
 Implementation details:                                                                                                                                                             
 - Layer 19 of Gemma-2b model                                                                                                                                                        
 - 4 feature groups with controlled sharing (α=0.1)                                                                                                                                  
 - Adaptive orthogonality loss with warmup                                                                                                                                           
 - Dictionary size: 2304 features                                                                                                                                                    
 - Training tokens: 10M                                                                                                                                                              
 - Batch size: 2048                                                                                                                                                                  
                                                                                                                                                                                     
 Results:                                                                                                                                                                            
 1. Reconstruction Quality:                                                                                                                                                          
 - Explained variance: 0.295 (29.5%)                                                                                                                                                 
 - MSE: 19.125                                                                                                                                                                       
 - Cosine similarity: 0.762                                                                                                                                                          
                                                                                                                                                                                     
 2. Sparsity Metrics:                                                                                                                                                                
 - L0 sparsity: 57.29                                                                                                                                                                
 - L1 norm: 442.0                                                                                                                                                                    
 - Relative reconstruction bias: 0.938                                                                                                                                               
                                                                                                                                                                                     
 3. Feature Independence:                                                                                                                                                            
 - Mean absorption score: 0.0101                                                                                                                                                     
 - Condition number tracked throughout training                                                                                                                                      
 - SCR metrics show improved feature separation:                                                                                                                                     
   * SCR@2: 0.044                                                                                                                                                                    
   * SCR@5: 0.078                                                                                                                                                                    
   * SCR@10: 0.120                                                                                                                                                                   
   * SCR@20: 0.137                                                                                                                                                                   
                                                                                                                                                                                     
 4. Model Behavior Preservation:                                                                                                                                                     
 - KL divergence score: 0.786                                                                                                                                                        
 - Cross-entropy loss score: 0.780                                                                                                                                                   
 - L2 norm ratio (out/in): 0.715                                                                                                                                                     
                                                                                                                                                                                     
 Key findings:                                                                                                                                                                       
 1. Controlled feature sharing (α=0.1) successfully balances independence and reconstruction                                                                                         
 2. Feature groups maintain distinct functionalities (high SCR scores)                                                                                                               
 3. Adaptive orthogonality loss effectively manages group separation                                                                                                                 
 4. Good preservation of model behavior while achieving sparsity                                                                                                                     
 5. Lower absorption scores suggest better feature disentanglement                                                                                                                   
                                                                                                                                                                                     
 Next steps:                                                                                                                                                                         
 Proceed with Run 3 to evaluate α=0.05 for comparison of stricter orthogonality constraints                                                                                          
 >>>>>>> REPLACE                                                                                                                                                                     
                                                                                                                                                                                     

For Run 3, we'll decrease α to 0.05 to evaluate stricter orthogonality constraints. Here's the change needed:                                                                        

experiment.py                                                                                                                                                                        

                                                                                                                                                                                     
 <<<<<<< SEARCH                                                                                                                                                                      
         self.alpha = 0.1  # Allow controlled feature sharing                                                                                                                        
 =======                                                                                                                                                                             
         self.alpha = 0.05  # Stricter orthogonality constraints                                                                                                                     
 >>>>>>> REPLACE                                                                                                                                                                     
                                                                                                                                                                                     

This change will help us understand how stricter orthogonality constraints affect:                                                                                                   

 1 Feature independence (through absorption scores)                                                                                                                                  
 2 Reconstruction quality                                                                                                                                                            
 3 SCR metrics                                                                                                                                                                       
 4 Model behavior preservation                                                                                                                                                       

You can proceed with:                                                                                                                                                                

                                                                                                                                                                                     
 python experiment.py --out_dir=run_3                                                                                                                                                
                                                                                                                                                                                     

Tokens: 20k sent, 1.0k received. Cost: $0.08 message, $0.67 session.
Applied edit to experiment.py
Applied edit to notes.txt

python experiment.py --out_dir=run_3
