Step 0: 45201.3515625
Step 100: 17867.94921875
Step 200: 7436.71630859375
Step 300: 6014.72900390625
Step 400: 5552.689453125
Step 500: 5374.3671875
Step 600: 4985.63916015625
Step 700: 4973.31884765625
Step 800: 4770.26953125
Step 900: 4748.81005859375
Step 1000: 4609.97216796875
Step 1100: 4628.81640625
Step 1200: 4493.0498046875
Step 1300: 4416.16552734375
Step 1400: 4539.93359375
Step 1500: 4628.9501953125
Step 1600: 4460.7802734375
Step 1700: 4390.10546875
Step 1800: 4443.1259765625
Step 1900: 4565.4130859375
Step 2000: 4358.8544921875
Step 2100: 4361.8056640625
Step 2200: 4426.72021484375
Step 2300: 4361.42578125
Step 2400: 4384.0478515625

 training complete! 

all info: /gpfs/radev/project/lafferty/tl784/free_PhD_labor/templates/orthogonal/run_0/final_info.json

[2025-02-06 18:22:09]  

Running absorption evaluation...
Loaded pretrained model google/gemma-2-2b into HookedTransformer
Loading probe and training data
Training k-sparse probes
Loading validation data
Evaluating raw k-sparse probing scores
Building metadata
Time spent on absorption: 1322.24s

[2025-02-06 18:44:11]  

Running core evaluation...
Using device: cuda
Loaded pretrained model google/gemma-2-2b into HookedTransformer
Saved evaluation results to: run_0/google_gemma-2-2b_layer_12_sae_custom_sae_eval_results.json
Time spent on core: 442.45s

[2025-02-06 18:51:33]  

Running sparse_probing evaluation...
Loaded pretrained model google/gemma-2-2b into HookedTransformer
Removing 24 from test set
Removing 12 from test set
Num non-zero elements: 2304
Test accuracy for 0: 0.937
Num non-zero elements: 2304
Test accuracy for 1: 0.952
Num non-zero elements: 2304
Test accuracy for 2: 0.942
Num non-zero elements: 2304
Test accuracy for 6: 0.988
Num non-zero elements: 2304
Test accuracy for 9: 0.981
Num non-zero elements: 1
Test accuracy for 0: 0.57
Num non-zero elements: 1
Test accuracy for 1: 0.629
Num non-zero elements: 1
Test accuracy for 2: 0.686
Num non-zero elements: 1
Test accuracy for 6: 0.783
Num non-zero elements: 1
Test accuracy for 9: 0.55
Num non-zero elements: 2
Test accuracy for 0: 0.581
Num non-zero elements: 2
Test accuracy for 1: 0.659
Num non-zero elements: 2
Test accuracy for 2: 0.713
Num non-zero elements: 2
Test accuracy for 6: 0.803
Num non-zero elements: 2
Test accuracy for 9: 0.7
Num non-zero elements: 5
Test accuracy for 0: 0.724
Num non-zero elements: 5
Test accuracy for 1: 0.699
Num non-zero elements: 5
Test accuracy for 2: 0.763
Num non-zero elements: 5
Test accuracy for 6: 0.904
Num non-zero elements: 5
Test accuracy for 9: 0.87
Num non-zero elements: 10
Test accuracy for 0: 0.783
Num non-zero elements: 10
Test accuracy for 1: 0.796
Num non-zero elements: 10
Test accuracy for 2: 0.802
Num non-zero elements: 10
Test accuracy for 6: 0.885
Num non-zero elements: 10
Test accuracy for 9: 0.901
Num non-zero elements: 20
Test accuracy for 0: 0.816
Num non-zero elements: 20
Test accuracy for 1: 0.881
Num non-zero elements: 20
Test accuracy for 2: 0.878
Num non-zero elements: 20
Test accuracy for 6: 0.974
Num non-zero elements: 20
Test accuracy for 9: 0.936
Num non-zero elements: 50
Test accuracy for 0: 0.909
Num non-zero elements: 50
Test accuracy for 1: 0.924
Num non-zero elements: 50
Test accuracy for 2: 0.92
Num non-zero elements: 50
Test accuracy for 6: 0.982
Num non-zero elements: 50
Test accuracy for 9: 0.954
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 0: 0.9420000314712524
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 1: 0.9620000720024109
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 2: 0.9540000557899475
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 6: 0.984000027179718
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 9: 0.971000075340271
Num non-zero elements: 1
Test accuracy for 0: 0.71
Num non-zero elements: 1
Test accuracy for 1: 0.668
Num non-zero elements: 1
Test accuracy for 2: 0.857
Num non-zero elements: 1
Test accuracy for 6: 0.974
Num non-zero elements: 1
Test accuracy for 9: 0.945
Num non-zero elements: 2
Test accuracy for 0: 0.723
Num non-zero elements: 2
Test accuracy for 1: 0.822
Num non-zero elements: 2
Test accuracy for 2: 0.865
Num non-zero elements: 2
Test accuracy for 6: 0.979
Num non-zero elements: 2
Test accuracy for 9: 0.942
Num non-zero elements: 5
Test accuracy for 0: 0.762
Num non-zero elements: 5
Test accuracy for 1: 0.846
Num non-zero elements: 5
Test accuracy for 2: 0.875
Num non-zero elements: 5
Test accuracy for 6: 0.988
Num non-zero elements: 5
Test accuracy for 9: 0.956
Num non-zero elements: 10
Test accuracy for 0: 0.796
Num non-zero elements: 10
Test accuracy for 1: 0.844
Num non-zero elements: 10
Test accuracy for 2: 0.92
Num non-zero elements: 10
Test accuracy for 6: 0.986
Num non-zero elements: 10
Test accuracy for 9: 0.948
Num non-zero elements: 20
Test accuracy for 0: 0.899
Num non-zero elements: 20
Test accuracy for 1: 0.951
Num non-zero elements: 20
Test accuracy for 2: 0.935
Num non-zero elements: 20
Test accuracy for 6: 0.991
Num non-zero elements: 20
Test accuracy for 9: 0.958
Num non-zero elements: 50
Test accuracy for 0: 0.926
Num non-zero elements: 50
Test accuracy for 1: 0.956
Num non-zero elements: 50
Test accuracy for 2: 0.944
Num non-zero elements: 50
Test accuracy for 6: 0.992
Num non-zero elements: 50
Test accuracy for 9: 0.974
Removing 24 from test set
Removing 12 from test set
Num non-zero elements: 2304
Test accuracy for 11: 0.951
Num non-zero elements: 2304
Test accuracy for 13: 0.956
Num non-zero elements: 2304
Test accuracy for 14: 0.948
Num non-zero elements: 2304
Test accuracy for 18: 0.914
Num non-zero elements: 2304
Test accuracy for 19: 0.958
Num non-zero elements: 1
Test accuracy for 11: 0.555
Num non-zero elements: 1
Test accuracy for 13: 0.671
Num non-zero elements: 1
Test accuracy for 14: 0.64
Num non-zero elements: 1
Test accuracy for 18: 0.701
Num non-zero elements: 1
Test accuracy for 19: 0.795
Num non-zero elements: 2
Test accuracy for 11: 0.764
Num non-zero elements: 2
Test accuracy for 13: 0.724
Num non-zero elements: 2
Test accuracy for 14: 0.681
Num non-zero elements: 2
Test accuracy for 18: 0.737
Num non-zero elements: 2
Test accuracy for 19: 0.773
Num non-zero elements: 5
Test accuracy for 11: 0.782
Num non-zero elements: 5
Test accuracy for 13: 0.75
Num non-zero elements: 5
Test accuracy for 14: 0.727
Num non-zero elements: 5
Test accuracy for 18: 0.728
Num non-zero elements: 5
Test accuracy for 19: 0.825
Num non-zero elements: 10
Test accuracy for 11: 0.847
Num non-zero elements: 10
Test accuracy for 13: 0.79
Num non-zero elements: 10
Test accuracy for 14: 0.774
Num non-zero elements: 10
Test accuracy for 18: 0.747
Num non-zero elements: 10
Test accuracy for 19: 0.855
Num non-zero elements: 20
Test accuracy for 11: 0.915
Num non-zero elements: 20
Test accuracy for 13: 0.868
Num non-zero elements: 20
Test accuracy for 14: 0.889
Num non-zero elements: 20
Test accuracy for 18: 0.763
Num non-zero elements: 20
Test accuracy for 19: 0.896
Num non-zero elements: 50
Test accuracy for 11: 0.937
Num non-zero elements: 50
Test accuracy for 13: 0.917
Num non-zero elements: 50
Test accuracy for 14: 0.902
Num non-zero elements: 50
Test accuracy for 18: 0.834
Num non-zero elements: 50
Test accuracy for 19: 0.931
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for 11: 0.9530000686645508
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 13: 0.9450000524520874
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 14: 0.9390000700950623
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 18: 0.9080000519752502
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 19: 0.9610000252723694
Num non-zero elements: 1
Test accuracy for 11: 0.734
Num non-zero elements: 1
Test accuracy for 13: 0.708
Num non-zero elements: 1
Test accuracy for 14: 0.87
Num non-zero elements: 1
Test accuracy for 18: 0.726
Num non-zero elements: 1
Test accuracy for 19: 0.846
Num non-zero elements: 2
Test accuracy for 11: 0.906
Num non-zero elements: 2
Test accuracy for 13: 0.724
Num non-zero elements: 2
Test accuracy for 14: 0.882
Num non-zero elements: 2
Test accuracy for 18: 0.724
Num non-zero elements: 2
Test accuracy for 19: 0.841
Num non-zero elements: 5
Test accuracy for 11: 0.933
Num non-zero elements: 5
Test accuracy for 13: 0.814
Num non-zero elements: 5
Test accuracy for 14: 0.876
Num non-zero elements: 5
Test accuracy for 18: 0.728
Num non-zero elements: 5
Test accuracy for 19: 0.892
Num non-zero elements: 10
Test accuracy for 11: 0.938
Num non-zero elements: 10
Test accuracy for 13: 0.867
Num non-zero elements: 10
Test accuracy for 14: 0.87
Num non-zero elements: 10
Test accuracy for 18: 0.926
Num non-zero elements: 10
Test accuracy for 19: 0.91
Num non-zero elements: 20
Test accuracy for 11: 0.955
Num non-zero elements: 20
Test accuracy for 13: 0.929
Num non-zero elements: 20
Test accuracy for 14: 0.893
Num non-zero elements: 20
Test accuracy for 18: 0.928
Num non-zero elements: 20
Test accuracy for 19: 0.918
Num non-zero elements: 50
Test accuracy for 11: 0.955
Num non-zero elements: 50
Test accuracy for 13: 0.93
Num non-zero elements: 50
Test accuracy for 14: 0.92
Num non-zero elements: 50
Test accuracy for 18: 0.931
Num non-zero elements: 50
Test accuracy for 19: 0.937
Removing 24 from test set
Removing 12 from test set
Num non-zero elements: 2304
Test accuracy for 20: 0.941
Num non-zero elements: 2304
Test accuracy for 21: 0.906
Num non-zero elements: 2304
Test accuracy for 22: 0.893
Num non-zero elements: 2304
Test accuracy for 25: 0.962
Num non-zero elements: 2304
Test accuracy for 26: 0.853
Num non-zero elements: 1
Test accuracy for 20: 0.698
Num non-zero elements: 1
Test accuracy for 21: 0.763
Num non-zero elements: 1
Test accuracy for 22: 0.639
Num non-zero elements: 1
Test accuracy for 25: 0.693
Num non-zero elements: 1
Test accuracy for 26: 0.632
Num non-zero elements: 2
Test accuracy for 20: 0.809
Num non-zero elements: 2
Test accuracy for 21: 0.764
Num non-zero elements: 2
Test accuracy for 22: 0.693
Num non-zero elements: 2
Test accuracy for 25: 0.777
Num non-zero elements: 2
Test accuracy for 26: 0.676
Num non-zero elements: 5
Test accuracy for 20: 0.862
Num non-zero elements: 5
Test accuracy for 21: 0.781
Num non-zero elements: 5
Test accuracy for 22: 0.711
Num non-zero elements: 5
Test accuracy for 25: 0.797
Num non-zero elements: 5
Test accuracy for 26: 0.658
Num non-zero elements: 10
Test accuracy for 20: 0.87
Num non-zero elements: 10
Test accuracy for 21: 0.823
Num non-zero elements: 10
Test accuracy for 22: 0.736
Num non-zero elements: 10
Test accuracy for 25: 0.839
Num non-zero elements: 10
Test accuracy for 26: 0.699
Num non-zero elements: 20
Test accuracy for 20: 0.899
Num non-zero elements: 20
Test accuracy for 21: 0.83
Num non-zero elements: 20
Test accuracy for 22: 0.805
Num non-zero elements: 20
Test accuracy for 25: 0.903
Num non-zero elements: 20
Test accuracy for 26: 0.818
Num non-zero elements: 50
Test accuracy for 20: 0.923
Num non-zero elements: 50
Test accuracy for 21: 0.876
Num non-zero elements: 50
Test accuracy for 22: 0.875
Num non-zero elements: 50
Test accuracy for 25: 0.92
Num non-zero elements: 50
Test accuracy for 26: 0.846
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 20: 0.9540000557899475
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 21 epochs
Test accuracy for 21: 0.9310000538825989
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 22: 0.9040000438690186
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for 25: 0.9480000734329224
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 20 epochs
Test accuracy for 26: 0.8880000710487366
Num non-zero elements: 1
Test accuracy for 20: 0.885
Num non-zero elements: 1
Test accuracy for 21: 0.798
Num non-zero elements: 1
Test accuracy for 22: 0.885
Num non-zero elements: 1
Test accuracy for 25: 0.868
Num non-zero elements: 1
Test accuracy for 26: 0.719
Num non-zero elements: 2
Test accuracy for 20: 0.892
Num non-zero elements: 2
Test accuracy for 21: 0.812
Num non-zero elements: 2
Test accuracy for 22: 0.878
Num non-zero elements: 2
Test accuracy for 25: 0.87
Num non-zero elements: 2
Test accuracy for 26: 0.772
Num non-zero elements: 5
Test accuracy for 20: 0.91
Num non-zero elements: 5
Test accuracy for 21: 0.849
Num non-zero elements: 5
Test accuracy for 22: 0.882
Num non-zero elements: 5
Test accuracy for 25: 0.887
Num non-zero elements: 5
Test accuracy for 26: 0.835
Num non-zero elements: 10
Test accuracy for 20: 0.92
Num non-zero elements: 10
Test accuracy for 21: 0.867
Num non-zero elements: 10
Test accuracy for 22: 0.893
Num non-zero elements: 10
Test accuracy for 25: 0.923
Num non-zero elements: 10
Test accuracy for 26: 0.83
Num non-zero elements: 20
Test accuracy for 20: 0.935
Num non-zero elements: 20
Test accuracy for 21: 0.865
Num non-zero elements: 20
Test accuracy for 22: 0.897
Num non-zero elements: 20
Test accuracy for 25: 0.938
Num non-zero elements: 20
Test accuracy for 26: 0.858
Num non-zero elements: 50
Test accuracy for 20: 0.935
Num non-zero elements: 50
Test accuracy for 21: 0.887
Num non-zero elements: 50
Test accuracy for 22: 0.905
Num non-zero elements: 50
Test accuracy for 25: 0.953
Num non-zero elements: 50
Test accuracy for 26: 0.873
Removing 31 from train set
Removing 28 from train set
Removing 29 from train set
Removing 0 from train set
Removing 7 from train set
Num non-zero elements: 2304
Test accuracy for 1: 0.939
Num non-zero elements: 2304
Test accuracy for 2: 0.915
Num non-zero elements: 2304
Test accuracy for 3: 0.898
Num non-zero elements: 2304
Test accuracy for 5: 0.899
Num non-zero elements: 2304
Test accuracy for 6: 0.831
Num non-zero elements: 1
Test accuracy for 1: 0.656
Num non-zero elements: 1
Test accuracy for 2: 0.589
Num non-zero elements: 1
Test accuracy for 3: 0.594
Num non-zero elements: 1
Test accuracy for 5: 0.565
Num non-zero elements: 1
Test accuracy for 6: 0.608
Num non-zero elements: 2
Test accuracy for 1: 0.742
Num non-zero elements: 2
Test accuracy for 2: 0.642
Num non-zero elements: 2
Test accuracy for 3: 0.591
Num non-zero elements: 2
Test accuracy for 5: 0.599
Num non-zero elements: 2
Test accuracy for 6: 0.625
Num non-zero elements: 5
Test accuracy for 1: 0.765
Num non-zero elements: 5
Test accuracy for 2: 0.637
Num non-zero elements: 5
Test accuracy for 3: 0.611
Num non-zero elements: 5
Test accuracy for 5: 0.642
Num non-zero elements: 5
Test accuracy for 6: 0.678
Num non-zero elements: 10
Test accuracy for 1: 0.778
Num non-zero elements: 10
Test accuracy for 2: 0.782
Num non-zero elements: 10
Test accuracy for 3: 0.755
Num non-zero elements: 10
Test accuracy for 5: 0.724
Num non-zero elements: 10
Test accuracy for 6: 0.707
Num non-zero elements: 20
Test accuracy for 1: 0.881
Num non-zero elements: 20
Test accuracy for 2: 0.836
Num non-zero elements: 20
Test accuracy for 3: 0.774
Num non-zero elements: 20
Test accuracy for 5: 0.82
Num non-zero elements: 20
Test accuracy for 6: 0.758
Num non-zero elements: 50
Test accuracy for 1: 0.924
Num non-zero elements: 50
Test accuracy for 2: 0.881
Num non-zero elements: 50
Test accuracy for 3: 0.844
Num non-zero elements: 50
Test accuracy for 5: 0.857
Num non-zero elements: 50
Test accuracy for 6: 0.777
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 1: 0.9420000314712524
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 28 epochs
Test accuracy for 2: 0.9220000505447388
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 22 epochs
Test accuracy for 3: 0.9120000600814819
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 19 epochs
Test accuracy for 5: 0.9130000472068787
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 6: 0.8490000367164612
Num non-zero elements: 1
Test accuracy for 1: 0.863
Num non-zero elements: 1
Test accuracy for 2: 0.811
Num non-zero elements: 1
Test accuracy for 3: 0.607
Num non-zero elements: 1
Test accuracy for 5: 0.589
Num non-zero elements: 1
Test accuracy for 6: 0.658
Num non-zero elements: 2
Test accuracy for 1: 0.883
Num non-zero elements: 2
Test accuracy for 2: 0.804
Num non-zero elements: 2
Test accuracy for 3: 0.661
Num non-zero elements: 2
Test accuracy for 5: 0.873
Num non-zero elements: 2
Test accuracy for 6: 0.734
Num non-zero elements: 5
Test accuracy for 1: 0.922
Num non-zero elements: 5
Test accuracy for 2: 0.821
Num non-zero elements: 5
Test accuracy for 3: 0.748
Num non-zero elements: 5
Test accuracy for 5: 0.864
Num non-zero elements: 5
Test accuracy for 6: 0.735
Num non-zero elements: 10
Test accuracy for 1: 0.933
Num non-zero elements: 10
Test accuracy for 2: 0.892
Num non-zero elements: 10
Test accuracy for 3: 0.824
Num non-zero elements: 10
Test accuracy for 5: 0.874
Num non-zero elements: 10
Test accuracy for 6: 0.752
Num non-zero elements: 20
Test accuracy for 1: 0.929
Num non-zero elements: 20
Test accuracy for 2: 0.903
Num non-zero elements: 20
Test accuracy for 3: 0.86
Num non-zero elements: 20
Test accuracy for 5: 0.878
Num non-zero elements: 20
Test accuracy for 6: 0.784
Num non-zero elements: 50
Test accuracy for 1: 0.924
Num non-zero elements: 50
Test accuracy for 2: 0.901
Num non-zero elements: 50
Test accuracy for 3: 0.89
Num non-zero elements: 50
Test accuracy for 5: 0.896
Num non-zero elements: 50
Test accuracy for 6: 0.804
Num non-zero elements: 2304
Test accuracy for 1.0: 0.982
Num non-zero elements: 2304
Test accuracy for 5.0: 0.982
Num non-zero elements: 1
Test accuracy for 1.0: 0.673
Num non-zero elements: 1
Test accuracy for 5.0: 0.673
Num non-zero elements: 2
Test accuracy for 1.0: 0.724
Num non-zero elements: 2
Test accuracy for 5.0: 0.724
Num non-zero elements: 5
Test accuracy for 1.0: 0.766
Num non-zero elements: 5
Test accuracy for 5.0: 0.766
Num non-zero elements: 10
Test accuracy for 1.0: 0.826
Num non-zero elements: 10
Test accuracy for 5.0: 0.826
Num non-zero elements: 20
Test accuracy for 1.0: 0.848
Num non-zero elements: 20
Test accuracy for 5.0: 0.848
Num non-zero elements: 50
Test accuracy for 1.0: 0.932
Num non-zero elements: 50
Test accuracy for 5.0: 0.932
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for 1.0: 0.9630000591278076
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 17 epochs
Test accuracy for 5.0: 0.9620000720024109
Num non-zero elements: 1
Test accuracy for 1.0: 0.649
Num non-zero elements: 1
Test accuracy for 5.0: 0.649
Num non-zero elements: 2
Test accuracy for 1.0: 0.813
Num non-zero elements: 2
Test accuracy for 5.0: 0.813
Num non-zero elements: 5
Test accuracy for 1.0: 0.875
Num non-zero elements: 5
Test accuracy for 5.0: 0.875
Num non-zero elements: 10
Test accuracy for 1.0: 0.928
Num non-zero elements: 10
Test accuracy for 5.0: 0.928
Num non-zero elements: 20
Test accuracy for 1.0: 0.935
Num non-zero elements: 20
Test accuracy for 5.0: 0.935
Num non-zero elements: 50
Test accuracy for 1.0: 0.953
Num non-zero elements: 50
Test accuracy for 5.0: 0.953
Loading dataset codeparrot/github-code, this usually takes ~30 seconds
Num non-zero elements: 2304
Test accuracy for C: 0.947
Num non-zero elements: 2304
Test accuracy for Python: 0.985
Num non-zero elements: 2304
Test accuracy for HTML: 0.979
Num non-zero elements: 2304
Test accuracy for Java: 0.97
Num non-zero elements: 2304
Test accuracy for PHP: 0.95
Num non-zero elements: 1
Test accuracy for C: 0.644
Num non-zero elements: 1
Test accuracy for Python: 0.657
Num non-zero elements: 1
Test accuracy for HTML: 0.793
Num non-zero elements: 1
Test accuracy for Java: 0.645
Num non-zero elements: 1
Test accuracy for PHP: 0.591
Num non-zero elements: 2
Test accuracy for C: 0.664
Num non-zero elements: 2
Test accuracy for Python: 0.666
Num non-zero elements: 2
Test accuracy for HTML: 0.802
Num non-zero elements: 2
Test accuracy for Java: 0.678
Num non-zero elements: 2
Test accuracy for PHP: 0.64
Num non-zero elements: 5
Test accuracy for C: 0.745
Num non-zero elements: 5
Test accuracy for Python: 0.723
Num non-zero elements: 5
Test accuracy for HTML: 0.895
Num non-zero elements: 5
Test accuracy for Java: 0.732
Num non-zero elements: 5
Test accuracy for PHP: 0.712
Num non-zero elements: 10
Test accuracy for C: 0.793
Num non-zero elements: 10
Test accuracy for Python: 0.747
Num non-zero elements: 10
Test accuracy for HTML: 0.952
Num non-zero elements: 10
Test accuracy for Java: 0.787
Num non-zero elements: 10
Test accuracy for PHP: 0.741
Num non-zero elements: 20
Test accuracy for C: 0.859
Num non-zero elements: 20
Test accuracy for Python: 0.844
Num non-zero elements: 20
Test accuracy for HTML: 0.961
Num non-zero elements: 20
Test accuracy for Java: 0.831
Num non-zero elements: 20
Test accuracy for PHP: 0.816
Num non-zero elements: 50
Test accuracy for C: 0.909
Num non-zero elements: 50
Test accuracy for Python: 0.946
Num non-zero elements: 50
Test accuracy for HTML: 0.966
Num non-zero elements: 50
Test accuracy for Java: 0.902
Num non-zero elements: 50
Test accuracy for PHP: 0.892
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for C: 0.9530000686645508
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for Python: 0.987000048160553
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for HTML: 0.9920000433921814
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for Java: 0.956000030040741
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 27 epochs
Test accuracy for PHP: 0.956000030040741
Num non-zero elements: 1
Test accuracy for C: 0.599
Num non-zero elements: 1
Test accuracy for Python: 0.593
Num non-zero elements: 1
Test accuracy for HTML: 0.572
Num non-zero elements: 1
Test accuracy for Java: 0.651
Num non-zero elements: 1
Test accuracy for PHP: 0.606
Num non-zero elements: 2
Test accuracy for C: 0.604
Num non-zero elements: 2
Test accuracy for Python: 0.617
Num non-zero elements: 2
Test accuracy for HTML: 0.587
Num non-zero elements: 2
Test accuracy for Java: 0.713
Num non-zero elements: 2
Test accuracy for PHP: 0.63
Num non-zero elements: 5
Test accuracy for C: 0.822
Num non-zero elements: 5
Test accuracy for Python: 0.935
Num non-zero elements: 5
Test accuracy for HTML: 0.911
Num non-zero elements: 5
Test accuracy for Java: 0.731
Num non-zero elements: 5
Test accuracy for PHP: 0.917
Num non-zero elements: 10
Test accuracy for C: 0.826
Num non-zero elements: 10
Test accuracy for Python: 0.94
Num non-zero elements: 10
Test accuracy for HTML: 0.95
Num non-zero elements: 10
Test accuracy for Java: 0.781
Num non-zero elements: 10
Test accuracy for PHP: 0.931
Num non-zero elements: 20
Test accuracy for C: 0.886
Num non-zero elements: 20
Test accuracy for Python: 0.945
Num non-zero elements: 20
Test accuracy for HTML: 0.951
Num non-zero elements: 20
Test accuracy for Java: 0.861
Num non-zero elements: 20
Test accuracy for PHP: 0.933
Num non-zero elements: 50
Test accuracy for C: 0.914
Num non-zero elements: 50
Test accuracy for Python: 0.978
Num non-zero elements: 50
Test accuracy for HTML: 0.966
Num non-zero elements: 50
Test accuracy for Java: 0.911
Num non-zero elements: 50
Test accuracy for PHP: 0.944
Num non-zero elements: 2304
Test accuracy for 0: 0.925
Num non-zero elements: 2304
Test accuracy for 1: 0.984
Num non-zero elements: 2304
Test accuracy for 2: 0.911
Num non-zero elements: 2304
Test accuracy for 3: 0.932
Num non-zero elements: 1
Test accuracy for 0: 0.569
Num non-zero elements: 1
Test accuracy for 1: 0.662
Num non-zero elements: 1
Test accuracy for 2: 0.655
Num non-zero elements: 1
Test accuracy for 3: 0.647
Num non-zero elements: 2
Test accuracy for 0: 0.799
Num non-zero elements: 2
Test accuracy for 1: 0.806
Num non-zero elements: 2
Test accuracy for 2: 0.681
Num non-zero elements: 2
Test accuracy for 3: 0.787
Num non-zero elements: 5
Test accuracy for 0: 0.818
Num non-zero elements: 5
Test accuracy for 1: 0.886
Num non-zero elements: 5
Test accuracy for 2: 0.768
Num non-zero elements: 5
Test accuracy for 3: 0.836
Num non-zero elements: 10
Test accuracy for 0: 0.867
Num non-zero elements: 10
Test accuracy for 1: 0.929
Num non-zero elements: 10
Test accuracy for 2: 0.797
Num non-zero elements: 10
Test accuracy for 3: 0.883
Num non-zero elements: 20
Test accuracy for 0: 0.894
Num non-zero elements: 20
Test accuracy for 1: 0.955
Num non-zero elements: 20
Test accuracy for 2: 0.858
Num non-zero elements: 20
Test accuracy for 3: 0.89
Num non-zero elements: 50
Test accuracy for 0: 0.913
Num non-zero elements: 50
Test accuracy for 1: 0.969
Num non-zero elements: 50
Test accuracy for 2: 0.895
Num non-zero elements: 50
Test accuracy for 3: 0.929
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 0: 0.9340000152587891
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 1: 0.9810000658035278
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 15 epochs
Test accuracy for 2: 0.921000063419342
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 16 epochs
Test accuracy for 3: 0.9460000395774841
Num non-zero elements: 1
Test accuracy for 0: 0.802
Num non-zero elements: 1
Test accuracy for 1: 0.926
Num non-zero elements: 1
Test accuracy for 2: 0.753
Num non-zero elements: 1
Test accuracy for 3: 0.708
Num non-zero elements: 2
Test accuracy for 0: 0.814
Num non-zero elements: 2
Test accuracy for 1: 0.947
Num non-zero elements: 2
Test accuracy for 2: 0.821
Num non-zero elements: 2
Test accuracy for 3: 0.818
Num non-zero elements: 5
Test accuracy for 0: 0.86
Num non-zero elements: 5
Test accuracy for 1: 0.971
Num non-zero elements: 5
Test accuracy for 2: 0.852
Num non-zero elements: 5
Test accuracy for 3: 0.863
Num non-zero elements: 10
Test accuracy for 0: 0.89
Num non-zero elements: 10
Test accuracy for 1: 0.976
Num non-zero elements: 10
Test accuracy for 2: 0.855
Num non-zero elements: 10
Test accuracy for 3: 0.916
Num non-zero elements: 20
Test accuracy for 0: 0.898
Num non-zero elements: 20
Test accuracy for 1: 0.979
Num non-zero elements: 20
Test accuracy for 2: 0.866
Num non-zero elements: 20
Test accuracy for 3: 0.924
Num non-zero elements: 50
Test accuracy for 0: 0.927
Num non-zero elements: 50
Test accuracy for 1: 0.973
Num non-zero elements: 50
Test accuracy for 2: 0.911
Num non-zero elements: 50
Test accuracy for 3: 0.934
Loading dataset Helsinki-NLP/europarl, this usually takes ~10 seconds
Num non-zero elements: 2304
Test accuracy for en: 0.999
Num non-zero elements: 2304
Test accuracy for fr: 1.0
Num non-zero elements: 2304
Test accuracy for de: 1.0
Num non-zero elements: 2304
Test accuracy for es: 1.0
Num non-zero elements: 2304
Test accuracy for nl: 1.0
Num non-zero elements: 1
Test accuracy for en: 0.743
Num non-zero elements: 1
Test accuracy for fr: 0.585
Num non-zero elements: 1
Test accuracy for de: 0.74
Num non-zero elements: 1
Test accuracy for es: 0.908
Num non-zero elements: 1
Test accuracy for nl: 0.646
Num non-zero elements: 2
Test accuracy for en: 0.824
Num non-zero elements: 2
Test accuracy for fr: 0.587
Num non-zero elements: 2
Test accuracy for de: 0.829
Num non-zero elements: 2
Test accuracy for es: 0.908
Num non-zero elements: 2
Test accuracy for nl: 0.753
Num non-zero elements: 5
Test accuracy for en: 0.884
Num non-zero elements: 5
Test accuracy for fr: 0.915
Num non-zero elements: 5
Test accuracy for de: 0.871
Num non-zero elements: 5
Test accuracy for es: 0.98
Num non-zero elements: 5
Test accuracy for nl: 0.86
Num non-zero elements: 10
Test accuracy for en: 0.967
Num non-zero elements: 10
Test accuracy for fr: 0.968
Num non-zero elements: 10
Test accuracy for de: 0.969
Num non-zero elements: 10
Test accuracy for es: 0.986
Num non-zero elements: 10
Test accuracy for nl: 0.91
Num non-zero elements: 20
Test accuracy for en: 0.988
Num non-zero elements: 20
Test accuracy for fr: 0.991
Num non-zero elements: 20
Test accuracy for de: 0.987
Num non-zero elements: 20
Test accuracy for es: 0.997
Num non-zero elements: 20
Test accuracy for nl: 0.987
Num non-zero elements: 50
Test accuracy for en: 0.998
Num non-zero elements: 50
Test accuracy for fr: 1.0
Num non-zero elements: 50
Test accuracy for de: 0.997
Num non-zero elements: 50
Test accuracy for es: 1.0
Num non-zero elements: 50
Test accuracy for nl: 0.994
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 13 epochs
Test accuracy for en: 0.999000072479248
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 18 epochs
Test accuracy for fr: 0.9980000257492065
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 47 epochs
Test accuracy for de: 0.9940000176429749
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 23 epochs
Test accuracy for es: 0.9950000643730164
Num non-zero elements: 16384
Training probe with dim: 16384, device: cuda:0, dtype: torch.bfloat16
GPU probe training early stopping triggered after 29 epochs
Test accuracy for nl: 0.984000027179718
Num non-zero elements: 1
Test accuracy for en: 1.0
Num non-zero elements: 1
Test accuracy for fr: 0.988
Num non-zero elements: 1
Test accuracy for de: 0.743
Num non-zero elements: 1
Test accuracy for es: 0.616
Num non-zero elements: 1
Test accuracy for nl: 0.71
Num non-zero elements: 2
Test accuracy for en: 0.998
Num non-zero elements: 2
Test accuracy for fr: 0.992
Num non-zero elements: 2
Test accuracy for de: 0.784
Num non-zero elements: 2
Test accuracy for es: 0.982
Num non-zero elements: 2
Test accuracy for nl: 0.713
Num non-zero elements: 5
Test accuracy for en: 1.0
Num non-zero elements: 5
Test accuracy for fr: 0.992
Num non-zero elements: 5
Test accuracy for de: 0.82
Num non-zero elements: 5
Test accuracy for es: 0.987
Num non-zero elements: 5
Test accuracy for nl: 0.845
Num non-zero elements: 10
Test accuracy for en: 0.999
Num non-zero elements: 10
Test accuracy for fr: 0.989
Num non-zero elements: 10
Test accuracy for de: 0.882
Num non-zero elements: 10
Test accuracy for es: 0.991
Num non-zero elements: 10
Test accuracy for nl: 0.878
Num non-zero elements: 20
Test accuracy for en: 0.997
Num non-zero elements: 20
Test accuracy for fr: 0.992
Num non-zero elements: 20
Test accuracy for de: 0.898
Num non-zero elements: 20
Test accuracy for es: 0.994
Num non-zero elements: 20
Test accuracy for nl: 0.888
Num non-zero elements: 50
Test accuracy for en: 0.999
Num non-zero elements: 50
Test accuracy for fr: 0.994
Num non-zero elements: 50
Test accuracy for de: 0.923
Num non-zero elements: 50
Test accuracy for es: 0.995
Num non-zero elements: 50
Test accuracy for nl: 0.919
Time spent on sparse_probing: 636.11s

[2025-02-06 19:02:09]  

Running unlearning evaluation...
Loaded pretrained model google/gemma-2-2b-it into HookedTransformer
Running evaluation for SAE: google/gemma-2-2b_layer_12_sae_custom_sae
Sparsity calculation for google/gemma-2-2b_layer_12_sae_custom_sae is already done
Forget sparsity: [0.00247  0.008931 0.019617 ... 0.016995 0.026815 0.001734]
(16384,)
Retain sparsity: [0.003136 0.005556 0.016277 ... 0.020147 0.033596 0.001457]
(16384,)
Starting metrics calculation...
running on datasets: ['wmdp-bio', 'high_school_us_history', 'college_computer_science', 'high_school_geography', 'human_aging']
Calculating metrics for retain threshold: 0.001
Top features for ablation: [ 1221 12897  7492  7792 15053 12264  6224 15916 11610 12193  3158  7379
  5363  2552  5102  4943  5415  2576 11204  2864 12208  5394 10138 13271
  5447  9040 14600  8491 13417  2705 15797  8367  5146 14359 11787  4625
  5278  1398  1647 10821  8911  1383  2945  3036 12057 11552  5787  2874
  2349  4350 11982   817  3109  7328 13944  7987  6137 12947 10961  3480
 11669  4335  4789  9094  4991 12650  7753  8940  5243  5917 12005 11832
 14528  8803  5484  4051  2999  9033  7701  4821 15923 12764  7473  8097
 12521  5946   889  2660  6823 16304 14044 15811  5145  3585 16303  2662
 15703  4410 10581   364  2546  4474 13088 12036 11799  6867 13991  6399
 12173  5648  8631  3314  9129  7769   846  6074  5585  4013  7225 11432
 13048  6346 14532   284 14204  3916  1923 12206  3873  8671 12827 12252
 12598  4977 14192 10024 13211  3622 12816 12260  3233 11905  5472   638
  1579 16379  9937 10744  1575 11034  4981  7528 10628  7924 15194 11996
  2655  4078  7294  9364  1975  3028 16076  2646 15679 10688 12724 15509
    84  2916 12747  7984  7609  1462 14949  8680  6532  9689  8749 11012
 10083  2270  1871  4849  2659  9209  5620  1207  7141  7700  5417   456
   930  7968  1516  6511  2709 15820  2976  6073 16174 11625   399 15953
 11578  9305 11529  6159  2528 14707  8959  1634  9000 15374 14505  4874
 13058  3707   711  6060 12418  4125  5079  4488  7724 12933  5749  1415
  2755   732 11233 13265  1360 12861  9430   639  9120  6940 10895  8545
 10131 10901  5706  3821  2132   168  6662  8534 12205  7561 13463 13476
  4361  7907  1896 11514 10455 12600  9230  8817  2789  1535   689  9537
  4223   987  9175 13094 15928 11788  6079  7144   499  9258   263 11902
  1119  1751  3380  8821  5993  8327  4855 15222  5761  7309  6178 10993
  3760 11828 15814 10277 11163 15423 15735  1444   953  4178  9504  7455
 15113  7556 12244  6784  4595 12610  3907 15955  6061  7249    79  6264
 11221  9475  5921 15741  3941 10387  9237  4143  4445  8571 15577   883
   588  2046  2847 10681 16176  9201  6737  5571 11451  2107  7918  5897
  6115 13403 10313  9635 11454  8633 13371 10866 13685  1571  9212 10000
 15808 13513 15454]
Calculating metrics list with parameters: {'intervention_method': 'clamp_feature_activation'} {'features_to_ablate': [array([ 1221, 12897,  7492,  7792, 15053, 12264,  6224, 15916, 11610,
       12193]), array([ 1221, 12897,  7492,  7792, 15053, 12264,  6224, 15916, 11610,
       12193,  3158,  7379,  5363,  2552,  5102,  4943,  5415,  2576,
       11204,  2864])], 'multiplier': [25, 50, 100, 200]}
All target question ids for gemma-2-2b-it on wmdp-bio already exist. No need to generate target ids.
All target question ids for gemma-2-2b-it on high_school_us_history already exist. No need to generate target ids.
All target question ids for gemma-2-2b-it on college_computer_science already exist. No need to generate target ids.
All target question ids for gemma-2-2b-it on high_school_geography already exist. No need to generate target ids.
All target question ids for gemma-2-2b-it on human_aging already exist. No need to generate target ids.
Calculating metrics for retain threshold: 0.01
Top features for ablation: [ 9451 13468  2343 ... 15808 13513 15454]
Calculating metrics list with parameters: {'intervention_method': 'clamp_feature_activation'} {'features_to_ablate': [array([ 9451, 13468,  2343,  2499, 10253, 14308,  7246, 12681,  1790,
        3141]), array([ 9451, 13468,  2343,  2499, 10253, 14308,  7246, 12681,  1790,
        3141,  5134, 10405,  2433, 11085,  7637, 11534, 12287, 10288,
        1329,  6295])], 'multiplier': [25, 50, 100, 200]}
All target question ids for gemma-2-2b-it on wmdp-bio already exist. No need to generate target ids.
All target question ids for gemma-2-2b-it on high_school_us_history already exist. No need to generate target ids.
All target question ids for gemma-2-2b-it on college_computer_science already exist. No need to generate target ids.
All target question ids for gemma-2-2b-it on high_school_geography already exist. No need to generate target ids.
All target question ids for gemma-2-2b-it on human_aging already exist. No need to generate target ids.
Unlearning scores DataFrame:     wmdp-bio  high_school_us_history  ...  multiplier  all_side_effects_mcq
0   0.996255                     1.0  ...          25              1.000000
1   0.998127                     1.0  ...         200              1.000000
2   0.998127                     1.0  ...         100              1.000000
3   0.998127                     1.0  ...         200              1.000000
4   0.973783                     1.0  ...         200              0.996721
5   0.996255                     1.0  ...          50              1.000000
6   0.998127                     1.0  ...         100              1.000000
7   0.998127                     1.0  ...         100              1.000000
8   0.998127                     1.0  ...          50              1.000000
9   0.998127                     1.0  ...          50              1.000000
10  0.998127                     1.0  ...          25              1.000000
11  0.985019                     1.0  ...         100              1.000000
12  0.998127                     1.0  ...          25              1.000000
13  0.998127                     1.0  ...          25              1.000000
14  0.998127                     1.0  ...         200              1.000000
15  0.998127                     1.0  ...          50              1.000000

[16 rows x 10 columns]
